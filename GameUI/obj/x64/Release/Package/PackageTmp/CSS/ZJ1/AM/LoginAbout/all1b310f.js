var gsAgent=navigator.userAgent.toLowerCase(),gsAppVer=navigator.appVersion.toLowerCase(),gsAppName=navigator.appName.toLowerCase(),gbIsOpera=gsAgent.indexOf("opera")>-1,gbIsWebKit=gsAgent.indexOf("applewebkit")>-1,gbIsKHTML=gsAgent.indexOf("khtml")>-1||gsAgent.indexOf("konqueror")>-1||gbIsWebKit,gbIsIE=(gsAgent.indexOf("compatible")>-1&&!gbIsOpera)||gsAgent.indexOf("msie")>-1,gbIsTT=gbIsIE?(gsAppVer.indexOf("tencenttraveler")!=-1?1:0):0,gbIsQBWebKit=gbIsWebKit?(gsAppVer.indexOf("qqbrowser")!=-1?1:0):0,gbIsQPlus=gsAgent.indexOf("qplus")>-1,gbIsChrome=gbIsWebKit&&!gbIsQBWebKit&&gsAgent.indexOf("chrome")>-1&&gsAgent.indexOf("se 2.x metasr 1.0")<0&&!gbIsQPlus,gbIsSafari=gbIsWebKit&&!gbIsChrome&&!gbIsQBWebKit,gbIsQBIE=gbIsIE&&gsAppVer.indexOf("qqbrowser")!=-1,gbIsFF=gsAgent.indexOf("gecko")>-1&&!gbIsKHTML,gbIsNS=!gbIsIE&&!gbIsOpera&&!gbIsKHTML&&(gsAgent.indexOf("mozilla")==0)&&(gsAppName=="netscape"),gbIsAgentErr=!(gbIsOpera||gbIsKHTML||gbIsSafari||gbIsIE||gbIsTT||gbIsFF||gbIsNS),gbIsWin=gsAgent.indexOf("windows")>-1||gsAgent.indexOf("win32")>-1,gbIsVista=gbIsWin&&(gsAgent.indexOf("nt 6.0")>-1||gsAgent.indexOf("windows vista")>-1),gbIsWin7=gbIsWin&&gsAgent.indexOf("nt 6.1")>-1,gbIsMac=gsAgent.indexOf("macintosh")>-1||gsAgent.indexOf("mac os x")>-1,gsMacVer=(/mac os x (\d+)(\.|_)(\d+)/.test(gsAgent)&&parseFloat(RegExp.$1+"."+RegExp.$3)).toString(),gbIsLinux=gsAgent.indexOf("linux")>-1,gbIsAir=gsAgent.indexOf("adobeair")>-1,gnIEVer=/MSIE (\d+.\d+);/i.test(gsAgent)&&parseFloat(RegExp["$1"]),gsFFVer=/firefox\/((\d|\.)+)/i.test(gsAgent)&&RegExp["$1"],gsSafariVer=""+(/version\/((\d|\.)+)/i.test(gsAgent)&&RegExp["$1"]),gsChromeVer=""+(/chrome\/((\d|\.)+)/i.test(gsAgent)&&RegExp["$1"]),gsQBVer=""+(/qqbrowser\/((\d|\.)+)/i.test(gsAgent)&&RegExp["$1"]),_gsForEBuiltTag="_For_E_Built";if(!window.getTop){window.getTop=function(){var b=arguments.callee;if(!b._moTop){try{if(window!=parent){b._moTop=parent.getTop?parent.getTop():parent.parent.getTop();}else{b._moTop=window;}}catch(a){b._moTop=window;}}return b._moTop;};try{}catch(_oError){eval("var top = getTop();");}}function _callBack(a,b){return typeof a=="function"?a.apply(this,b||[]):null;}function callBack(a,b){if(!window.Console){try{return _callBack.call(this,a,b);}catch(c){debug(c.message);}}else{return _callBack.call(this,a,b);}}function waitFor(b,a,c,d){var g=0,f=c||500,h=(d||10*500)/f;function e(i){try{a(i);}catch(j){debug(j,2);}};(function(){try{if(b()){return e(true);}}catch(i){debug(i,2);}if(g++>h){return e(false);}setTimeout(arguments.callee,f);})();}function unikey(a){return [a,now(),Math.random()].join("").split(".").join("");}function genGlobalMapIdx(){return Math.round(Math.random()*10000).toString()+new Date().getMilliseconds();}function isLeapYear(a){return (a%400==0||(a%4==0&&a%100!=0));}function calDays(b,a){return [null,31,null,31,30,31,30,31,31,30,31,30,31][a]||(isLeapYear(b)?29:28);}function now(){return +new Date();}function trim(a){return (a&&a.replace?a:"").replace(/(^\s*)|(\s*$)/g,"");}function trim2(a){if(a&&a.substring){var d=/\s/,b=-1,c=a.length;while(d.test(a.charAt(--c)));while(d.test(a.charAt(++b)));return a.substring(b,c+1);}}function strReplace(d,b,c,a){return (d||"").replace(new RegExp(regFilter(b),a),c);}function encodeURI(a){return a&&a.replace?a.replace(/%/ig,"%25").replace(/\+/ig,"%2B").replace(/&/ig,"%26").replace(/#/ig,"%23").replace(/\'/ig,"%27").replace(/\"/ig,"%22"):a;}function decodeURI(a){return decodeURIComponent(a||"");}function regFilter(a){return a.replace(/([\^\.\[\$\(\)\|\*\+\?\{\\])/ig,"\\$1");}function isUrl(a){return (a||"").replace(/http?:\/\/[\w.]+[^ \f\n\r\t\v\"\\\<\>\[\]\u2100-\uFFFF]*/,"url")=="url";}function cookQueryString(b,a){for(var e in a){var d=a[e],c=new RegExp(["([?&]",e,"=)[^&#]*"].join(""),"gi");b=c.test(b)?b.replace(c,"$1"+d):[b,"&",e,"=",d].join("");}return b;}function formatNum(b,a){var d=(isNaN(b)?0:b).toString(),c=a-d.length;return c>0?[new Array(c+1).join("0"),d].join(""):d;}function numToStr(b,a){var c=String(b.toFixed(a));var d=/(-?\d+)(\d{3})/;while(d.test(c)){c=c.replace(d,"$1,$2");}return c;}function numToTimeStr(a,b){var c=b||"$HH$:$MM$:$SS$";return T(c).replace({SS:formatNum(parseInt(a)%60,2),MM:formatNum(parseInt(a/60)%60,2),HH:formatNum(parseInt(a/3600)%60,2)});}function formatDate(a,b,c){var e=a||new Date(),d=formatNum;return T(b,c).replace({YY:d(e.getFullYear(),4),MM:d(e.getMonth()+1,2),DD:d(e.getDate(),2),hh:d(e.getHours(),2),mm:d(e.getMinutes(),2),ss:d(e.getSeconds(),2)});}function getAsiiStrLen(a){return (a||"").replace(/[^\x00-\xFF]/g,"aa").length;}function clearHtmlStr(a){return a?a.replace(/<[^>]*>/g,""):a;}function subAsiiStr(d,b,c,a){var e=function(i){return i;},f=a?htmlEncode:e,n=(a?htmlDecode:e)(trim((d||"").toString())),m=c||"",j=Math.max(b-m.length,1),l=n.length,h=0,k=-1,g;for(var o=0;o<l;o++){g=n.charCodeAt(o);h+=g==35||g==87?1.2:(g>255?1.5:1);if(k==-1&&h>j){k=o;}if(h>b){return f(n.substr(0,k))+m;}}return f(n);}function setCookie(d,f,b,e,c,a){if(d){document.cookie=T(['$name$=$value$; ',!b?'':'expires=$expires$; ','path=$path$; ','domain=$domain$; ',!a?'':'$secure$']).replace({name:d,value:encodeURIComponent(f||""),expires:b&&b.toGMTString(),path:e||'/',domain:c||["mail.",getDomain()].join(""),secure:a?"secure":""});return true;}else{return false;}}function getCookie(a){var b=(new RegExp(["(^|;|\\s+)",regFilter(a),"=([^;]*);?"].join("")));if(b.test(document.cookie)){try{return decodeURIComponent(RegExp["$2"]);}catch(c){return RegExp["$2"];}}}function deleteCookie(b,c,a){setCookie(b,"",new Date(0),c,a);}function setCookieFlag(d,b,a,c){var f=c||getCookieFlag(d),e=new Date();e.setTime(e.getTime()+(30*24*3600*1000));f[b]=a;setCookie(d,f.join(""),e);return f;}function getCookieFlag(a){var b=(getCookie(a)||"").split("");for(var c=b.length;c<6;c++){b[c]='0';}return b;}function isArr(a){return Object.prototype.toString.call(a)=="[object Array]";}function E(d,a,c,b){if(!d){return;}if(d.length!=null){var f=d.length,e;if(b<0){e=f+b;}else{e=b<f?b:f;}for(var h=(c||0);h<e;h++){try{if(a(d[h],h,f)===false){break;}}catch(g){debug([g.message,"<br>line:",g.lineNumber,'<br>file:',g.fileName,"<br>",a]);}}}else{for(var h in d){try{if(a(d[h],h)===false){break;}}catch(g){debug([g.message,"<br>",a]);}}}}function extend(){for(var b=arguments,c=b[0],e=1,a=b.length;e<a;e++){var d=b[e];for(var f in d){c[f]=d[f];}}return c;}function delAtt(a,b){try{delete a[b];}catch(c){}return a;}function saveAtt(a,b){if(a){var c=a.hasOwnProperty(b),d=a[b];return function(){if(c){a[b]=d;}else{delAtt(a,b);}return a;};}else{return function(){};}}function globalEval(b,a){var c=getTop().globalEval||arguments.callee;if(!c._bTest&&typeof (c._bScriptEval)!="boolean"){var i="testScriptEval"+now();c._bTest=true;c(T('window.$id$=1;').replace({id:i}));c._bTest=false;c._bScriptEval=getTop()[i]?true:false;}var h=trim(b);if(!h){return false;}var d=(a||window).document,f=GelTags("head",d)[0]||d.documentElement,g=d.createElement("script");g.type="text/javascript";if(c._bScriptEval||arguments.callee._bTest){try{g.appendChild(d.createTextNode(h));}catch(e){}}else{g.text=h;}f.insertBefore(g,f.firstChild);f.removeChild(g);return true;}function evalValue(b,a){var d=unikey("_u"),c=a||window;globalEval(["(function(){try{window.",d,"=",b,";}catch(_oError){}})();"].join(""),c);return c[d];}function evalCss(b,a,c){if(b){var d=a?a.document||a:document,g="cssfrom",i="style",e=d.getElementsByTagName(i)[0];if(c&&e){var h=e.getAttribute(g)||"";if(h.indexOf(c)!=-1){return;}}if(d.createStyleSheet){e=e||d.createStyleSheet().owningElement;e.styleSheet.cssText+=getRes(b);}else{if(!e){var f=d.getElementsByTagName("head")[0];e=d.createElement(i);e.type="text/css";f.insertBefore(e,f.firstChild);}e.textContent+=getRes(b);}c&&e.setAttribute(g,[e.getAttribute(g)||"",c].join(","));}}function S(b,a){try{return (a&&(a.document||a)||document).getElementById(b);}catch(c){return null;}}function SN(b,a){try{var c=(a&&(a.document||a)||document).getElementsByName(b);if(c){c[_gsForEBuiltTag]=true;}return c;}catch(d){return null;}}function attr(a,b,c){if(!a||!a.nodeType||a.nodeType===3||a.nodeType===8){return undefined;}if(c===undefined){return a.getAttribute(b);}else{a.setAttribute(b,c);return a;}}function GelTags(b,a){var c=(a||document).getElementsByTagName(b);if(c){c[_gsForEBuiltTag]=true;}return c;}function CN(b,a,c){a=a||document;if(a.getElementsByClassName){return a.getElementsByClassName(b);}else{c=c||"*";var f=[],d=(c=='*'&&a.all)?a.all:a.getElementsByTagName(c),g=d.length;b=b.replace(/\-/g,'\\-');var e=new RegExp('(^|\\s)'+b+'(\\s|$)');while(--g>=0){if(e.test(d[g].className)){f.push(d[g]);}}return f;}};function F(b,a){var c=S(b,a);return c&&(c.contentWindow||(a||window).frames[b]);}function appendToUrl(b,a){var c=b.split("#");return [c[0],a,(c.length>1?"#"+c[1]:"")].join("");}function insertHTML(c,e,d){if(!c){return false;}try{if(c.insertAdjacentHTML){c.insertAdjacentHTML(e,d);}else{var h=c.ownerDocument.createRange(),a=e.indexOf("before")==0,b=e.indexOf("Begin")!=-1;if(a==b){h[a?"setStartBefore":"setStartAfter"](c);c.parentNode.insertBefore(h.createContextualFragment(d),b?c:c.nextSibling);}else{var f=c[a?"lastChild":"firstChild"];if(f){h[a?"setStartAfter":"setStartBefore"](f);c[a?"appendChild":"insertBefore"](h.createContextualFragment(d),f);}else{c.innerHTML=d;}}}return true;}catch(g){return false;}}function setHTML(b,a){var d=typeof b==="string"?S(b):b,c=d.cloneNode(false);c.innerHTML=a;d.parentNode.replaceChild(c,d);return c;}function createIframe(b,c,a){var f="_creAteifRAmeoNlQAd_",e=a||{},g=a.id||unikey(),d=S(g,b);if(typeof b[f]!="function"){b[f]=function(i,h){callBack.call(h,arguments.callee[i],[b]);};}b[f][g]=a.onload;if(!d){insertHTML(e.obj||b.document.body,e.where||"afterBegin",TE(['<iframe frameborder="0" scrolling="$scrolling$" id="$id$" name="$id$" ','$@$if($transparent$)$@$allowTransparent$@$endif$@$ class="$className$" ','onload="this.setAttribute(\x27loaded\x27,\x27true\x27);$cb$(\x27$id$\x27,this);" ','src="$src$" style="$style$" $attrs$>','</iframe>']).replace(extend({"id":g,"cb":f,style:"display:none;",scrolling:"no",src:c},a)));d=S(g,b);d._onload=a.onload;}else if(d.getAttribute("loaded")=="true"){b[f](g,d);}return d;}function removeSelf(a){try{a.parentNode.removeChild(a);}catch(b){}return a;}function isObjContainTarget(a,b){try{if(!a||!b){return false;}else if(a.contains){return a.contains(b);}else if(a.compareDocumentPosition){var d=a.compareDocumentPosition(b);return (d==20||d==0);}}catch(c){}return false;}function isDisableCtl(b,a){var c=SN(b,a);for(var d=c.length-1;d>=0;d--){if(c[d].disabled){return true;}}return false;}function disableCtl(c,a,b){E(SN(c,b),function(d){d.disabled=a;});}(function(a){var f=/\[([\w\-_]+)(=[\'\"]?([\w\-_~@]+)[\'\"]?)?\]/,g=/\[[\w\-_]+(=[\'\"]?[\w\-_~@]+[\'\"]?)?\]/g,h=/^([#\$<:])([\w\-_]+)>?$/,i=/.*?\.([\w\-_]+)/,l=/(?:[\w\-~@\\.#\[\]=\'\"]+)+|\*|>/ig,j=/#([\w\-_]+)/,k=/^([\w\*\-_]+)/,m=[a,a];function b(q){for(var t=0,s=[],r=q.length;t<r;t++){s[t]=q[t];}return s;}function e(t,s,r,q){var u=!s||s.test(t.className),x=0,w,v;while(u&&x<q){w=t.getAttribute((v=r[x++])[1]);u=v[2]?w===v[3]:!!w;}return u;}function o(q){var r=q.match(g);if(r){for(var s=r.length-1;s>=0;s--){r[s]=r[s].match(f);}}return r;}function p(q){var r=(q.match(i)||m)[1];return r&&RegExp('(^|\\s)'+r+'(\\s|$)');}function c(s,r,q){var G=s.pop();if(G==='>'){return c(s,r,true);}var C=(G.match(j)||m)[1],y=p(G),D=(G.match(k)||m)[1],x=o(G),u=x?x.length:0,B=[],w=-1,v=-1,z,A,t;D&&(D=D=="*"?"":D.toUpperCase());while((z=r[++v])){A=z.parentNode;do{t=(!C||A.id===C)&&(!D||A.nodeName==D)&&e(A,y,x,u);if(q||t){break;}}while((A=A.parentNode)&&A.getAttribute);t&&(B[++w]=z);}return s[0]&&B[0]?c(s,B):B;}function n(r,q){if(!q){return [];}var z=r.match(l),C=z.pop(),A=(C.match(j)||m)[1],v=p(C),u=o(C),s=u?u.length:0,B=(C.match(k)||m)[1],y=[],w=[],D=-1,t=-1,x;while((q=q.parentNode)&&q.nodeType!==9){y.push(q);}B&&(B=B=="*"?"":B.toUpperCase());while(x=y[++D]){(!A||x.id===A)&&(!B||x.nodeName==B)&&e(x,v,u,s)&&(w[++t]=x);}return z[0]&&w[0]?c(z,w):w;}function d(r,q){if(!q){return [];}if(q.querySelectorAll){return b(q.querySelectorAll(r));}var C=r.match(l),H=C.pop(),D=(H.match(j)||m)[1],v=p(H),u=o(H),s=u?u.length:0,G=(H.match(k)||m)[1],w;if(D){var y=(q||window).document||q,z=y.getElementById(D);if(!z||(G&&z.nodeName!=G.toUpperCase())||!e(z,v,u,s)){return [];}w=[z];}else{var x=q.getElementsByTagName?q:q.document,A=x.getElementsByTagName(G||'*');if(v||s){var I=-1,t=-1,B;w=[];if(!s){while(B=A[++I]){v.test(B.className)&&(w[++t]=B);}}else{while(B=A[++I]){e(B,v,u,s)&&(w[++t]=B);}}}else{w=b(A);}}return C[0]&&w[0]?c(C,w):w;}window.finds=d;window.parents=n;})();function isShow(b,a){return (getStyle((typeof (b)=="string"?S(b,a):b),"display")||"none")!="none";}function show(c,a,b){var d=(typeof (c)=="string"?S(c,b):c);if(d){d.style.display=(a?"":"none");}else if(!b&&typeof (c)=="string"){}return d;}var Show=show;function toggle(b,a){return show(b,!isShow(b,a),a);}function setClass(a,b){if(a&&typeof (b)!="undefined"&&a.className!=b){a.className=b;}return a;}function addClass(a,b){var c=" "+a.className+" ";if(c.indexOf(" "+b+" ")<0){a.className+=a.className?" "+b:b;}return a;};function rmClass(a,b){if(a){if(b){var c=" "+a.className+" ";c=c.replace(" "+b+" "," ");a.className=trim(c);}else{a.className="";}}return a;};function hasClass(a,b){return a&&(" "+a.className+" ").indexOf(" "+b+" ")>-1;};function getStyle(a,b){var c=a&&(a.currentStyle?a.currentStyle:a.ownerDocument.defaultView.getComputedStyle(a,null));return c&&c[b]||"";}function setOpacity(b,a){if(b&&b.tagName){var d=b.style,c=a||0;if(typeof d.opacity=="undefined"){d.filter=c==1?"":["alpha(opacity=",c*100,")"].join("");}else{d.opacity=c;}}return b;}function getOpacity(b,a){if(b&&b.tagName){var d=b.style,c=1;if(typeof d.opacity=="undefined"){c=parseFloat(d.filter.split("=").pop())/100;}else{c=parseFloat(d.opacity);}if(isNaN(c)){c=1;}}return c;}function getStrDispLen(a){var d="__QMStrCalcer__";var c=S(d,getTop());if(!c){var b=getTop().document.body;insertHTML(b,"afterBegin",T(['<div id="$id$" ','style="filter:alpha(opacity=0);opacity:0;width:1px;height:1px;overflow:auto;*overflow:hidden;white-space:nowrap;','position:absolute;left:0;top:0;">','</div>']).replace({id:d}));c=b.firstChild;}c.innerHTML=htmlEncode(a);return c.scrollWidth;}function calcPos(a,b){var e=0,d=0,f=0,c=0;if(a&&a.tagName){var l=a,k=a.parentNode,h=a.offsetParent,i=a.ownerDocument,j=i.documentElement,g=i.body;d+=a.offsetLeft;e+=a.offsetTop;f=a.offsetWidth;c=a.offsetHeight;while(h&&k&&k!=j&&k!=g){if(calcPos._isSupportsFixedPosition()&&l.style&&getStyle(l,"position")==="fixed"){break;}if(h==k){d+=k.offsetLeft;e+=k.offsetTop;h=k.offsetParent;}d-=k.scrollLeft;e-=k.scrollTop;l=k;k=k.parentNode;}if(calcPos._isSupportsFixedPosition()&&l.style&&getStyle(l,"position")==="fixed"){d+=bodyScroll(i,'scrollLeft');e+=bodyScroll(i,'scrollTop');}}return b=="json"?{top:e,bottom:e+c,left:d,right:d+f,width:f,height:c}:[e,d+f,e+c,d,f,c];}calcPos._isSupportsFixedPosition=function(){var a,c=this;if(c._bIsSupportsFixedPosition==a){var b=document.createElement("div");b.style.cssText="'position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;";b.innerHTML="<div style='position:fixed;top:20px;'></div>";document.body.appendChild(b);c._bIsSupportsFixedPosition=!!{20:1,15:1}[b.firstChild.offsetTop];}return c._bIsSupportsFixedPosition;};function calcPosFrame(a,b){var c=calcPos(a),f=b||window,e=getTop();while(f.frameElement&&f!=e){var d=calcPos(f.frameElement);c[0]+=d[0]-bodyScroll(f,"scrollTop");c[2]+=d[0]-bodyScroll(f,"scrollTop");c[1]+=d[3]-bodyScroll(f,"scrollLeft");c[3]+=d[3]-bodyScroll(f,"scrollLeft");f=f.parent;}return c;}function calcAdjPos(d,c,a,e,b){var i=bodyScroll(e,'clientHeight'),j=bodyScroll(e,'clientWidth'),l=bodyScroll(e,'scrollTop'),k=bodyScroll(e,'scrollLeft'),f=l+i,g=k+j,m=[0,0,0,0];if(b<2){var h=k-d[1];if(b==0&&d[3]<c||b==1&&g-d[1]>c){m[1]=(m[3]=d[1])+c;}else{m[3]=(m[1]=d[3])-c;}if(d[0]+a>f){m[0]=(m[2]=(d[2]-a<l?f:d[2]))-a;}else{m[2]=(m[0]=d[0])+a;}}else{if(b==2&&d[0]-l<a||b==3&&f>d[2]+a){m[2]=(m[0]=d[2])+a;}else{m[0]=(m[2]=d[0])-a;}m[1]=d[1];m[3]=d[3];}return m;}function bodyScroll(b,c,a){var e=(b||window).document||b,d=e.body,f=e.documentElement;if(typeof (a)=="number"){d[c]=f[c]=a;}else{if(c=="scrollTop"&&typeof b.pageYOffset!="undefined"){return b.pageYOffset;}else{return f[c]||d[c];}}}function htmlDecode(a){return a&&a.replace?(a.replace(/&nbsp;/gi," ").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&").replace(/&quot;/gi,"\"").replace(/&#39;/gi,"'")):a;}function htmlEncode(a){return a&&a.replace?(a.replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&#39;")):a;}function filteScript(b,a){return b&&b.replace(/<script ?.*>(.*?)<\/script>/ig,"<script>$1\n</script>").replace(/<script ?.*>([\s\S]*?)<\/script>/ig,a||"");}function textToHtml(a){return ['<DIV>',a.replace((a.indexOf("<BR>")>=0)?/<BR>/ig:/\n/g,"</DIV><DIV>"),"</DIV>"].join("").replace(new RegExp("\x0D","g"),"").replace(new RegExp("\x20","g"),"&nbsp;").replace(new RegExp("(<DIV><\/DIV>)*$","g"),"").replace(/<DIV><\/DIV>/g,"<DIV>&nbsp;</DIV>");}function textToHtmlForNoIE(a){return a.replace(/\n/g,"<br>");}function htmlToText(a){return a.replace(/\n/ig,"").replace(/(<\/div>)|(<\/p>)|(<br\/?>)|(<\/li>)/ig,"\n");}function fixNonBreakSpace(a){return (a||"").replace(/\xA0/ig," ");}function pasteHTML(c,d,a,b){b=b||getMainWin();c=filteScript(c);var e=(typeof (d)=="string"?S(d,b):d);if(!e||!c){return false;}if(a){e.innerHTML=c;}else{insertHTML(e,"afterBegin",c);}return true;}function limitString(b,a){var f=b||"",d=a||20,c=f.length;if(c>d){var e=Math.floor((d-3)/2);f=f.substring(0,e)+"..."+f.slice(-e,c);}return f;};function T(b,a){return new T._QMTemplate(b,a);}function TE(b,a){var d=getTop();if(d.QMTmplChecker){var c=(new d.QMTmplChecker(b.join?b:[b],a)).getErrors();if(c.length){debug(c.join("\n"),"code");}}return new T._QMTemplate(b,a,"exp");}T._QMTemplate=function(c,a,b){this._msTmplStr=c.join?c.join(""):c.toString();this._msTmplReplaceVar=a||"$";this._replace=b=="exp"?this._replaceWithExp:this._replaceWithParse;};T._QMTemplate.prototype={toString:function(){return this._msTmplStr;},replace:function(a,b){return this._replace(a,b);},_replaceWithParse:function(a,b){var f=this,h=f._msTmplReplaceVar,g=f._moTmplData,e=f._moLinkData,c=!g;if(c){g=f._moTmplData=f._msTmplStr.split(f._msTmplReplaceVar);e=f._moLinkData=f._moTmplData.concat();}for(var j=1,d=g.length;j<d;j+=2){e[j]=f._get(c?(g[j]=g[j].split(".")):g[j],a,b,h);}return e.join("");},_replaceWithExp:function(b,c,a){var f=this,d;if(!f._mfReplace){f._compile();}if(typeof c=="string"){var g=f._moSecDatas[c];if(g){d=typeof g!="function"?f._moSecDatas[c]=f._genHandleFunc(g):g;}}else{d=f._mfReplace;}try{return d&&d(b,f._moTmplDatas,f._get,f._msTmplReplaceVar,htmlEncode,a||c)||"";}catch(e){return e.message;}},_compile:function(){var j=this,a=0,c=[],e=[],h=[],g=j._moSecDatas=[],m=j._msTmplReplaceVar,f=new RegExp(["","(.*?)",""].join(regFilter(m)),"g"),l="_afG('$1'.split('.'),_oD,_aoD,_aoR)",k=j._moTmplDatas=j._msTmplStr.split(["","@",""].join(m)),n;for(var o=0,b=k.length;o<b;o++){n=k[o];if(o%2==0){c.push("_oR.push(_aoT[",o,"].replace(_oD,_aoD));");k[o]=T(n,m);}else if(n=="else"){c.push("}else{");}else if(n=="endsec"){if(h.length){var d=h.pop();g[d[0]]=c.slice(d[1]);}}else if(n=="endfor"){e.length&&c.push("try{delete _oD._parent_;delete _oD._idx_;}catch(e){}}_oD=_oS",e.pop(),";");}else if(n=="endif"){c.push("}");}else if(n.indexOf("else if(")==0){c.push("}",n.replace(f,l),"{");}else if(n.indexOf("if(")==0){c.push(n.replace(f,l),"{");}else if(n.indexOf("for(")==0){e.push(++a);c.push("var _sI",a,",_oD",a,",_oS",a,"=_oD;",n.replace(f,["_sI",a," in (_oD",a,"=",l,")"].join("")),"{","_oD=_oD",a,"[_sI",a,"];","if(!_oD){continue;}","try{_oD._parent_=_oS",a,";","_oD._idx_=_sI",a,";}catch(e){}");}else if(n.indexOf("sec ")==0){h.push([n.split(" ").pop(),c.length]);}else if(n.indexOf("eval ")==0){c.push("_oR.push(",n.substr(5).replace(f,l),");");}else if(n.indexOf("html(")==0){c.push("_oR.push(_afE(",n.substr(5).replace(f,l),");");}}j._mfReplace=j._genHandleFunc(c);return c;},_genHandleFunc:function(_aoCompileDatas){try{return eval(['([function(_aoD,_aoT,_afG,_aoR, _afE, A){var _oR=[],_oD=_aoD;',_aoCompileDatas.join(""),'return _oR.join("");}])'].join(""))[0];}catch(_oErr){return function(){return "compile err!";};}},_get:function(c,a,b,d){var e=c.length,g,h;if(e>1){try{h=a;for(var j=0;j<e;j++){g=c[j];if(g=="_root_"){h=b;}else{h=h[g];}}}catch(f){h="";}}else{h={"_var_":d,"_this_":a}[g=c[0]]||a[g];}return h;}};var addEvent=(function(){function a(d,e,c,b){if(d&&c){if(d.addEventListener){d[b?"removeEventListener":"addEventListener"](e,c,false);}else if(d.attachEvent){d[b?"detachEvent":"attachEvent"]("on"+e,c);}else{d["on"+e]=b?null:c;}}return d;}return function(d,e,c,b){if(d&&(d.join||d[_gsForEBuiltTag])){E(d,function(f){a(f,e,c,b);});}else{a(d,e,c,b);}return d;};})();function addEvents(b,c,a){E(c,function(d,e){addEvent(b,e,d,a);});return b;}function removeEvent(b,c,a){return addEvent(b,c,a,true);}function removeEvents(a,b){return addEvents(a,b,true);}function preventDefault(a){if(a){if(a.preventDefault){a.preventDefault();}else{a.returnValue=false;}}return a;}function stopPropagation(a){if(a){if(a.stopPropagation){a.stopPropagation();}else{a.cancelBubble=true;}}return a;}function getEventTarget(a){return a&&(a.srcElement||a.target);}function getUserTarget(a,b,c){var d=getEventTarget(b);while(d&&isObjContainTarget(a,d)){if(attr(d,c)){return d;}d=d.parentNode;}}function fireMouseEvent(a,b){if(a){if(a.dispatchEvent){var c=a.ownerDocument,e=c.defaultView,d=c.createEvent("MouseEvents");d.initMouseEvent(b,true,true,e,0,0,0,0,0,false,false,false,false,0,null);a.dispatchEvent(d);}else{if(a.tagName=="INPUT"&&a.getAttribute("type")=="submit"&&b=="click"){a.click();}else{a.fireEvent("on"+b);}}}return a;}var liveEvent=(function(){var b={click:"ck",dblclick:"dbl",mousedown:'md',mouseup:'mu',mouseover:'mor',mousemove:'mm',mouseout:'mot',keydown:'kd',keypress:'kp',keyup:'ku'};function a(c,d){var j=c.type,i=b[j],g=d.rule()[j],e=d.events(),h=getEventTarget(c);if(!i){return;}do{var k=h.getAttribute(i),f=g[k];if(k&&f&&e[k]){_vRe=e[k].call(d,c,h);if(!f.bPropagable){break;}}}while((h=h.parentNode)&&h.getAttribute);}return function(c,d){var e=d.rule();for(var f in e){addEvent(c,f,function(g){a(g,d);});}};})();function loadJsFile(f,b,e,c,d,a){var k=e||document,h=typeof c=="function",m,n,l=getTop().loadJsFile,p=getRes(f),j=l._oDatas||(l._oDatas={});if(b){for(var o=GelTags("script",k),r=o.length-1;r>=0;r--){if(o[r].src.indexOf(p)!=-1){if(h){var q=o[r].getAttribute("_key_");if(j[q]===true){callBack.call(o[r],c);}else{j[q].push(c);}}return o[r];}}}n=k.createElement("script");E(d,function(s,i){n.setAttribute(i,s);});var q=unikey();n.setAttribute("_key_",q);j[q]=[];function g(){var i=this,s=i.getAttribute("_key_");callBack.call(i,c);E(j[s],function(t){t();});j[s]=true;if(a){removeSelf(n);}i.onreadystatechange=i.onload=null;}(GelTags("head",k)[0]||k.documentElement).appendChild(extend(n,{onload:g,onreadystatechange:function(){var i=this;({loaded:true,complete:true}[i.readyState])&&g.call(this);}},{type:"text/javascript",charset:d&&d.charset||"gb2312",src:p}));return n;}function loadJsFileToTop(){if(arguments.length==2){var d=arguments[0],a=arguments[1];}else{var d="",a=arguments[0];}var c=window.loadJsFile;function b(e){if(e){c(d+e,true,getTop().document);}}E(a,b);}function loadCssFile(c,a,b){var e=b||document,j=getRes(c);if(a){for(var g=GelTags("link",e),k=g.length-1;k>=0;k--){if(g[k].href.indexOf(j)!=-1){return;}}}var f=e.createElement("link"),h=GelTags("link",e);f.type="text/css";f.rel="stylesheet";f.href=j;if(h.length>0){var d=h[h.length-1];d.parentNode.insertBefore(f,d.nextSibling);}else{(GelTags("head",e)[0]||e.documentElement).appendChild(f);}return f;}function replaceCssFile(c,b,a){if(c){E(GelTags("link",a||document),function(d){if(d&&d.href.indexOf(c)!=-1){removeSelf(d);}});}return loadCssFile(b,false,a);}function QMAjax(d,c,a,b){var i=this,j=getTop(),k=b,g;function m(){i.onComplete(k);}function l(n){i.onError(k,n);}function f(n){if(!g){g=setTimeout(function(){i.abort();},n);}}function e(n){if(g){clearTimeout(g);g=null;if(n!="ok"){l(n);}return true;}return false;}this.method=c||"POST";this.url=d;this.async=true;this.content="";this.timeout=a;this.onComplete=function(){};this.onError=function(){};if(!k){try{k=new XMLHttpRequest();}catch(h){try{k=new ActiveXObject("MSXML2.XMLHTTP");}catch(h){try{k=new ActiveXObject("Microsoft.XMLHTTP");}catch(h){}}}}if(!k){return false;}this.abort=function(){e("abort");k.abort();};this.send=function(n){if(!this.method||!this.url||!this.async){return false;}typeof this.url=="object"&&(this.url=this.url.replace({}));var p=this.method.toUpperCase(),q=getTop().getSid&&getTop().getSid();this.abort();k.open(p,this.url+(q&&p=="POST"&&((this.url.split("?")[1]||"")+"&").indexOf("&sid=")==-1?(this.url.indexOf("?")==-1?"?sid=":"&sid=")+q:""),this.async);if(p=="POST"){k.setRequestHeader("Content-Type",document.charset);k.setRequestHeader("Content-Type","application/x-www-form-urlencoded");}j.E(this.headers,function(s,r){k.setRequestHeader(r,s);});k.onreadystatechange=function(){try{if(k.readyState==4){if(k.status==200){if(e("ok")){m();}}else{e(k.status);}}}catch(r){e(r.message);}};f(this.timeout||15000);try{if(p=="POST"){k.send(n||this.content);}else{k.send(null);}}catch(o){e(o.message);}return true;};};QMAjax.send=function(c,a,b){var f=getTop(),d=b||new QMAjax(),e=a||{};d.url=c;f.E("method,timeout,content,headers".split(","),function(g){if(e[g]){d[g]=e[g];}});d.onComplete=function(g){f.callBack.call(g,a.onload,[true,f.trim2(g.responseText||""),g]);};d.onError=function(g,h){f.callBack.call(g,a.onload,[false,h,g]);};d.send();};function includeAjax(a){var b=[];b.push(QMAjax.toString());b.push(["var QMAjaxSend =",QMAjax.send.toString()].join(""));globalEval(b.join(""),a);}var QMAjaxRequest=QMAjax;function getErrMsg(a,b){var e="_AjaxErrorHTML_";var c=S(e);if(!c){c=document.createElement("div");c.id=e;c.style.display="none";document.body.appendChild(c);}c.innerHTML=filteScript(a.status==200?a.responseText:"");var d=S(b);return d&&(d.innerText||d.textContent)||"";}function getHttpProcesser(){var d=getTop(),a=d.gCurHttpProcesserId||0;d.gCurHttpProcesserId=(a+1)%30;try{if(d.gHttpProcesserContainer[a]!=null){delete d.gHttpProcesserContainer[a];}}catch(b){d.gHttpProcesserContainer={};}var c=d.gHttpProcesserContainer[a]=new d.Image();c.onload=function(){return false;};return c;}function goUrl(b,c,a){try{var g=(b.contentWindow||b).location,f=g.href.split("#"),h=c.split("#"),d=h[0]==f[0],i=d?h[0]:c;if(a){g.href=i;}else{g.replace(i);}}catch(e){b.src=c;}}function generateFlashCode(d,c,a,b){var g=[],l=[],i=[],n=b||{},h=T(' $name$=$value$ '),m=T('<param name="$name$" value="$value$" />'),j=gbIsIE?T(['<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ','$codebase$ ','$attr$ $id$ >','$param$','<embed $embed$ type="application/x-shockwave-flash" ','$pluginspage$ ',' $name$ ></embed>','</object>']):T(['<embed $embed$ type="application/x-shockwave-flash" ','$pluginspage$ ',' $name$ $id$ ></embed>']);function e(o,p){return {name:o,value:p};}n.allowScriptAccess="always";n.quality="high";for(var f in n){var k=e(f,n[f]);l.push(m.replace(k));i.push(h.replace(k));}for(var f in a){var k=e(f,a[f]);g.push(h.replace(k));i.push(h.replace(k));}if(c){l.push(m.replace(e("movie",c)));i.push(h.replace(e("src",c)));}return j.replace({id:d&&[' id="',d,'"'].join(""),name:d&&[' name="',d,'"'].join(""),attr:g.join(""),param:l.join(""),embed:i.join(""),codebase:location.protocol=="https:"?'':'codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" ',pluginspage:location.protocol=="https:"?'':'pluginspage="http://www.adobe.com/cn/products/flashplayer" '});}function getFlash(b,a){var d=a||window,c=d[b]||d.document[b];return c&&(c.length?c[c.length-1]:c);}function zoomFuncCreater(a){return function(e,b,d,c){var h=d||a.limitWidth||1,g=c||a.limitHeight||1,k=(e/h)||1,f=(b/g)||1,n=[k<1?"w":"W",f<1?"h":"H"].join(""),m=a[n]||a.all,l={};switch(m){case "stretch":l.width=h;l.height=g;break;case "zoomMaxMin":case "zoomMinMax":var j=e>b?0:1;m=["zoomMax","zoomMin"][m=="zoomMinMax"?1-j:j];case "zoomMax":case "zoomMin":var i=Math[m=="zoomMax"?"min":"max"](f,k);l.width=Math.round(e/i);l.height=Math.round(b/i);break;case "none":default:l.width=e;l.height=b;break;}l.left=Math.round((h-l.width)/2);l.top=Math.round((g-l.height)/2);return l;};}function scrollIntoMidView(e,d,b,c,a){if(!e||!d){return false;}var f=d.tagName.toUpperCase()=="BODY",n=d.ownerDocument,o=n.documentElement;if(f&&o.clientHeight){d=o;}var l=calcPos(e)[0]-calcPos(d)[0]-(f?d.scrollTop:0),i=l,k=e.offsetHeight,h=d.clientHeight,g=c||0;if(b||i<0||i+k>h){var j=0,m;if(h>k+g){if(a){j=i<0?0:(h-k-g);}else{j=(h-k-g)/2;}}m=d.scrollTop=d.scrollTop+l-j;d==o&&(n.body.scrollTop=m);}return true;}function Gel(b,a){return (a||document).getElementById(b);}function objectActive(a){}function inherit(e,d,b,c,a){var h=callBack(b,[d.prototype]),f=h.$_constructor_,g=function(){if(arguments[0]!="__inherit__"){var i=callBack.call(this,a,arguments)||{};if(i.bReturn){return i.vData;}else{if(!this._mbIsBuildConstructor){this.constructor=arguments.callee;this._mbIsBuildConstructor=true;}d.apply(this,arguments);callBack.call(this,f,arguments);}}};extend(g.prototype=new d("__inherit__"),h,{toString:function(){return "";}});return extend(g,c,{name:e,superclass:d});}function inheritEx(d,c,a,b){var e={},f=inherit(d,c,a,b,function(){var h=typeof (arguments[0]),g=h=="string"||h=="undefined";return {bReturn:g,vData:f.$_call.apply(f,arguments)};});return extend(f,{$_call:function(h,i,g){if(arguments.length==0){return e;}else{var j=e[h];return arguments.length>1&&j?callBack.call(j,j[i],g):j;}},$_add:function(h,g){return e[h]=g;},get:function(g){return e[g];},$_del:function(g){delete e[g];}});}function cacheByIframe(a,b){var g=b||{},k=g.win||getTop(),l=g.id||unikey("_"),e=[g.attrs],f=[];for(var m=0,c=a&&a.length||0;m<c;m++){for(var h=a[m],n=2,d=h.length;n<d;n++){f.push(h[0],":",h[1],h[n],"|");}}e.push(' _file="',encodeURIComponent(f.join("")),'"');e.push(' _header="',encodeURIComponent(g.header||""),'"');e.push(' _body="',encodeURIComponent(g.body||""),'"');createIframe(k,getBlankUrl(k),extend({},g,{id:l,attrs:e.join(""),onload:function(i){var j=this;callBack.call(j,g.onload,[i]);(g.destroy!=false||j.getAttribute("destroy")=="true")&&k.setTimeout(function(){removeSelf(j);},100);}}));}function getBlankUrl(a){var b=(a||getTop()).location,c="/zh_CN/htmledition/"+getFullResSuffix("domain.html");return [c,"?",document.domain!=b.host?encodeURIComponent(document.domain):"",b.href.indexOf(c)!=-1?"&r="+Math.random():""].join("");}function clearCache(){arguments.length>0&&getTop().cacheByIframe(arguments,{destroy:false,onload:function(){if(!this.getAttribute("destroy")){this.setAttribute("destroy","true");this.contentWindow.location.reload(true);}}});}function preLoad(d,c,b,a){if(window!=getTop()){getTop().preLoad.apply(this,arguments);}else{var g=arguments.callee,h=g._moWaitqueue=(g._moWaitqueue||[]);if(d&&b){for(var j=0,f=b.length;j<f;j++){h.push([[d,c,b[j]]]);}}if(!g._mbIsRun&&h.length>0){g._mbIsRun=true;function e(){g._mbIsRun=false;callBack(a,[h.shift()[0][2]]);setTimeout(function(){g("","","",a);},100);}cacheByIframe(h[0],{onload:e});}}}function setDblClickNoSel(a){if(a){var b="__MoUSeDoWnnoSEL__";function c(){return (a.getAttribute(b)||"").toString().split(",");}function d(e,f){a.setAttribute(b,[e,f]);}if(c().length==1){d(0,"up");addEvents(a,{mousedown:function(e){var f=now(),g=parseInt(c()[0]);d(f,"down");if(f-g<500){preventDefault(e);}},mouseup:function(){d(c()[0],"up");},selectstart:function(e){if(c().pop()=="up"){preventDefault(e);}}});}}return a;}function getDomain(a){return [["foxmail.com","qq.com","biz"],["Foxmail.com","QQ","\u817E\u8BAF"]][a?1:0][/,7$/.test(getSid())?2:(location.href.indexOf("foxmail.com")>-1?0:1)];}var GetDomain=getDomain;function getSid(){return getTop().g_sid||(S("sid")?S("sid").value:location.getParams(getTop().location.href)["sid"]);}var GetSid=getSid;function getUin(){return getTop().g_uin;}function getPaths(){var a={images_path:getTop().images_path||"/zh_CN/htmledition/images/",js_path:getTop().js_path||"/zh_CN/htmledition/js/",css_path:getTop().css_path||"/zh_CN/htmledition/css/",style_path:getTop().style_path||"/cgi-bin/getcss?sid="+getSid()+"ft=",swf_path:getTop().swf_path||"/zh_CN/htmledition/swf/",stationery_path:"http://rescdn.qqmail.com/zh_CN/",card_path:"http://rescdn.qqmail.com/zh_CN/",mo_path:"http://rescdn.qqmail.com/zh_CN/",editor_path:getTop().editor_path||"/zh_CN/htmledition/qqmaileditor/",base_path:"/",skin_path:"0"};for(var b in a){a[b]=trim(getTop()[b])||a[b];}return a;}function getPath(b,a){b=="image"&&(b+="s");var c=getPaths()[b+"_path"]||"";if(c){if(a&&b!="skin"&&c.indexOf("http")!=0){c=[location.protocol,"//",location.host,c].join("");}}return c;}function getRes(a){return T(a).replace(getPaths(),true);}function getFullResSuffix(a){if(!getTop().gLn){return a;}var b,d,c=".j"+"s";if(a.indexOf(c)>0){b=a.substr(0,a.indexOf(c));d=c;}else if(a.indexOf(".css")>0){b=a.substr(0,a.indexOf(".css"));d=".css";}else if(a.indexOf(".html")>0){b=a.substr(0,a.indexOf(".html"));d=".html";}if(b.length>0&&getTop().gLn[b]){return b+getTop().gLn[b]+d;}else{return a;}}function outputJsReferece(c,a,b){var i=c||outputJsReferece._msPath,f=a||outputJsReferece._moFileList,h=b||window,g=T(['<script language="JavaScript" src="$file$',(i.indexOf("?")==-1?'':'&r='+Math.random()),'"></','script>']),e=[];outputJsReferece._msPath=i;outputJsReferece._moFileList=f;function d(j){var k=trim(j||""),l=/[0-9a-fA-F]{6}\.js$/.test(k)?j.substr(0,j.length-9):j.split(".")[0];if(l&&(c||!h[l+"_js"])){e.push(g.replace({file:i+j}));}}E(f,d);return e.join("");}function runUrlWithSid(a){try{getTop().getHttpProcesser().src=T('$url$&sid=$sid$&r=$rand$').replace({url:a,sid:getSid(),rand:Math.random()});}catch(b){}}function createBlankIframe(b,a){cacheByIframe(a&&a.defcss==false?[]:[["css","",getRes("$css_path$comm.css")],["css",getPath("style"),"skin"]],extend({className:"menu_base_if",transparent:false,destroy:false},a,{win:b,header:["<script>",getTop.toString().replace(/[\r\n]/g,""),"<\/script>",a&&a.header||""].join(""),onload:function(c){if(this.getAttribute("cbi_inited")!="true"){a&&a.transparent&&(this.contentWindow.document.body.style.background="transparent");this.setAttribute("cbi_inited","true");}callBack.call(this,a&&a.onload,[c]);}}));}function createActionFrame(a){return createBlankIframe(a,{id:"actionFrame",defcss:false,onload:actionFinishCheck});}function calcMainFrameDomInGlobalPos(a,b){var k=calcPos(a),j=calcPos(S("mainFrame",getTop())),h=getMainWin().document,i=h.documentElement,g=h.body,d=k[3]+j[3]-(i.scrollLeft||g.scrollLeft||0),e=k[0]+j[0]-(i.scrollTop||g.scrollTop||0),f=k[4],c=k[5];return b=="json"?{top:e,bottom:e+c,left:d,right:d+f,width:f,height:c}:[e,d+f,e+c,d,f,c];}var gsMsgNoSubject="\u8BF7\u586B\u5199\u90AE\u4EF6\u4E3B\u9898",gsMsgNoMail="\u672A\u9009\u4E2D\u4EFB\u4F55\u90AE\u4EF6",gsMsgSend="\u90AE\u4EF6\u6B63\u5728\u53D1\u9001\u4E2D... ",gsMsgSave="&nbsp;&nbsp;&nbsp;\u90AE\u4EF6\u6B63\u5728\u4FDD\u5B58\u5230\u8349\u7A3F\u7BB1...",gsMsgSaveOk="\u90AE\u4EF6\u6210\u529F\u4FDD\u5B58\u5230\u8349\u7A3F\u7BB1",gsMsgAutoSave="&nbsp;&nbsp;&nbsp;\u90AE\u4EF6\u6B63\u5728\u4FDD\u5B58\u5230\u8349\u7A3F\u7BB1...",gsMsgAutoSaveOk="\u90AE\u4EF6\u81EA\u52A8\u4FDD\u5B58\u5230\u8349\u7A3F\u7BB1",gsMsgSendErrorSaveOK="\u4FE1\u4EF6\u5DF2\u88AB\u4FDD\u5B58\u5230\u8349\u7A3F\u7BB1",gsMsgSaveErr="\u90AE\u4EF6\u672A\u80FD\u4FDD\u5B58\u5230\u8349\u7A3F\u7BB1",gsMsgNoSender="\u8BF7\u586B\u5199\u6536\u4EF6\u4EBA\u540E\u518D\u53D1\u9001",gsMsgNoCardSender="\u8BF7\u586B\u5199\u6536\u4EF6\u4EBA\u540E\u518D\u53D1\u9001",gsMsgNoCard="\u8BF7\u9009\u4E2D\u8D3A\u5361\u540E\u518D\u53D1\u9001",gsMsgSettingOk="\u8BBE\u7F6E\u4FDD\u5B58\u6210\u529F",gsMsgLinkErr="\u7F51\u7EDC\u5E94\u7B54\u5931\u8D25",gsMsgCheatAlert="\u7CFB\u7EDF\u4F1A\u5C06\u6B64\u90AE\u4EF6\u79FB\u5165\u5230\u201C\u5783\u573E\u90AE\u4EF6\u201D\u4E2D\uFF0C\u5E76\u628A\u90AE\u4EF6\u5185\u5BB9\u63D0\u4EA4\u7ED9\u90AE\u7BB1\u7BA1\u7406\u5458\u3002\n\n\u60A8\u786E\u5B9A\u8981\u4E3E\u62A5\u6B64\u90AE\u4EF6\u5417\uFF1F",gsMsgSendTimeErr="\u60A8\u8BBE\u7F6E\u7684\u53D1\u9001\u65F6\u95F4\u4E0D\u5B58\u5728",gsMsgMoveMailSameFldErr="\u4E0D\u80FD\u79FB\u52A8\u5230\u76F8\u540C\u7684\u76EE\u5F55";function doPageError(b,c,a){var d=arguments.callee.caller,f=d&&d.caller,e=f&&f.caller,m=(d||"null").toString(),l=(f||"").toString(),k=(e||"").toString(),n;try{if(b.indexOf(" Script ")!=-1){return;}if(b.indexOf("flashUploader")!=-1){var j=qmFlash.getFlashVer();for(var o in j){b+="|"+j[o];}}if(!(c&&c.indexOf("/cgi-bin/mail_list?")!=-1&&a==2)&&location.getParams){var h=location.getParams(c);_oCgiPart=c.split("?")[0].split("/"),_sErrFunc=encodeURIComponent(m.replace(/[\r\n\t ]/ig,"").substr(0,50));if(_oCgiPart.length>0){h.cgi=_oCgiPart.pop();getTop().ossLog("delay","sample",["stat=js_run_err&msg=",b,"&line=",a,"&url=",T('$cgi$?t=$t$&s=$s$').replace(h),"&func=",_sErrFunc,(gbIsIE?"":"_NIE")].join(""));}else{n=_sErrFunc;}}getTop().debug(["error:",b,"<br><b>line</b>:",a,"<br><b>url</b>:",c,"<br><b>function</b>:",m.substr(0,100),l?"<br><b>parent function</b>:"+l.substr(0,100):"",k?"<br><b>parent parent function</b>:"+k.substr(0,100):""].join(""),"error");}catch(g){n=g.message;}return location.host.indexOf("dev.")!=0;}var QMFileType={};QMFileType.data={doc:"doc",docx:"doc",xls:"exl",xlsx:"exl",ppt:"ppt",pptx:"ppt",pdf:"pdf",txt:"txt",log:"txt",xml:"txt",js:"txt",css:"txt",php:"txt",asp:"txt",aspx:"txt",jsp:"txt",vbs:"txt",h:"txt",cpp:"txt",eml:"eml",rar:"rar",zip:"rar","7z":"rar",arj:"rar",wav:"mov",mp3:"mov",wma:"mov",mid:"mov",rmi:"mov",ra:"mov",ram:"mov",mp1:"mov",mp2:"mov",mp4:"mov",rm:"mov",rmvb:"mov",avi:"mov",mov:"mov",qt:"mov",mpg:"mov",mpeg:"mov",mpeg4:"mov",dat:"mov",asf:"mov",wmv:"mov","3gp":"mov",ac3:"mov",asf:"mov",divx:"mov",mkv:"mov",ogg:"mov",pmp:"mov",ts:"mov",vob:"mov",xvid:"mov",htm:"html",html:"html",mht:"html",swf:"swf",flv:"swf",bmp:"bmp",gif:"gif",jpg:"jpg",jpeg:"jpg",jpe:"jpg",psd:"psd",pdd:"psd",eps:"psd",tif:"tu",tiff:"tu",ico:"tu",png:"tu",pic:"tu",ai:"tu"};QMFileType.getFileType=function(a){return this.data[(trim(a||"")).toLowerCase()]||"qita";};QMFileType.getFileTypeForFile=function(a){return this.getFileType((a||"").split(".").pop());};var QMHistory={_moParam:{},_moCaches:{}};QMHistory.getId=function(a){return a;};QMHistory.getUrl=function(a){var b=getTop().QMHistory._moCaches[QMHistory.getId(a)];return b&&b._sUrl;};QMHistory.getLastRecordId=function(){return getTop().QMHistory._moParam._sLastUrlRecordId;};QMHistory.tryBackTo=function(a){try{var h=getTop().QMHistory._moParam,j=QMHistory.getId(a),g=getTop().QMHistory._moCaches[j],i=g&&g._sUrl,b=g&&g._nHistoryLen>=getTop().history.length,c=g&&h._sPreMainWinUrl==i,d=g&&!h._bIsActionFrameUrlChange;function e(){var k=i.split("#")[0];if(getTop().location.getParams&&getTop().location.getParams(k)["folderid"]==4){return goUrlMainFrm(k);}if(gbIsIE&&gnIEVer==6){return getTop().history.go(k);}getTop().history.back();};if((gbIsIE&&(b||c)&&d)||(!gbIsWebKit&&b&&c&&d)){e();return true;}}catch(f){}return false;};QMHistory.recordCurrentUrl=function(a){var h=a.location.href,b=getTop().QMHistory._moCaches,c=getTop().QMHistory._moParam;var g=c._sPreMainWinUrl=c._sCurMainWinUrl,e=c._sCurMainWinUrl=h;var f,d;for(var j in b){if(b[j]._sUrl==g){f=j;}if(b[j]._sUrl==e){d=j;}}if(f&&d){delete b[f];}if(h.indexOf("/mail_list")!=-1){this._recordInfo("mail_list",h);}if(h.indexOf("t=readmail")!=-1){this._recordInfo("readmail",h);}if(h.indexOf("/today")!=-1){this._recordInfo("today",h);}};QMHistory.recordActionFrameChange=function(a){getTop().QMHistory._moParam._bIsActionFrameUrlChange=a!="clear";};QMHistory._recordInfo=function(a,b){var e=getTop(),f=QMHistory.getId(a),d=e.QMHistory._moCaches,c=d[f];if(!c){c=d[f]=new e.Object();}c._nHistoryLen=history.length+1;c._sUrl=b;e.QMHistory._moParam._sLastUrlRecordId=a;};function QMCache(a){var c=this._mnTimeStamp=a.timeStamp||1;var e=this._msAppName=a.appName;if(!c||!e){throw {message:"QMCache construct : config error!"};}var d=getTop().QMCache._moCacheSet;if(!d){d=getTop().QMCache._moCacheSet={};}var b=d[e];if(!b){b=d[e]={_curTimeStamp:"0",_data:{}};}if(this._compareTimeStamp(b._curTimeStamp,c)==1){b._curTimeStamp=c;}};QMCache.prototype.isHistoryTimeStamp=function(){return this._compareTimeStamp(getTop().QMCache._moCacheSet[this._msAppName]._curTimeStamp,this._mnTimeStamp)!=0;};QMCache.prototype.setData=function(a,b){getTop().QMCache._moCacheSet[this._msAppName][a]=b;};QMCache.prototype.getAll=function(a){return getTop().QMCache._moCacheSet[this._msAppName];};QMCache.prototype.getData=function(a){return getTop().QMCache._moCacheSet[this._msAppName][a];};QMCache.prototype.delData=function(a){delete getTop().QMCache._moCacheSet[this._msAppName][a];};QMCache.prototype._compareTimeStamp=function(a,b){if(a==b){return 0;}return a>b?-1:1;};var QMMailCache={_mId:now()};QMMailCache.newCache=function(b,a){var c=false,d=getTop();if(!d.gMailListStamp||d.gMailListStamp<a){d.gMailListStamp=a;if(!d.goMailListMap){d.goMailListMap=new d.Object();}c=true;}else if(d.gnExpireTimeStamp>=a){reloadFrm(b);}return b["isNewQMMailCache"+this._mId]=c;};QMMailCache.setExpire=function(){getTop().gnExpireTimeStamp=getTop().gMailListStamp;};QMMailCache.addData=function(b,a){if(!b||!getTop().goMailListMap){return;}if(!this.hasData(b)){getTop().goMailListMap[b]={oTagIds:{},star:null,reply:null};}if(!a){return;}var c=getTop().goMailListMap[b];for(var d in a){switch(d){case "removeTagId":c.oTagIds[a[d]]=0;break;case "addTagId":c.oTagIds[a[d]]=1;break;default:if(typeof a[d]!="undefined"){c[d]=a[d];}break;}}};QMMailCache.delData=function(a){if(getTop().goMailListMap){delete getTop().goMailListMap[a];}};QMMailCache.hasData=function(a){return getTop().goMailListMap&&getTop().goMailListMap[a]!=null;};QMMailCache.getData=function(a){return getTop().goMailListMap&&getTop().goMailListMap[a];};QMMailCache.addVar=function(b,a){return getMainWin()[b]=this.getVar(b,0)+a;};QMMailCache.getVar=function(b,a){return getMainWin()[b]||a;};QMMailCache.isRefresh=function(a){return a["isNewQMMailCache"+this._mId];};function rdVer(c,a,b){var f,h,g,d,i=new QMCache({appName:"readmail"});if(a==-1){return i.delData(c);}f=i.getData("on");if(c=="on"){return a==0?(f||0):(i.setData("on",a));}if(!f||!c){return 0;}d=c=="BaseVer";g=i.getData("BaseVer");if(!g||(d&&a==1)){g=g||(rdVer("on",0)+Math.random().toFixed(2));g+=10;i.setData("BaseVer",g);}if(d){return g;}h=(i.getData(c)||0);var e=(!h||a==1);if(e||b){if(e){h+=10000;}if(b){h=Math.floor(h/10000)*10000+parseInt(b,10)%10000;}i.setData(c,h);}return h;}rdVer.batch=function(a){var b=new QMCache({appName:"readmail"}),d=new RegExp("^"+a),c=b.getAll();E(c,function(f,e){if(d.test(e)){rdVer(e,1);}});};rdVer.check=function(b,c,a){if(b){var e=b.location,c=c||e.getParams()["mailid"],a=a||e.getParams()["ver"]||0,d=rdVer(c,0);if(d>a){goUrl(b,cookQueryString(e.href,{ver:d}),true);return true;}else{return false;}}};rdVer.log=function(a,b){var f=new QMCache({appName:"preload"}),d=new Date().getTime(),e=f.getData(a),c=e&&(d-e)<rdVer.maxage(a)*1000;switch(b){case "pre":if(!c){f.setData(a,d);ossLog("delay","all","stat=rdcache&type=281&locval=,rdcache,preload,1");}break;case "hit":if(c){ossLog("delay","all","stat=rdcache&type=291&locval=,rdcache,hit,1");}if(e){f.delData(a);}break;}return c;};rdVer.isPre=function(a){return !(a>2&&a<7||a==9);};rdVer.preRD=function(b,a){var c=function(){preLoad("html","/cgi-bin/readmail?",b,function(d){rdVer.log(location.getParams(d)["mailid"],"pre");});};if(b&&b.length>0){a=a||40;b=b.slice(0,rdVer("on",0)>1?2:1);if(b.length>0){if(a){setTimeout(c,a);}else{c();}}}};rdVer.maxage=function(a){if(!a){return 0;}return (a[0]=="@"||a[0]=="C"?10:60)*60;};rdVer.url=function(h,g,i,e,b,d,a,f,c){var m=T('/cgi-bin/$cgi$?folderid=$folderid$$s$&t=$t$&mailid=$mailid$$cache$&sid=$sid$'),j,p,o,q,n="readmail";var k=parseInt(g);if(a){p="readmail&s=draft";}else if(e===0){p=f==100?"compose_card&s=draft":"compose&s=draft";}else if(g=="9"){p="sms_list_v2";n="readtemplate";}else if(g=="11"){n="bottle_panel";p="bottle";}else if(k>200900&&k<205012){n='archive_readmail';p="archive_readmail";}else{switch(h.charAt(0)){case 'C':p="readmail_conversation";break;case '@':p="readmail_group";break;default:p="readmail";break;}j=true;}if(b){o=["&newwin=true","&compose_new=compose"][e?0:1];}else{o=["","&s=from_unread_list","&s=from_star_list"][d!=1&&d!=2?0:d];}var l=j?rdVer(h,0,i):0;if(!l&&c){return "";}q=m.replace({cgi:n,mailid:h,folderid:g,t:p,s:o,sid:getSid(),cache:l?T("&mode=pre&maxage=$maxage$&base=$base$&ver=$ver$").replace({maxage:rdVer.maxage(h),base:rdVer("BaseVer",0),ver:l}):""});return c?q.split("?")[1]:q;};function setGlobalVarValue(b,c,a){var d=getTop();if(!d.goDataBase){d.goDataBase=new d.Object();}if(b&&!a){d.goDataBase[b]=c;getTop().getSignatureData()[b]=c;}return c;}function getGlobalVarValue(a){return getTop().goDataBase&&getTop().goDataBase[a]||getTop().getSignatureData()[a];}function hideWindowsElement(b,a){a=a||getMainWin();if(!gbIsIE||gnIEVer>6||(a.gbIsHasHideElements||false)!=(b||false)){return;}getTop().setGlobalVarValue("WINDOWS_ELEMENT_NOT_DISPLAY",b?"":"true");a.gbIsHasHideElements=!b;var c=a.document.body;E(a.QMReadMail?["select","object","embed"]:["select"],function(d){E(GelTags(d,c),function(e){if(b){e.style.visibility=e.getAttribute("savevisibility");}else{e.setAttribute("savevisibility",getStyle(e,"visibility"));e.style.visibility="hidden";}});});}function controlWindowsElement(){var a=getTop().getGlobalVarValue("WINDOWS_ELEMENT_NOT_DISPLAY");if(a=="true"){hideWindowsElement(false);}}function setKeepAlive(a){if(getTop().gKeepAliveNum==null){getTop().gKeepAliveNum=0;}if(a==null||a.gbIsSetKeepAlive==true){return;}a.gbIsSetKeepAlive=true;getTop().gKeepAliveNum++;if(getTop().gKeepAliveTimer==null){getTop().gKeepAliveTimer=getTop().setInterval(function(){getTop().runUrlWithSid("/cgi-bin/readtemplate?t=keep_alive");},15*60*1000);}addEvent(a,"unload",function(){a.gbIsSetKeepAlive=false;getTop().gKeepAliveNum--;if(getTop().gKeepAliveNum==0){getTop().clearInterval(getTop().gKeepAliveTimer);getTop().gKeepAliveTimer=null;}});}function encodeNick(a){return a&&a.replace(/\\/g,"\\\\").replace(/\"/ig,"\\\"").replace(/\'/ig,"\\\'")||"";}function decodeNick(a){return a&&a.replace(/\\\"/ig,"\"").replace(/\\\\/ig,"\\")||"";}var QMPageInit={_debugCreater:function(a){return function(){var e=getTop();var b=arguments.length;if(e.Console){if(b==0){if(location.host=="dev.exmail.qq.com"){}}else{try{if(e.console){e.console.log&&e.console.log(arguments[0]);}var c=e.Console[a];c.add.apply(c,arguments);}catch(d){}}}};},_traceCreater:function(a){return function(e,c,d,f,b){if(getTop().QMTimeTracer&&(!b||b==getTop().g_uin)){getTop().QMTimeTracer.getTracer().trace(e,c,a,d,f);}};},_initLocation:function(a){var b=a.location;b._bIsAnalyse=false;b.params={};b.getParams=function(e){if(!e&&this._bIsAnalyse){return this.params;}var f={},g=e?e.substr(e.indexOf("?")+1).split("#")[0]:this.search.substr(1);if(g){E(g.split("&"),function(h){var i=h.split("=");f[i.shift()]=unescape(i.join("="));});}if(!e){this.params=f;this._bIsAnalyse=true;}return f;};var d=b.href,c=getTop();if(a==c&&getSid()&&d.indexOf("/cgi-bin/")>-1&&d.indexOf("/frame_html?")==-1&&d.indexOf("/log")==-1&&(d.indexOf("/ftnExs_")==-1||d.indexOf("/ftnExs_files")>-1)&&!a.gbIsNoCheck&&b.getParams()["nocheckframe"]!="true"){if(top.location.href.indexOf("/cgi-bin/bizmail?")==-1){goNewWin(b,true,!a.gbSupportNW);}}else if(a!=c&&c.bnewwin&&a==getMainWin()){if(!a.gbSupportNW){goNewWin(b,true,true);}else if(b.getParams()["newwin"]!="true"){a.location.replace(d+"&newwin=true");}}},_initPageKeyDown:function(b,a){var n=b.srcElement||b.target,d=b.ctrlKey,h=b.altKey,f=b.shiftKey,j=b.keyCode,i=n.type=="text"||n.tagName=="TEXTAREA",e=a&&(n.tagName=="INPUT"&&n.type!="button"),c=n.tagName=="BUTTON"||n.type=="button";switch(j){case 8:if(!i&&goBackHistory()){preventDefault(b);}break;case 13:if(!c&&((!i&&QMReadedItem.read(n))||e)){preventDefault(b);}break;case 37:case 39:if(d){goPrevOrNextMail(j==39);preventDefault(b);}break;case 38:case 40:case 188:case 190:if(!i){var g=j==38||j==188;if(QMReadedItem.move(!g)){preventDefault(b);}}break;case 46:if(!i){var k=S(f?"quick_completelydel":"quick_del",getMainWin()),l=f?S("quick_del",getMainWin()):null,m=S("del",getMainWin());if(isShow(k)||isShow(l)||isShow(m)){preventDefault(b);fireMouseEvent((k||l||m),"click");}}break;case 88:if(!i&&QMReadedItem.check(f)){preventDefault(b);}break;}},_initDebug:function(a){a.Debug=a.debug=this._debugCreater("debug");a.Log=a.log=this._debugCreater("log");a.Watch=a.watch=this._debugCreater("watch");a.Trace=a.trace=this._traceCreater(a);a.onerror=doPageError;},_initMainWinEvent:function(a){if(a!=getTop()&&a==getMainWin()){getTop().QMHistory.recordCurrentUrl(a);getTop().QMHistory.recordActionFrameChange("clear");var d=a.location.href,c=d.indexOf("t=sms_list_v2")>0,b=d.indexOf("t=bottle")>0;addEvent(a,"unload",function(){showProcess(0);if(isshowMsg()&&getTop().gMsgDispTime&&now()-getTop().gMsgDispTime>2000){hiddenMsg();}c&&startWebpush(2);});c&&closeWebpush(2);b&&closeWebpush(4);getTop().QMWebpushTip&&getTop().QMWebpushTip.hideAll(3000);a.setTimeout(function(){},200);}},_initTopWinEvent:function(a){if(a==getTop()&&a.location.href.indexOf("/frame_html")!=-1){var b=function(){var d;if(getMainWin()!=a&&getUserCookie("reloadurl")!="noreload"&&!getMainWin().gbIsNoCheck){try{var c=getMainWin().location;d=c.getParams()["sid"]&&(c.pathname+_trimUrlSearchParam(c.search));}catch(f){}}setUserCookie("reloadurl",d||"",new Date(now()+5*1000));};addEvents(a,{load:function(i){var g=getTop().document.body;function d(e){var k=e.srcElement||e.target;for(var j=0;k&&j<3;k=k.parentNode,j++){if(k.tagName=="A"){break;}}return k||{};};function h(e){if((e.target||e.srcElement)==g){preventDefault(e);}}function f(e){var k=d(e);if(k.tagName=="A"){if(k.getAttribute("initlized")=="nocheck"){return true;}if(k.getAttribute("initlized")!="true"){k.setAttribute("initlized","true");var j=k.onclick;k.onclick=function(l){var p=l||getTop().event,o=parseInt(k.getAttribute("md"));if(!isNaN(o)&&o>0){getTop().clearTimeout(o);k.setAttribute("md","0");var n=p.shiftKey,m=trim(k.href).indexOf("http")==0;function q(){if(j){j.call(k);preventDefault(p);}if(m){if(n&&k.href.indexOf("java")!=0){open(k.href);preventDefault(p);}else{switch(k.target){case "mainFrame":var s=k.href;goUrlMainFrm(s+(s.indexOf("?")!=-1?"#stattime="+now():""),false);preventDefault(p);break;case "_parent":case "_self":try{a.location.href=k.href;}catch(r){}preventDefault(p);break;default:break;}}}};if(!n&&k.getAttribute("nocheck")!="true"&&(!m||k.target!="_blank")){preventDefault(p);QMPageInit._runFuncAfterCheckMainFrame(q);}else{q();}}};}k.setAttribute("md",getTop().setTimeout(function(){k.setAttribute("md","0");},1000));}}function c(e){var j=d(e);if(j.tagName=="A"&&j.getAttribute("initlized")!="true"){preventDefault(e);}}addEvents(g,{mousewheel:h,mousedown:f,keydown:f,click:c});},beforeunload:b,unload:b});}},_detectMouseT:function(c,b){var f,a=["u","1","2","3"],e=getEventTarget(b),d=function(g){if(g&&g.getAttribute){var h=g.getAttribute("t");for(var j in a){if(a[j]==h){return h;}}}};f=d(e);while(e&&e!=c.document.body&&f){if(f=="u"){e=e.parentNode;f=d(e)||f;}else{return e;}}return null;},_initPageMouse:function(c,b,a){var d=this._detectMouseT(b,a);if(d){var e=d.getAttribute("t");switch(e){case "1":case "2":case "3":waitFor(function(){return getTop().QMProfileTips;},function(f){if(f){getTop().QMProfileTips.doMouseEvent(c,b,d);}});break;}}},_initPageEventDelay:function(a){var b=this;a.setTimeout(function(){var c=(a.location.getParams&&a.location.getParams()["t"]||"").indexOf("compose")==0;addEvents(a.document,{mousedown:hideMenuEvent,touchend:getTop().iPadCloseMenu||function(){},keydown:function(d){hideMenuEvent(d);b._initPageKeyDown(d,c);},click:function(d){hideEditorMenu();getTop().QMWebpushTip&&getTop().QMWebpushTip.hideAll(3000);},mouseover:function(d){b._initPageMouse("over",a,d);},mouseout:function(d){b._initPageMouse("out",a,d);}});},100);},_initlize:function(a){a=a||window;if(a.gIsInitPageEventProcess){return;}a.gIsInitPageEventProcess=true;var b=0;try{b=1;this._initDebug(a);b=2;this._initLocation(a);b=3;this._initMainWinEvent(a);b=4;this._initTopWinEvent(a);b=5;this._initPageEventDelay(a);getTop().gbIsMac&&a.document.documentElement&&(a.document.documentElement.className+=" MacOS");}catch(c){doPageError(c.message,a.location.href,"initPageEvent_processid:"+b);}try{a.document.execCommand("BackgroundImageCache",false,true);}catch(c){}},_runFuncAfterCheckMainFrame:function(a){try{if(getMainWin().exitConfirm){return getMainWin().exitConfirm(a);}}catch(b){debug(b.message);}a();}};function initPageEvent(a){QMPageInit._initlize(a);}(function(){initPageEvent(window);})();function getTopWin(){return getTop();}function getMainWin(){return F("mainFrame",getTop())||getTop();}function getActionWin(){return F("actionFrame",getTopWin());}function getLeftWin(){return getTop();}var GetLeftWin=getLeftWin;function getLeftDateWin(){return F("leftFrame",getTop());}function getSignatureWin(){return F("signatureFrame",getTop());}function getSignatureData(){return getTop().goUserInfo._oData;}function reloadFrm(a){if(a){try{if(a.location.search){var c=a.location.href.split("#")[0].split("?"),d="r="+now();c[1]=!c[1]?d:(("&"+c[1]+"&").replace(/&r=.*?&/,"&")+d).slice(1);a.location.replace(c.join("?"));return true;}}catch(b){}}return false;}function reloadLeftWin(){var a;if(!reloadFrm(getLeftDateWin())&&(a=S("leftFrame",getTop()))){a.src=T('/cgi-bin/folderlist?sid=$sid$&r=$rand$').replace({sid:getSid(),rand:Math.random()});}}function reloadAllFrm(d,c,a,b){function e(f){var g=arguments.callee;getTop().setTimeout(f,g._time);g._time+=200;}e._time=0;if(b==null||b){e(function(){reloadFrm(getMainWin());});}if(a==null||a){e(function(){reloadFrm(reloadLeftWin());});}}function reloadFrmLeftMain(a,b){reloadAllFrm(false,false,a,b);}function _unReloadUrl(){setUserCookie("reloadurl","noreload",new Date(now()+5*1000));}function goUrlTopWin(b,a){_unReloadUrl();goUrl(getTop(),b,!a);}function goUrlMainFrm(c,b,a){if(b!=false){reloadLeftWin();setTimeout(function(){goUrl(S("mainFrame",getTop())||getTop(),c,!a);},300);}else{goUrl(S("mainFrame",getTop())||getTop(),c,!a);}}function _trimUrlSearchParam(a){return a&&a.substr&&("?"+(["&",a.substr(1),"&"].join("").replace(/&sid=.*?&/ig,"&").replace(/&loc=.*?&/ig,"&").replace(/&newwin=true/ig,"&").slice(1,-1)));}function goNewWin(d,b,a,c){var f="",h="",i="";if(typeof (d)=="object"){f=d.pathname;h=d.search;}else{var e=d.indexOf("?");f=d.substring(0,e);h=d.substr(e);}if(c){i=c.frametmpl;}else{i=a?"frame_html":"newwin_frame";}var g='';if(f.indexOf('reader_')>-1){g=getTop().location.protocol+"//mail.qq.com";}var j=T(g+'/cgi-bin/frame_html?t=$t$&sid=$sid$&url=$url$').replace({t:i,sid:getSid(),url:encodeURIComponent(f+_trimUrlSearchParam(h))});if(c){j+=c.frametmplparam;}if(b){goUrlTopWin(j,true);}else{_unReloadUrl();window.open(j);}}function isMaximizeMainFrame(){return getTop().maximizeMainFrame._bIsMaximizeMainFrame;}function maximizeMainFrame(a){var f=S("mainFrame",getTop()),e=S("leftPanel",getTop()),d=S("imgLine",getTop());if(!f||!d||!e||a!=2&&(a==0)==!isMaximizeMainFrame()){return false;}var c=getTop().maximizeMainFrame,b=c._bIsMaximizeMainFrame=a==2?!isMaximizeMainFrame():(a?true:false);if(b){c._sBackupMarginLeft=e.style.width;c._sImgParentCssText=d.parentNode.style.cssText;}f.parentNode.style.marginLeft=b?"5px":c._sBackupMarginLeft;e.parentNode.style.cssText=b?"border-left:none;":"";d.parentNode.style.cssText=(b?"border-left:none;margin-left:0;padding:0;":"")+c._sImgParentCssText;show(e,!b);show(d,!b);show(S("folder",getTop()),!b);}function filteSignatureTag(b,a){var c=typeof b=="string"?b:"";if(a=="2LOWCASE"){return c.replace(/<sign(.*?)\/>/ig,"<sign$1>").replace(/<qzone(.*?)\/>/ig,"<qzone$1>").replace(/<taotao(.*?)\/>/ig,"<taotao$1>").replace(/<\/sign>/ig,"</sign>").replace(/<\/qzone>/ig,"</qzone>").replace(/<\/taotao>/ig,"</taotao>").replace(/<(\/?)includetail>/ig,"<$1tincludetail>");}if(a=="FILTE<:"){return c.replace(/<:sign.*?>/ig,"").replace(/<:qzone.*?>/ig,"").replace(/<:taotao.*?>/ig,"").replace(/<:includetail.*?>/ig,"");}else{return c.replace(/<\/?sign.*?>/ig,"").replace(/<\/?qzone.*?>/ig,"").replace(/<\/?taotao.*?>/ig,"").replace(/<\/?includetail.*?>/ig,"");}}function getSignatureHeader(){var a=((arguments[0]&&arguments[0]==1)?true:false);return T(['<div style="color:#909090;font-family:Arial Narrow;font-size:12px">','<br />','<br />','<br />','<br />',(a?'':'------------------'),'</div>']);}window.g_sBaseImageUrl=getTop().getPath("stationery");if(!getTop().goUserInfo){getTop().goUserInfo={_sStatus:'init',_fCallbacks:{},_oData:{},_doCallback:function(){for(var d in getTop().goUserInfo._fCallbacks){for(var b=0,c=getTop().goUserInfo._fCallbacks[d].length;b<c;b++){try{getTop().goUserInfo._fCallbacks[d][b](getTop().goUserInfo.get(d));}catch(a){}}}getTop().goUserInfo._fCallbacks={};},get:function(a){if(getTop().goUserInfo._sStatus=='init'){getTop().goUserInfo.reset();return '';}else{if(typeof getTop().goUserInfo._oData[a]==='undefined'){return '';}return getTop().goUserInfo._oData[a];}},deferget:function(b,a){if(getTop().goUserInfo._sStatus=='init'){if(typeof getTop().goUserInfo._fCallbacks[b]==='undefined'){getTop().goUserInfo._fCallbacks[b]=[];}getTop().goUserInfo._fCallbacks[b].push(a);getTop().goUserInfo.reset();}else{a(getTop().goUserInfo._oData[b]);}},set:function(a){extend(getTop().goUserInfo._oData,a);},reset:function(){if(getTop().goUserInfo._sStatus=='loading'){return;}getTop().goUserInfo._sStatus='loading';var a=T(["/cgi-bin/getcomposedata?t=signature&fun=compose&sid=$sid$&qzonesign=$qzonesign$&r=$rand$"]).replace({sid:getSid(),qzonesign:"",rand:now()});QMAjax.send(a,{method:"GET",timeout:10000,headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},onload:function(b,c){var d=trim2(c);if(b&&d.indexOf("(")==0){getTop().goUserInfo._sStatus='ready';getTop().goUserInfo.set((function(){return (new Function("return "+d))();})());directChangeSkin();}else{getTop().goUserInfo._sStatus='init';}getTop().goUserInfo._doCallback();}});}};}function checkSignatureFrame(){if(getTop().gLoadSignTimeout){getTop().clearTimeout(getTop().gLoadSignTimeout);getTop().gLoadSignTimeout=null;}if(getSignatureData()){getTop().gSignStatus="finish";var a=true;try{if(!getSignatureData().RealUserSignature){a=false;}}catch(b){a=false;}if(!a&&getTop().reloadSignTimeout==null){getTop().gReloadSignTimeout=getTop().setTimeout("getTop().reloadSignature( true );",5000);}else if(a){directChangeSkin();}}}function loadSignature(){try{if(getTop().goUserInfo._sStatus!='ready'){getTop().goUserInfo.reset();}}catch(a){return;}}function reloadSignature(a){getTop().goUserInfo.reset();}function getSignature(a,b){try{return getSignatureData().getRealUserSignature(a,b);}catch(c){loadSignature();return "";}}function getDetaultStationery(a){if(getTop().goUserInfo._sStatus=='ready'){return a=="Header"?getSignatureData().RealUserDefaultStationeryHeader:getSignatureData().RealUserDefaultStationeryBottom;}else{loadSignature();return "";}}function getDefaultEditor(){if(getTop().goUserInfo._sStatus=='ready'){return getSignatureData().RealDefaultEditor;}else{loadSignature();return undefined;}}function getUserNick(){if(getTop().goUserInfo._sStatus=='ready'){return getSignatureData().RealUserNick;}else{loadSignature();return 0;}}function getDefaultSaveSendbox(){if(getTop().goUserInfo._sStatus=='ready'){return getSignatureData().RealDefaultSaveSendbox;}else{loadSignature();return 0;}}function getUserAlias(){if(getTop().goUserInfo._sStatus=='ready'){return getSignatureData().RealUserAlias;}else{loadSignature();return "";}}function getDefalutAllMail(){if(getTop().goUserInfo._sStatus=='ready'){return getSignatureData().RealDefaultAllMail;}else{loadSignature();return [];}}function getOpenSpellCheck(){return true;}function getDefaultSender(){if(getTop().goUserInfo._sStatus=='ready'){return getSignatureData().RealDefaulSender;}else{loadSignature();return "";}}function setDefaultSender(a){var b=getTop().getGlobalVarValue("DEF_MAIL_FROM");var c=getTop().getGlobalVarValue("DOMAIN_MAIL_LOGO_URL");c&&c[b]&&(c[a]=c[b]);getTop().setGlobalVarValue("DEF_MAIL_FROM",a);}function getAllSignature(){if(getTop().goUserInfo._sStatus=='ready'){return getSignatureData().RealAllSignature;}else{loadSignature();return {};}}function getUserSignatureId(){if(getTop().goUserInfo._sStatus=='ready'){return getSignatureData().RealUserSignatureId;}else{loadSignature();return "";}}function getIsQQClub(){if(getTop().goUserInfo._sStatus=='ready'){return getSignatureData().RealIsQQClub;}else{loadSignature();return false;}}function getBindAccount(){if(getTop().goUserInfo._sStatus=='ready'){return getSignatureData().RealBindAccount;}else{loadSignature();return false;}}function getRecognizeNickName(){if(getTop().goUserInfo._sStatus=='ready'){return getSignatureData().RealRecognizeNickName;}else{loadSignature();return false;}}function closeRecognizeNickName(){ossLog("realtime","all","stat=tips&type=know&tipid=66");setGlobalVarValue("DEF_RECOGNIZENICKNAME",false);}function getUserInfoText(a){var b=S("user"+a,getTopWin())||{};return fixNonBreakSpace(b.innerText||b.textContent);}function getUserInfo(a){return (S("user"+a,getTopWin())||{}).innerHTML||"";}function setUserInfo(a,b){try{S("user"+a,getTopWin()).innerHTML=htmlEncode(b);return true;}catch(c){return false;}}function msgBox(e,f,a,b,d,c){if(window!=getTop()){return getTop().msgBox(e,f,a,b,d,c);}var h=e;if(!h){var g=S("msg_txt",c||window)||S("msg_txt",getActionWin());if(g&&(g.innerText||g.textContent)&&g.getAttribute("ok")!="true"){h=filteScript(g.innerHTML);g.setAttribute("ok","true");}}if(!h||!(h=trim(h.replace(/[\r\n]/ig,"")))){return;}hiddenMsg();if(f=="dialog"){alertBox({msg:h,title:d||"\u786E\u8BA4"});}else{setClass(arguments.callee.createMessageBox().firstChild,f=="success"?"msg":"errmsg").innerHTML=h;showMsg();if(a){getTop().gMsgBoxTimer=getTop().setInterval(getTop().hiddenMsg,b||5000);}getTop().gMsgDispTime=now();}};msgBox.createMessageBox=function(a){var c=S("msgBoxDIV",getTop());if(!c){var b=typeof a=="undefined"?(getTop().bnewwin?0:43):a;insertHTML(getTop().document.body,"afterBegin",T(['<div id="msgBoxDIV" style="position:absolute;width:100%;display:none;','padding-top:2px;height:24px;*height:24px;_height:20px;top:$top$px;text-align:center;">','<span></span>','</div>']).replace({top:b}));c=S("msgBoxDIV",getTop());}return c;};function isshowMsg(){return getTop().isShow("msgBoxDIV");}function hiddenMsg(){if(getTop().gMsgBoxTimer){getTop().clearInterval(getTop().gMsgBoxTimer);getTop().gMsgBoxTimer=null;}getTop().show("msgBoxDIV",false);getTop().showProcess(0);}function showMsg(){getTop().show("msgBoxDIV",true);}function showError(b,a){msgBox(b,"",a!=-1,a||5000);}function showInfo(b,a){msgBox(b,"success",a!=-1,a||5000);}function showProcess(c,b,d,e,a){var i="load_process",h=arguments.callee._create(i);if(c==0){return show(h,false);}hiddenMsg();show(h,true);var f=c==2;if(f){if(e){S(i+"_plan_info",getTop()).innerHTML=e+":";}var g=parseInt(d);if(isNaN(g)){g=0;}else{g=Math.max(0,Math.min(100,g));}S(i+"_plan_rate",getTop()).innerHTML=S(i+"_plan_bar",getTop()).style.width=[g,"%"].join("");}else{if(d){S(i+"_info",getTop()).innerHTML=d;}}show(S(i+"_plan",getTop()),f);show(S(i+"_img",getTop()),f?false:b);show(S(i+"_plan_info",getTop()),f);show(S(i+"_plan_rate",getTop()),f);show(S(i+"_info",getTop()),!f);show(S(i+"_cancel",getTop()),a!=false);}showProcess._create=function(a){var b=S(a,getTop());if(!b){insertHTML(getTop().document.body,"afterBegin",T(['<table id="$id$" cellspacing=0 cellpadding=0 border=0 ','style="position:absolute;top:$top$px;left:0;width:100%;display:none;z-index:9999;">','<tr><td align="center">','<table cellspacing=0 cellpadding=0 border=0 class="autosave autosave_txt" style="height:20px;"><tr>','<td style="width:2px;"></td>','<td id="$id$_img" style="padding:0 0 0 5px;">','<img src="$image_path$ico_loading.gif" style="width:16px;height:16px;vertical-align:middle;">','</td>','<td id="$id$_plan" valign=center style="padding:0 0 0 5px;">','<div style="font:1px;border:1px solid white;width:104px;text-align:left;">','<div id="$id$_plan_bar" style="font:1px;background:#fff;height:8px;margin:1px 0;width:50%;"></div>','</div>','</td>','<td id="$id$_plan_info" style="padding:0 0 0 5px;"></td>','<td id="$id$_plan_rate" style="width:40px;text-align:right;padding:0;"></td>','<td id="$id$_info" style="padding:0 0 0 5px;"></td>','<td id="$id$_cancel" style="padding:0 0 0 5px;">','[<a onclick="getTop().cancelDoSend();" nocheck="true" style="color:white;">\u53D6\u6D88</a>]','</td>','<td style="padding:0 0 0 5px;"></td>','<td style="width:2px;"></td>','</tr></table>','</td></tr>','</table>']).replace({id:a,top:getTop().bnewwin?0:45,image_path:getPath("image",true)}));b=S(a,getTop());}return b;};function getProcessInfo(){var d="load_process",c=getTop();if(isShow(S(d,c))){var a=S(d+"_plan_rate",c),b=S(d+"_info",c);if(b&&isShow(b)){return b.innerHTML;}if(a&&isShow(S(d+"_plan",c))){return parseInt(a.innerHTML);}}return "";}function replaceCss(b,a){replaceCssFile("skin",[getPath("style"),getFullResSuffix(["skin",typeof a=="undefined"?getPath("skin"):a,".css"].join(""))].join(""),(b||window).document);}function _getLogoSrc(b,a){var c=getTop();return !a&&c.gLogoUrl?c.gLogoUrl.replace(/(.*)_[^_]+_([^_]+)/,"$1_"+b+"_$2"):TE(['$images_path$logo','$@$if($bFoxmail$)$@$','_foxmail/logo_biz_$nSkinId$_','$@$else$@$','$sSubfolder$logo_biz/logo_biz_$nSkinId$_','$@$endif$@$','$@$if($bFoxmail$)$@$','0','$@$else$@$','$sLogoid$','$@$endif$@$.gif']).replace({images_path:getPath("image"),bFoxmail:a,sSubfolder:c.gsLogoFolder,nSkinId:b,sLogoid:(c.gsLogoFolder||b==0)?(c.gLogoId||0):0});}function doRealChangeStyle(d,c,b,e,a){var j=getTop(),g=j.gTempSkinId=c,i=getMainWin(),k=[j,i],f=a||false,h=S("imglogo",j);if(h){if(typeof e=="undefined"||e==""){if(c<10000000){h.src=_getLogoSrc(g,b);}}else{h.src=e;}h.className=f?"domainmaillogo":"";}E(j.goDialogList,function(l,m){k.push(F(m,getTop()));});E(GelTags("iframe",i.document),function(l){k.push(l.contentWindow);});E(k,function(l){replaceCss(l,g);});removeSelf(d);setTimeout(resizeFolderList);rdVer("BaseVer",1);}function changeStyle(a,b){var d=false,c=false;var g=getTop().getGlobalVarValue("DOMAIN_MAIL_LOGO_URL")||{},h=getGlobalVarValue("DEF_MAIL_FROM")||'';if(b){c=b.indexOf("/cgi-bin/viewfile")>=0;if(c){g[h]=b;h&&setGlobalVarValue("DOMAIN_MAIL_LOGO_URL",g);}}else if(h&&g[h]){b=g[h];c=b&&b.indexOf("/cgi-bin/viewfile")>=0;}var f=typeof a=="undefined"||a==""?getTop().skin_path:a,j=getTop().gsLogoFolder,m=d?0:(j||f==0?(getTop().gLogoId||0):0),i=d?"_foxmail":"",e=getTop().changeStyle,k=e._sProcessId,l=e._sProcessId=["skinCssCache",f,i,b||m].join("_");if(l!=k){cacheByIframe([["css",getPath("style"),"skin"+f+".css"],!!b?["img","",b]:["img",_getLogoSrc(f,d)]],{onload:function(){doRealChangeStyle(this,f,d,b,c);}});}}function osslogCompose(a,c,e,d,b){getTop().ossLog("delay","all",T(['stat=compose_send','&t=$time$&actionId=$actionId$&mailid=$mailid$','&isActivex=$isActivex$&failCode=$failCode$','&$other$']).replace({time:a,actionId:c,mailId:e,failCode:d,other:["&cgitm=",getTop().g_cgiTimeStamp||-1,"&clitm=",getTop().g_clientTimeStamp||-1,"&comtm=",b&&b.valueOf?b.valueOf():-1].join('')}));}function recodeComposeStatus(a,c,b,d){var e=0,f=getTop().gSendTimeStart;if(!f||!f.valueOf){if(!d){return;}}else{e=now()-f.valueOf();getTop().gSendTimeStart=null;}osslogCompose(e,a,c,b,f);getTop().isUseActiveXCompose=false;}function errorProcess(a){if(typeof getMainWin().ErrorCallBack=="function"){getMainWin().ErrorCallBack(a);}else if(typeof getTop().ErrorCallBack=="function"){getTop().ErrorCallBack(a);}}function doPostFinishCheck(c,b,a){if(c){var j="",d=false,h=S(c,b),i=F(c,b);try{if(!h||h.getAttribute("deleted")=="true"){return;}var e=i.document.body,d=!e.className&&!e.style.cssText;if(d){var f=i.document.documentElement;j=(f.textContent||f.innerText||"").substr(0,30);}}catch(g){debug("doPostFinishCheck exception");debug(g,2);d=g.message||"exception";}QMHistory.recordActionFrameChange();if(d){callBack.call(h,a,[j]);if(d!=true){removeSelf(h);createBlankIframe(b,{id:c,onload:h._onload});}errorProcess();}}}function actionFinishCheck(){doPostFinishCheck("actionFrame",getTop(),function(a){showError(gsMsgLinkErr);});}function doSendFinishCheck(){doPostFinishCheck("sendmailFrame",getTop(),function(a){recodeComposeStatus(2,null,a||0);msgBox(T(['\u7531\u4E8E\u7F51\u7EDC\u539F\u56E0\uFF0C\u90AE\u4EF6\u53D1\u9001\u5931\u8D25\uFF01','[<a href="/cgi-bin/switch2service?sid=$sid$&errcode=-1&time=$time$&cginame=sendmail&t=error_report">\u53D1\u9001\u9519\u8BEF\u62A5\u544A</a>]']).replace({time:formatDate(new Date(),"$YY$$MM$$DD$$hh$$mm$$ss$")}),"dialog",true,0,"\u5931\u8D25\u4FE1\u606F");});}function submitToActionFrm(a){try{a.submit();return true;}catch(b){showError(a.message);return false;}}function afterAutoSave(b,c,d,a){var l=0,u,w;try{var s=getTop().getMainWin();function f(){if(disableAll){disableAll(false);}}l=1;if(c==""||!c){return f();}l=2;if(!s||!S("fmailid",s)){return f();}l=3;w=S("fmailid",s).value;if(w!=c){S("fmailid",s).value=c;getTop().setTimeout(function(){reloadLeftWin();},0);}l=4;var r=b.split(" |"),q=[],m=s.QMAttach.getExistList();for(var x=0,h=m.length;x<h;x++){var t=S("Uploader"+m[x],s);if(t&&!t.disabled&&t.value!=""){q.push(t);}}l=5;var g=q.length;for(var x=0,h=r.length-1;x<h;x++){var e=false;for(var y=0;y<=x&&y<g;y++){if(!q[y].disabled&&q[y].value.indexOf(r[x])!=-1){q[y].disabled=true;e=true;try{if(gbIsIE||gbIsWebKit){q[y].parentNode.childNodes[1].innerText=r[x];}}catch(p){}}}if(!e){var v=r[x]+" |",k=b.indexOf(v);if(k!=-1){b=b.substr(0,k)+b.substr(k+v.length,b.length-k-v.length);}}}l=6;s.loadValue();l=7;if(b&&S("fattachlist",s)){S("fattachlist",s).value+=b;}l=8;l=9;showInfo(d||(formatDate(new Date(),"$hh$:$mm$")+" "+getTop().gsMsgSendErrorSaveOK));l=10;var o=getTop().QMDialog("composeExitAlert");l=10.1;var n=o&&o.S("btn_exit_notsave");l=10.2;if(n){l=10.3;if((n.isShow&&n.isShow())||n.disabled){l=10.4;return fireMouseEvent(n,"click");}}l=11;if(!a){f();}l=12;s.enableAutoSave();}catch(p){u=p.message;debug(["afterAutoSave:",p.message,"eid:",l]);}ossLog("realtime","all",T(["stat=custom&type=AFTER_AUTO_SAVE&info=","$processid$,$errmsg$,$oldmailid$,$mailid$,$attachlist$"]).replace({processid:l,errmsg:encodeURIComponent(u||"ok"),oldmailid:encodeURIComponent(w),mailid:encodeURIComponent(c),attachlist:encodeURIComponent(b)}));}function cancelDoSend(){var a=getMainWin(),b=a.QMAttach;if(b&&b.onfinish){b.onprogress=null;b.onfinish=null;}else{var c=S("sendmailFrame",getTop());if(c){c.setAttribute("deleted","true");removeSelf(c);}}recodeComposeStatus(3,null,0);showProcess(0);errorProcess();}function quickDoSend(a,c,b){var d=false;if(b!="nomsg"){showProcess(1,0,["<img src='",getPath("image"),"newicon/a_send.gif' width='14px' height='14px' align='absmiddle'>&nbsp;",(b||gsMsgSend)].join(""),null,true);}disableSendBtn(true);disableSource(true);createBlankIframe(getTop(),{id:"sendmailFrame",onload:function(e){if(d){doSendFinishCheck(this);}else{d=true;try{a.content.value=c;a.target="sendmailFrame";a.submit();}catch(f){showError("\u53D1\u9001\u5931\u8D25\uFF1A"+f.message);disableSendBtn(false);disableSource(false);}}}});}function disableSendBtn(a,b){disableCtl("sendbtn",a,b||getMainWin());}function disableSaveBtn(a,b){disableCtl("savebtn",a,b||getMainWin());}function disableTimeSendBtn(a,b){disableCtl("timeSendbtn",a,b||getMainWin());}function disableSource(a){disableCtl("source",a,getMainWin());}function disableAll(a,b){var e=b||getMainWin();if(e.disableAll&&e.disableAll!=arguments.callee){return e.disableAll(a);}disableSendBtn(a,b);disableSaveBtn(a,b);disableTimeSendBtn(a,b);var c=getTop().QMDialog("composeExitAlert"),d=c&&c.S("btn_exit_save");if(d){d.disabled=a;}}function verifyCode(a,b){if(window!=getTop()){return getTop().verifyCode(_asSubTmpl);}var d=arguments.callee,c=d._onok;setVerifyCallBack();loadingBox({model:"\u9A8C\u8BC1\u7801",js:[getTop().getPath("js")+getTop().getFullResSuffix("qmverify.js")],oncheck:function(){return window.QMVerifyBox;},onload:function(){QMVerifyBox.open({sType:a,sVerifyKey:b,onok:c});}});}function openComposeDlg(c,b,a){if(!(getTop().QMAddress&&QMAddress.isInit())){loadJsFile(getPath("js")+getFullResSuffix("qmaddress.js"),true,document,function(){QMAddress.initAddress();});}loadJsFileToTop(getPath("editor"),[getFullResSuffix("editor.js")]);loadingBox({model:"\u53D1\u4FE1",js:[getTop().getPath("js")+getTop().getFullResSuffix("libcompose.js"),getTop().getPath("js")+getTop().getFullResSuffix("qmaddrinput.js")],oncheck:function(){return window.ComposeLib&&window.QMAddrInput&&window.QMEditor&&(!a||a());},onload:function(){ComposeLib.openDlg(c,b);}});}function setVerifyCallBack(a){getTop().verifyCode._onok=a;}function emptyFolder(a){return confirm(a?"\u4F60\u786E\u8BA4\u8981\u6E05\u7A7A\u6B64\u6587\u4EF6\u5939\u5417\uFF1F\n\uFF08\u6E05\u7A7A\u540E\u90AE\u4EF6\u65E0\u6CD5\u6062\u590D\uFF09":"\u4F60\u786E\u8BA4\u8981\u5220\u9664\u6B64\u6587\u4EF6\u5939\u4E2D\u7684\u6240\u6709\u90AE\u4EF6\u5417\uFF1F\n\uFF08\u6E05\u7A7A\u540E\u90AE\u4EF6\u65E0\u6CD5\u6062\u590D\uFF09");}function renameFolder(c,d,a,b){promptFolder({defaultValue:b||'',type:"rename"+(d||'folder'),onreturn:function(f){var e=S("frm",a);if(d=='tag'){e.fun.value="renametag";e.tagname.value=f;e.tagid.value=c;}else{e.fun.value="rename";e.name.value=f;e.folderid.value=c;}submitToActionFrm(e);}});return false;}function promptFolder(a){var b={shortcutgroup:{title:'\u65B0\u5EFA\u8054\u7CFB\u4EBA\u5206\u7EC4',msg:'\u8BF7\u586B\u5199\u8054\u7CFB\u4EBA\u5206\u7EC4\u540D\u79F0',name:'\u8054\u7CFB\u4EBA\u5206\u7EC4',maxascii:32,description:"\u5199\u4FE1\u65F6\uFF0C\u53EA\u9700\u8981\u8F93\u5165\u8FD9\u4E2A\u7FA4\u7EC4\u540D(\u6C49\u5B57\u9700\u8F93\u5165\u62FC\u97F3)\uFF0C\u5C31\u53EF\u4EE5\u5FEB\u6377\u7FA4\u53D1\u4E86\u3002"},folder:{title:'\u65B0\u5EFA\u6587\u4EF6\u5939',msg:'\u8BF7\u60A8\u8F93\u5165\u6587\u4EF6\u5939\u540D\u79F0',name:'\u6587\u4EF6\u5939',height:200,maxascii:80},tag:{title:'\u65B0\u5EFA\u6807\u7B7E',msg:'\u8BF7\u60A8\u8F93\u5165\u6807\u7B7E\u540D\u79F0',name:'\u6807\u7B7E',maxascii:50},renamefolder:{title:'\u91CD\u547D\u540D\u6587\u4EF6\u5939',msg:'\u8BF7\u60A8\u8F93\u5165\u65B0\u7684\u6587\u4EF6\u5939\u540D\u79F0',name:'\u6587\u4EF6\u5939',maxascii:80},renametag:{title:'\u91CD\u547D\u540D\u6807\u7B7E',msg:'\u8BF7\u60A8\u8F93\u5165\u65B0\u7684\u6807\u7B7E\u540D\u79F0',name:'\u6807\u7B7E',maxascii:50}}[a.type];b.defaultValue=a.defaultValue;b.onreturn=function(c,d){if(!c){return;}var e=getAsiiStrLen(trim(d));if(e==0||e>b.maxascii){return showError(TE(e?"$name$\u540D\u79F0\u592A\u957F\uFF0C\u8BF7\u4F7F\u7528\u5C11\u4E8E$maxascii$\u4E2A\u5B57\u7B26($@$eval $maxascii$/2$@$\u4E2A\u6C49\u5B57)\u7684\u540D\u79F0":'$name$\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A').replace(b));}if(/[~!#\$%\^&\*\(\)=\+|\\\[\]\{\};\':\",\?\/<>]/.test(d)){return showError(b.name+'\u540D\u79F0\u4E0D\u80FD\u5305\u542B ~!#$%^&*()=+|\\[]{};\':",?/<> \u7B49\u5B57\u7B26');}a.onreturn(d);};promptBox(b);}function _setFolderCss(c,a,b,d){if(c){var h=S(c+"_td",a);if(h){setClass(h,b);return h;}else{var g=S(c,a);if(g){var e=d=="over";if(e){showFolders(g.name,true);}var f=S(c,a).parentNode;setClass(f,e?"fn_list":"");return g;}}}}function switchFolderComm(d,b,c,g,f,e,a){var h=S(c,b),k=d;if(k){a._sCurFolderId=k;}else{k=a._sCurFolderId;}if(h){var m="SwiTchFoLdErComM_gLoBaldATa",l=b[m],j;if(l!=k){_setFolderCss(l,b,e,"none");}if(j=_setFolderCss(b[m]=k,b,f,"over")){E("new|personal|pop|tag".split("|"),function(n){var o=S(n+"folders",b);o&&isObjContainTarget(o,j)&&showFolders(n,true);});if(getStyle(h,"overflow")!="hidden"){scrollIntoMidView(j,h);}else{var i=S("ScrollFolder",b);i&&isObjContainTarget(i,j)&&scrollIntoMidView(j,i);}}}}function switchFolder(b,a){getTop().switchFolderComm(b,a||getLeftWin(),"folder","li","fn","fs",getTop().switchFolder);}function switchRightFolder(b,c,a){getTop().switchFolderComm(b,c||F("rightFolderList",getMainWin()),a||"folder_new","div","toolbg","",getTop().switchRightFolder);}function isShowFolders(b,a){var c=S("icon_"+b,a||getTop());return !!(c&&c.className=="fd_off");}function showFolders(c,a,b){var j=b||getTop(),g=S(c+"folders",j),h=S("icon_"+c,j);if(g&&h){var d=!isShowFolders(c,j);if(typeof a!="boolean"||d==a){setClass(h,d?"fd_off":"fd_on");if(!b){var i=getTop(),k="fOlDErsaNimaTion"+c,f=i[k];if(!f){f=i[k]=new i.qmAnimation({from:1,to:100});}f.stop();if(d){g.style.height="1px";show(g,true);}else{g.style.height="auto";}var e=g.scrollHeight;f.play({speed:e,onaction:function(m,l){S(c+"folders",i).style.height=(Math.floor((d?l:1-l)*e)||1)+"px";},oncomplete:function(m,l){var n=S(c+"folders",i);if(d){n.style.height="auto";}else{show(n,false);}}});}else{show(g,d);}callBack(getTop().iPadResizeFolder);}}}function decreaseFolderUnread(c,a,b){var d,e=c.split(';');for(var f=e.length-1;f>=0;f--){if(d=_optFolderUnread(0,e[f])){_optFolderUnread(1,e[f],d-1,a,b);}}}function getFolderUnread(a){return _optFolderUnread(0,a);}function setFolderUnread(d,b,a,c){return _optFolderUnread(1,d,b||0,a,c);}function getGroupUnread(a){return _optFolderUnread(0,a,null,null,getMainWin());}function setGroupUnread(c,b,a){return _optFolderUnread(1,c,b||0,a,getMainWin());}function setTagUnread(d,b,a,c){return _optFolderUnread(1,d,b||0,a,c,true);}function _optFolderUnread(c,f,d,a,e,b){var m=S(["folder_",(new String(f)).toString().split("folder_").pop()].join(""),e||getLeftWin());if(!m){return 0;}else if(-1!=f.indexOf("tag")||-1!=f.indexOf("starred")||-1!=f.indexOf("bsm")){return 0;}var p=m.getAttribute("etitle"),k=GelTags("div",m),r=m.name;if(k.length){m=k[0];}var j=typeof (d)=="number"&&d>0?d:0,q=m.innerText||m.textContent||"",h=q.lastIndexOf("("),i=h==-1?0:parseInt(q.substring(h+1,q.lastIndexOf(")")));if(c==0){return i;}if(i==j){return 1;}var g=j==0,n={info:htmlEncode(h!=-1?q.substring(0,h):q),title:p,unread:j};m.title=T('$title$'+(a||g?'':'  \u672A\u8BFB\u90AE\u4EF6 $unread$ \u5C01')).replace(n);m=setHTML(m,T(g&&'$info$'||(a?'$info$($unread$)':'<b>$info$</b><b>($unread$)</b>')).replace(n)+(n.info=='\u661F\u6807\u90AE\u4EF6'?'<input type="button" class="ico_input icon_folderlist_star"/>':'')+(n.info=='\u6F02\u6D41\u74F6'?'<input class="ico_input drifticon" type="button" hidefocus />':''));m.setAttribute("initlized","");if(r&&!b){var o=S("folder_"+r,getTop());if(o){try{_optFolderUnread(c,f,j,a,getMainWin());}catch(l){doPageError(l.message,"all.js","_optFolderUnread");}return setFolderUnread(o.id,getFolderUnread(o.id)-i+j);}}return 1;}function doFolderEmpty(b,a,c){a.folderid.value=b;a.rk.value=Math.random();if(a.loc){a.loc.value=c;}submitToActionFrm(a);}function selectAll(a,b){var c=b||getTop().getMainWin().document;E(GelTags("input",S('list',c)),function(d){d.checked=a;});}function selectReadMail(a,b){E(GelTags("input",S('list',b)),function(c){if(c.title!="\u9009\u4E2D/\u53D6\u6D88\u9009\u4E2D"){c.checked=c.getAttribute('unread')!=a;}});}function checkAddrSelected(a){var e=a||getTop().getMainWin();var d=GelTags("input",S('list',e)),b=d.length,c;for(var f=0;f<b;f++){c=d[f];if(c.type=="checkbox"&&c.checked){return true;}}return false;}function checkBoxCount(a){var b=0;E(GelTags("INPUT"),function(c){if(c.type=="checkbox"&&c.name==a&&c.checked){b++;}});return b;}function PGV(){}function checkCheckBoxs(b,a){var d=a||S("frm",getMainWin()),f=GelTags("input",d),e;for(var g=0,c=f.length;g<c;g++){e=f[g];if(e.type=="checkbox"&&e.name==b&&e.checked){return true;}}return false;}function setListCheck(b,a){if(b.type!="checkbox"){return;}if(a==null){a=b.checked;}else{b.checked=a;}var c=b.parentNode.parentNode;if(c.tagName=="TR"){c=c.parentNode.parentNode;}if(c==S("frm",getMainWin())){return;}var d=c.className;if(d=="B"){d=a?"B":"";}else{d=strReplace(d," B","")+(a?" B":"");}setClass(c,d);if(a){listMouseOut.call(c);}}function doCheck(b,c,a,d){var g=b||window.event,l=c||g.srcElement||g.target,k=d||getMainWin();if(!l||!k){return;}if(l.className=="one"||l.className=="all"){CA(l);}setListCheck(l);if((g&&g.shiftKey||a)&&k.gCurSelObj&&k.gCurSelObj!=l&&l.checked==k.gCurSelObj.checked){var j=getTop().GelTags("input",k.document),e=0,f=j.length,h;for(var m=0;m<f;m++){h=j[m];if(h.type!="checkbox"){continue;}if((h==k.gCurSelObj||h==l)&&e++==1){break;}if(e==1){setListCheck(h,l.checked);}}}k.gCurSelObj=l;}function checkAll(b,a){var c=a||getTop().getMainWin().document;E(GelTags("input",c),function(d){if(d.name==b){setListCheck(d);}});}function fakeReadmail(a){QMAjax.send(T('/cgi-bin/readmail?sid=$sid$&mailid=$mailid$&t=readsubmail&mode=fake&base=$base$&pf=$pf$&xx=kk').replace({sid:getSid(),mailid:a.sMailId,pf:rdVer.isPre(a.sFolderId)?1:0,base:rdVer("BaseVer",0)}),{method:"GET",headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},onload:function(b,c){var f=trim2(c);if(b&&f.indexOf("(")==0){var e=evalValue(f);if(e){folderOpt(extend(a,e));callBack(getMainWin().updatePreAndNext,[a]);}}else{var d=getActionWin().document;d.open();d.write(_aoXml.responseText);}}});}function folderOpt(a){if(!a){return;}var d=getTop();d.recordCompareReadedMailId(a.sMailId);if(a.bNewMail){var g=a.sFolderId,b;if(g>0){try{d.setFolderUnread(g,d.getFolderUnread(g)-1);if(a.bStar){d.setFolderUnread("starred",d.getFolderUnread("starred")-1);}if(a.bBsm){d.setFolderUnread("bsm",d.getFolderUnread("bsm")-1);}var c=a.oMatchTag||[],j=c.length-1;j>=0&&setTagUnread('tag',getFolderUnread('tag')-1);for(;j>=0;j--){var f='tag_'+c[j];debug(['getFolderUnread',f,getFolderUnread(f)]);setTagUnread(f,getFolderUnread(f)-1);}}catch(h){}}}}function recordReadedMailId(a){getTop().gsReadedMailId=a;}function recordCompareReadedMailId(a){if(a&&getTop().gsReadedMailId!=a){getTop().gsReadedMailId=a;}QMMailCache.addData(a);}function SG(b,a){var g=b.className,c=!/\bsts\b/i.test(g);var e=GelTags("input",b.parentNode)[0],f=e&&e.className,d=(a?b.parentNode.parentNode.parentNode:b.parentNode).nextSibling;if(f=="one"||f=="all"){setClass(e,c?"one":"all");}setClass(b,c?g.replace(/\bhts\b/i,"sts"):g.replace(/\bsts\b/i,"hts"));if(d.className!="toarea"){d=d.nextSibling;}if(d.className!="toarea"){return;}return show(d,c);}function CA(a){if(a){var c=(a.className=="all"?a.parentNode.parentNode.parentNode.parentNode:a.parentNode).nextSibling;if(c.className!="toarea"){c=c.nextSibling;}if(c.className=="toarea"){var b=a.checked;E(GelTags("input",c),function(d){setListCheck(d,b);});}}}function RD(f,h,b,d,g,c,a,e,i){recordReadedMailId(h);if(f){preventDefault(f);var j=f.srcElement||f.target,l=j&&j.getAttribute("fid");if(l){goUrlMainFrm(T("/cgi-bin/$cgi$?sid=$sid$&folderid=$fid$&page=0&t=$t$").replace({cgi:l=="9"?"readtemplate":"mail_list",fid:l,sid:getSid(),t:l=="9"?"sms_list_v2":""}),false);return stopPropagation(f);}}var m=rdVer.url(h,g,i,d,getTop().bnewwin||(f&&f.shiftKey),c,a,e);rdVer.log(h,"hit");if(f&&(f.shiftKey||f.ctrlKey)){var k=f.target||f.srcElement;while(k&&k.className!="i M"&&k.className!="i F"){k=k.parentNode;}k&&QMReadedItem.disp(k);f.shiftKey&&goNewWin(m);f.ctrlKey&&window.open(m);}else{goUrlMainFrm([m,"#stattime=",now()].join(""),false);}}function checkPerDelML(c,a,b){return delMailML(c,a,"PerDel",b);}function delMailML(c,a,d,b){var f=b.nodeType==9?(b.defaultView||b.parentWindow):b,e=QMMailList.getCBInfo(f);configPreRmMail(e,'rmMail');rmMail(d=="PerDel"?1:0,e);if(d!="PerDel"){maillistCheckGrpSendSkipSelf(e);}return;}function maillistCheckGrpSendSkipSelf(a){if("1"==a.sFid&&1==a.oMail.length){var c=a.oMail[0];var b=c.oChk.getAttribute("fa"),d=c.oChk.getAttribute("sh");var e=d.split(',');checkGrpSendSkipSelf(b,e);}}function reportSpamML(b,a){var d=a.nodeType==9?(a.defaultView||a.parentWindow):a,c=QMMailList.getCBInfo(d);configPreRmMail(c,'spammail');(b?reportSpamJson:reportNoSpamJson)({bBlackList:true},c);return false;}var QMReadedItem={};QMReadedItem.addItem=function(a){if(!getMainWin().gMailItems){getMainWin().gMailItems=[];}getMainWin().gMailItems.push(a);};QMReadedItem.getItems=function(){return getMainWin().gMailItems||[];};QMReadedItem.save=function(a){getMainWin().goReadedItemImg=a;};QMReadedItem.load=function(){return getMainWin().goReadedItemImg;};QMReadedItem.disp=function(a){if(!a){return;}var c=a.type=="checkbox"?a.parentNode:GelTags("input",a)[0].parentNode,b=c.firstChild;if(b.tagName!="IMG"){insertHTML(c,"afterBegin",T(['<img src="$path$ico_grouplight.gif" class="showarrow"',' title="\u8FD9\u662F\u60A8\u6700\u8FD1\u9605\u8BFB\u7684\u4E00\u5C01\u90AE\u4EF6" />']).replace({path:getPath("image")}));b=c.firstChild;}show(this.load(),false);show(b,true);this.save(b);};QMReadedItem.read=function(a){if(a&&a.tagName==="U"){fireMouseEvent(a,"click");}else{if(!this.load()){return false;}fireMouseEvent(GelTags("table",this.load().parentNode.parentNode)[0].parentNode,"click");}return true;};QMReadedItem.check=function(a){if(!this.load()){return false;}var b=this.load().nextSibling;b.checked=!b.checked;doCheck(null,b,a);return true;};QMReadedItem.move=function(a){var d=this.getItems(),b=d.length,c=-1;if(b==0){return false;}if(this.load()!=null){var e=QMReadedItem.load().nextSibling;for(var f=b-1;f>=0;f--){if(e==d[f]){c=f;break;}}}c+=a?1:-1;if(c>-1&&c<b){this.disp(d[c]);scrollIntoMidView(d[c],getMainWin().document.body,false);return true;}return false;};function listMouseOver(a){var b=this;if(b.className.indexOf(" B")==-1&&getStyle(b,"backgroundColor")!="#f3f3f3"&&b.getAttribute("colorchange")!="none"){b.style.backgroundColor="#f3f3f3";}if(a){var c=getEventTarget(a);while(c&&c!=b&&c.className!='tagbgSpan'){c=c.parentNode;}if(c&&c!=b){QMTag.showTagClose(c,1);}}}function listMouseOut(a){var b=this;if((!a||!isObjContainTarget(b,a.relatedTarget||a.toElement))&&b.style.backgroundColor&&b.getAttribute("colorchange")!="none"){b.style.backgroundColor="";}if(a){var c=getEventTarget(a);while(c&&c!=b&&c.className!='tagbgSpan'){c=c.parentNode;}if(c&&c!=b){QMTag.showTagClose(c,0);}}}function listMouseEvent(a){addEvents(a,{contextmenu:function(b){listContextMenu.call(a,b);},mouseover:function(b){listMouseOver.call(a,b);},mouseout:function(b){listMouseOut.call(a,b);}});}function listContextMenu(a){var b=this;mailRightMenu(b,a);preventDefault(a);}function GetListMouseClick(a){return function(b){ListMouseClick(b,a||window);};}function ListMouseClick(_aoEvent,_aoWin){var _oTargetObj,_oEvent=_aoEvent||_aoWin.event;if(!(_oTargetObj=getEventTarget(_oEvent))){return;}if(_oTargetObj.name=="mailid"){if(!getGlobalVarValue('TIP_46')){requestShowTip('gotnomail',46,_aoWin,function(_asParam,_aoXmlObj){setGlobalVarValue('TIP_46',1);return true;});}return doCheck(_oEvent);}if(_oTargetObj.className.indexOf("cir")==0){var _sFuncCode=GelTags("table",_oTargetObj.parentNode.parentNode)[0].parentNode.onclick.toString().split("{")[1].split("}")[0].replace(/event/ig,"{shiftKey:true}");if(/\WRD/.test(_sFuncCode)){return eval(_sFuncCode);}else{_sFuncCode=GelTags("table",_oTargetObj.parentNode.parentNode)[0].parentNode.onclick.toString().replace(/.*{/g,"").replace(/}.*/g,"").replace(/event/ig,"{shiftKey:true}");return eval(_sFuncCode);}}}function listInitForComm(b,a){var g,e=GelTags("div"),c=doCheck,f,d;g=b?b:"M";for(var h=e.length-1;h>=0;h--){f=e[h];if(f.className!=g){continue;}if(b=="ft"){f=GelTags("table",f)[0];}d=GelTags("input",f)[0];if(!d||d.type!="checkbox"){continue;}d.title="\u6309\u4F4Fshift\u70B9\u51FB\u4E0D\u540C\u7684\u52FE\u9009\u6846 \u53EF\u65B9\u4FBF\u5FEB\u6377\u591A\u9009";addEvent(d,"click",c);if(!a){listMouseEvent(f);}}}function modifyFolder(a,b){getMainWin().location.href=T(['/cgi-bin/foldermgr?sid=$sid$&fun=detailpop&t=pop_detail','&folderid=$folderid$&acctid=$acctid$']).replace({sid:getSid(),folderid:a,acctid:b});return false;}function recvPopHidden(a){getMainWin().setTimeout(function(){if(!a){getTop().reloadFrmLeftMain(false,true);}else{var c="iframeRecvPopHidden";createBlankIframe(getMainWin(),{id:c});var d=["/cgi-bin/mail_list?sid=",getSid(),"&folderid=",a,"&t=recv_pop_hidden"].join("");try{F(c,getMainWin()).location.replace(d);}catch(b){S(c,getMainWin()).src=d;}}},10000);}function recvPop(c,b,a){recvPopCreat(c,b);if(S("tips",a)){S("tips",a).innerHTML=T(['<img src="$images_path$ico_loading3.gif" align=absmiddle>',' \u6B63\u5728\u6536\u53D6...&nbsp;\u7CFB\u7EDF\u5C06\u5728\u540E\u53F0\u81EA\u52A8\u6536\u53D6\uFF0C\u60A8\u53EF\u4EE5\u79BB\u5F00\u6B64\u9875\u9762\uFF0C\u7A0D\u540E\u56DE\u6765\u67E5\u770B\u6536\u53D6\u7ED3\u679C\u3002']).replace({images_path:getPath("image",true)});}recvPopHidden(b);}function recvPopCreat(a){getActionWin().location=["/cgi-bin/foldermgr?sid=",getSid(),"&fun=recvpop&acctid=",a].join("");}function recvPopAll(){getActionWin().location=["/cgi-bin/foldermgr?sid=",getSid(),"&fun=recvpopall"].join("");try{setTimeout(function(){reloadFrmLeftMain(false,true);},3000);}catch(a){}return false;}function setPopFlag(b,a,c){if(a=="recent"){setPopRecentFlag(b,c);}}function setPopRecentFlag(a,b){runUrlWithSid(["/cgi-bin/foldermgr?sid=",getSid(),"&fun=pop_setting&acctid=",a,"&recentflag=",b].join(""));}function checkPopMailShow(a){var b=["@yahoo.com.cn","@sina.com","@tom.com","@gmail.com"],c=a.toLowerCase();for(var d=0;d<b.length;d++){if(c.indexOf(b[d])>=0){return true;}}return false;}function setBeforeUnloadCheck(d,e,c,b,a){var f=["input","select","textarea"];d=d||window;a=a?(typeof (a)=="string"?S(a,d):a):d.document;d.gbIsBeforeUnloadCheck=true;E(f,function(g){var h=d[g+"_save"]=[];E(GelTags(g,a),function(j,i){h.push(j.value+j.checked);j.setAttribute("saveid",i);});});if(!d.onsetbeforeunloadcheck){d.onsetbeforeunloadcheck=function(){if(d.gbIsBeforeUnloadCheck){for(var n=0,g=f.length;n<g;n++){var m=f[n],k=m+"_save",h=GelTags(m,a);for(var o=0,p=h.length;o<p;o++){var l=h[o].getAttribute("saveid");if(l!=null&&h[o].getAttribute("nocheck")!="true"&&d[k][l]!=(h[o].value+h[o].checked)){return e?e:"\u60A8\u4FEE\u6539\u7684\u8BBE\u7F6E\u5C1A\u672A\u4FDD\u5B58\uFF0C\u786E\u5B9A\u8981\u79BB\u5F00\u5417\uFF1F";}}}}};gbIsIE?(d.document.body.onbeforeunload=d.onsetbeforeunloadcheck):d.document.body.setAttribute("onbeforeunload","return onsetbeforeunloadcheck();");}E(b||["cancel"],function(g){addEvent(typeof (g)=="string"?S(g,d):g,"mousedown",function(){d.gbIsBeforeUnloadCheck=false;});});E(GelTags("form",d.document),function(g){addEvent(g,"submit",function(){d.gbIsBeforeUnloadCheck=false;});if(!g._submit){g._submit=g.submit;g.submit=function(){d.gbIsBeforeUnloadCheck=false;this._submit();};}});}function popErrProcess(d,e,a,b,c,f){if(d!=null){msgBox(d,e,a,b);}if(f!=null){getMainWin().ShowPopErr(f,c);}showSubmitBtn();}function showSubmitBtn(){var a=S("submitbtn",getMainWin());if(a){a.disabled=false;}}function showPopSvr(){show(S("popsvrTR",getMainWin()),true);}function setTaskId(a){try{getMainWin().document.checkFrom.taskid.value=a;}catch(b){}}function showQuickReply(a){show(S('quickreply',getMainWin()),a);show(S('upreply',getMainWin()),!a);runUrlWithSid("/cgi-bin/getcomposedata?Fun=setshowquickreply&isShowQuickReply="+(a?0:1));}function hiddenReceipt(a){show(S("receiptDiv",a),false);}function switchOption(a){var b=[["<input type='button' class='qm_ico_quickup' title='\u9690\u85CF' />",true],["<input type='button' class='qm_ico_quickdown' title='\u663E\u793A\u66F4\u591A\u64CD\u4F5C' />",false]][S("trOption",a).style.display=="none"?0:1];S("aSwitchOption",a).innerHTML=b[0];show(S("trOption",a),b[1]);}function checkPerDel(a){delMail("PerDel",a);}function delMail(b,a){rmMail(b=="PerDel"?1:0,a.QMReadMail.getCBInfo(a));}function setMailType(d,b,a,c){var e=S("mail_frm",c);e.s.value=["readmail_",b?(a?"group":d):("not"+d),getMainWin().newwinflag?"_newwin":""].join("");e.action="/cgi-bin/mail_mgr?sid="+getSid();e.mailaction.value="mail_spam";e.isspam.value=b;e.reporttype.value=d=="cheat"?"1":"";submitToActionFrm(e);}function getAddrSub(b){var a=b.indexOf("@");if(a>-1){var d=b.substr(0,a);var c=b.substr(a);return subAsiiStr(d,18,'...')+subAsiiStr(c,18,'...');}else{debug("name+dom"+b);return subAsiiStr(b,36,'...');}}function getRefuseText(a){var b=T(['<input type="checkbox" name="$TNAME$" id="$TID$" $TCHECK$>\u5C06<label for="$TID$">$TVALUE$</label>\u52A0\u5165\u9ED1\u540D\u5355']);var e;var g="";var d="";for(e in a){var h="refuse";if(e>0){h="refuse"+e;d="<br>";}var c;if(a[e]!="\u53D1\u4EF6\u4EBA")c="&lt;"+getAddrSub(a[e])+"&gt;";else c=a[e];var f="";debug("ITEM: "+a[e]);g+=d+b.replace({TNAME:h,TID:h,TVALUE:c,TCHECK:f});}debug("RET Text"+g);return g;}function reportSpam(c,b,e,d,a){var n=e||(window==getTopWin()?getMainWin():window);if(!S("mail_frm",n)){var k=QMMailList.getCBInfo(n),j,i=0,h=k.oMail.length,l={};if(h==0){showError(gsMsgNoMail);return false;}for(var f=0;f<h;f++){j=k.oMail[f];if(j.bSys){}i+=j.bDft?1:0;if(j.sSEmail.indexOf("@groupmail.qq.com")!=-1){c=true;}else if(j.sSEmail.indexOf("10000@qq.com")!=-1){c=true;}if(typeof l.sender=="undefined"){l.sender=j.sSEmail;l.nickname=j.sSName;}else if(l.sender!=j.sSEmail){l.sender="";}}if(i==h){d=1;}else{for(f=0;f<h;f++){j=k.oMail[f];}k=QMMailList.getCBInfo(n);QMMailList.selectedUI(k);}}if(l)debug("Has nick and sender "+l.sender);else debug("No nick and sender");var q=new Array();q[0]="\u53D1\u4EF6\u4EBA";if(l&&l.sender&&l.sender.indexOf(',')<0){q[0]=l.sender;}var g=0;if(a){if(a[0].length>0)q[g++]=a[0];if(a[1])q[g++]=a[1];}var m=T(['<div>','<input type="radio" name="reporttype" id="r$value$" value="$value$" $checked$>','<label for="r$value$">$content$</label>','</div>']);var p=(d!==1?["<div style='padding:10px 10px 0 25px;text-align:left;'>","<form id='frm_spamtype'>","<div style='margin:3px 0 3px 3px'><b>\u8BF7\u9009\u62E9\u8981\u4E3E\u62A5\u7684\u5783\u573E\u7C7B\u578B\uFF1A</b></div>",m.replace({value:(b?11:8),checked:"checked",content:"\u5176\u4ED6\u90AE\u4EF6"}),m.replace({value:(b?10:4),checked:"",content:"\u5E7F\u544A\u90AE\u4EF6"}),m.replace({value:(b?9:1),checked:"",content:"\u6B3A\u8BC8\u90AE\u4EF6"}),"<div style=\"padding:5px 0 2px 0;\">",(c?"&nbsp;":getRefuseText(q)),"</div><div style='margin:10px 3px 0px 3px' class='addrtitle' >\u6E29\u99A8\u63D0\u793A\uFF1A\u6211\u4EEC\u5C06\u4F18\u5148\u91C7\u7EB3\u51C6\u786E\u5206\u7C7B\u7684\u4E3E\u62A5\u90AE\u4EF6\u3002</div>","</form>","</div><div style='padding:3px 15px 12px 10px;text-align:right;'>","</div>"]:["<div class='cnfx_content'>","<img style='float:left; margin:5px 10px 0;' src='",getPath("image"),"ico_question.gif' />","<div class='b_size' style='padding:10px 10px 0 0;margin-left:65px;line-height:1.5;height:80px;text-align:left;'>","<form id='frm_spamtype'>","<strong>\u60A8\u8981\u4E3E\u62A5\u8FD9\u4E2A\u6F02\u6D41\u74F6\u5417\uFF1F</strong><br>","<div style=\"display:none\">",m.replace({value:8,checked:"checked",content:""}),"</div>","\u4E3E\u62A5\u4EE5\u540E\uFF0C\u60A8\u5C06\u4E0D\u518D\u6536\u5230\u8FD9\u4E2A\u6F02\u6D41\u74F6\u7684\u56DE\u5E94\u3002","</form>","</div></div><div class='cnfx_btn'>","</div>"]).join(""),o=(['<a class="btn_blue" id="btn_ok" href="javascript:;">\u786E\u5B9A</a>','<a class="btn_gray" id="btn_cancel" href="javascript:;">\u53D6\u6D88</a>']).join("");new (getTop().QMDialog)({sId:"reportSpam",sTitle:d===1?"\u7838\u6389\u8FD9\u4E2A\u74F6\u5B50":"\u4E3E\u62A5\u5E76\u62D2\u6536\u9009\u4E2D\u90AE\u4EF6",sBodyHtml:p,sFootHtml:o,nWidth:450,nHeight:d===1?150:220,onload:function(){var r=this;addEvent(r.S("btn_ok"),"click",function(){var t=S("mail_frm",getMainWin())||S("frm",getMainWin());if(!t){return;}t.s.value="readmail_spam";t.isspam.value='true';t.mailaction.value="mail_spam";t.action='/cgi-bin/mail_mgr?sid='+getTop().getSid();var w=r.S("frm_spamtype").reporttype,u=r.S("frm_spamtype").refuse,v=r.S("frm_spamtype").refuse1;for(var y=0,s=w.length;y<s;y++){if(w[y].checked){t.reporttype.value=w[y].value;break;}}var x=new Array();x[0]="0";x[1]="0";if((u&&u.checked)||(v&&v.checked)){t.s.value="readmail_reject";}if(v){debug("Pro refuse OK* "+u.checked+" - "+v.checked);if(u&&u.checked){debug("what1? ---- ");x[0]="1";debug("SRe"+x[0]);}else{debug("what2? ");x[0]="0";}debug("sreject1 "+x[0]+x[1]);if(v.checked)x[1]="1";else x[1]="0";debug("sreject2 "+x[0]+x[1]);}else{x[0]="1";x[1]="1";}if(t.s_reject_what){t.s_reject_what.value=x[0]+x[1];debug("Reject method "+t.s_reject_what.value);}submitToActionFrm(t);r.close();});addEvent(r.S("btn_cancel"),"click",function(){r.close();});},onshow:function(){this.S("btn_cancel").focus();}});return false;}function setSpamMail(b,a,c){var d=c||(window==getTopWin()?getMainWin():window);if(b&&!a){return reportSpam(null,null,d);}setMailType("spam",b,a,d);}function setCheatMail(b,a){setMailType("cheat",b,a);}function doReject(b,a,d,c){var f="\u6B64\u90AE\u4EF6\u5730\u5740";if(c){f="<"+c+">";}var e=S("mail_frm",d);if(e.s_reject_what){e.s_reject_what.value="10";}if(confirm("\u7CFB\u7EDF\u4F1A\u628A"+f+"\u653E\u5165\u201C\u9ED1\u540D\u5355\u201D\u4E2D\uFF0C\u60A8\u5C06\u4E0D\u518D\u6536\u5230\u6765\u81EA\u6B64\u5730\u5740\u7684\u90AE\u4EF6\u3002\n\n\u786E\u5B9A\u8981\u62D2\u6536\u6B64\u53D1\u4EF6\u4EBA\u7684\u90AE\u4EF6\u5417\uFF1F")){setMailType("reject",b,a,d);}}function setFolderReaded(a,b,c){var e=b?getGroupUnread(b):getFolderUnread(a);if(e<1){return showError("\u6587\u4EF6\u5939\u5185\u6CA1\u6709\u672A\u8BFB\u90AE\u4EF6");}var g=getSid(),f=unikey("allread"),d=function(){QMAjax.send("/cgi-bin/mail_mgr?mailaction=read_all&t=unreadmail_reg_data&loc=setFolderUnread,,,32",{method:"POST",content:T('sid=$sid$&folderid=$folderid$&groupid=$groupid$').replace({sid:g,folderid:a,groupid:b}),onload:function(h,i){if(h&&i.indexOf("mark_allmail_ok")>-1){reloadFrmLeftMain(true,!!getMainWin()[f]);showInfo("\u6587\u4EF6\u5939\u6807\u4E3A\u5DF2\u8BFB\u64CD\u4F5C\u6210\u529F");}else{showError("\u6587\u4EF6\u5939\u6807\u4E3A\u5DF2\u8BFB\u64CD\u4F5C\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");}}});};getMainWin()[f]=1;if(a!=1){d();}else{confirmBox({title:"\u90AE\u4EF6\u6807\u8BB0\u63D0\u793A",msg:"\u60A8\u786E\u5B9A\u8981\u5C06\u8BE5\u6587\u4EF6\u5939\u4E2D\u7684\u672A\u8BFB\u90AE\u4EF6\u6807\u4E3A\u5DF2\u8BFB\uFF1F",onreturn:function(h,i){if(!h){return;}QMAjax.send("/cgi-bin/mail_mgr?mailaction=read_all&t=unreadmail_reg_data&loc=setFolderUnread,,,32",{method:"POST",content:T('sid=$sid$&folderid=$folderid$&groupid=$groupid$').replace({sid:g,folderid:a,groupid:b}),onload:function(j,k){if(j){reloadLeftWin();reloadFrm(getTop().getMainWin());getTop().showInfo("\u6587\u4EF6\u5939\u6807\u4E3A\u5DF2\u8BFB\u64CD\u4F5C\u6210\u529F");}}});}});}}function linkMaker(b){function a(c){var e=12,g=c||"",f=[],d=g.length/e;for(var h=0;h<d;h++){f[h]=g.substr(h*e,e);}return f.join("<wbr>");}return b.replace(/(https?:\/\/[\w.]+[^ \f\n\r\t\v\"\\\<\>\[\]\u2100-\uFFFF]*)|([a-zA-Z_0-9.-]+@[a-zA-Z_0-9.-]+\.\w+)/ig,function(e,c,d){if(d){return ['<a href="mailto:',d,'">',a(d),'</a>'].join("");}else{return ['<a href="',e,'">',a(e),'</a>'].join("");}});}function linkIdentify(a){if(!a||a.tagName=="A"||a.tagName=="SCRIPT"||a.tagName=="STYLE"||a.className=="qqmailbgattach"){return;}for(var c=a.firstChild,f;c;c=f){f=c.nextSibling;linkIdentify(c);}if(a.nodeType==3){var e=a.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;"),d=linkMaker(e);if(e!=d){var b=false;if(a.previousSibling){b=insertHTML(a.previousSibling,"afterEnd",d);}else{b=insertHTML(a.parentNode,"afterBegin",d);}if(b){removeSelf(a);}}}}function _isLinkNeedSwap(b){var d=b.href||"",a=b.ownerDocument,c=(a.parentWindow||a.defaultView).location;return (!b.onclick&&d&&d.indexOf("javascript:")!=0&&d.indexOf("#")!=0);}function swapLink(c,b,a){var e=c.ownerDocument?c:S(c,a);if(e){function d(f){if(_isLinkNeedSwap(f)){f.target="_blank";f.onclick=function(){return openExtLink.call(this,b);};}}linkIdentify(e);E(GelTags("a",e),d);E(GelTags("area",e),d);E(GelTags("form",e),function(f){f.onsubmit=function(){var g=a.location;if(g.getParams()["filterflag"]=="true"||this.action){this.target="_blank";return true;}showError(T(['\u51FA\u4E8E\u5B89\u5168\u8003\u8651\u8BE5\u64CD\u4F5C\u5DF2\u88AB\u5C4F\u853D [<a onclick="','setTimeout( function() {','goUrlMainFrm(\x27$url$&filterflag=true\x27);','showInfo(\x27\u53D6\u6D88\u5C4F\u853D\u6210\u529F\x27);','});','" style="color:white;" >\u53D6\u6D88\u5C4F\u853D</a>]']).replace({url:g.pathname+g.search}));return false;};});}}function preSwapLink(a,b){var c=getEventTarget(a);if(c&&{"A":1,"AREA":1}[c.tagName]&&_isLinkNeedSwap(c)){openExtLink.call(c,b)&&window.open(c.href);preventDefault(a);}}function swapImg(d,a,c,b){}function openSpam(a){a=a||window;if(true||confirm("\u6B64\u90AE\u4EF6\u7684\u56FE\u7247\u53EF\u80FD\u5305\u542B\u4E0D\u5B89\u5168\u4FE1\u606F\uFF0C\u662F\u5426\u67E5\u770B\uFF1F")){a.location.replace(appendToUrl(a.location.href,"&disptype=html&dispimg=1&clickshowimage=1"));}}function openHttpsMail(a){a.location.replace(appendToUrl(a.location.href,"&dispimg=1"));}function copyToClipboard(a){try{if(gbIsFF){netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");Components.classes["@mozilla.org/widget/clipboardhelper;1"].getService(Components.interfaces.nsIClipboardHelper).copyString(a);}else{var b=S("copyinputcontainer");if(!b){insertHTML(document.body,"beforeEnd",'<input id="copyinputcontainer" style="position:absolute;top:-1000px;left:-1000px;"/>');b=S("copyinputcontainer");}b.value=a;b.select();document.execCommand('Copy');}}catch(c){alert(T('\u60A8\u7684\u6D4F\u89C8\u5668\u5B89\u5168\u8BBE\u7F6E\u4E0D\u5141\u8BB8\u7F16\u8F91\u5668\u81EA\u52A8\u6267\u884C\u590D\u5236\u64CD\u4F5C\uFF0C\u8BF7\u4F7F\u7528\u952E\u76D8\u5FEB\u6377\u952E($cmd$+C)\u6765\u5B8C\u6210\u3002').replace({cmd:gbIsMac?"Command":"Ctrl"}));return false;}return true;}function openExtLink(a){var g=this;if(g.href.indexOf("mailto:")==0&&g.href.indexOf("@")!=-1){window.open(["/cgi-bin/readtemplate?sid=",getSid(),"&t=compose&s=cliwrite&newwin=true&email=",g.href.split("mailto:")[1]].join(""));return false;}else if(g.className=="qqmail_card_reply"||g.className=="qqmail_card_reply_btn"){var j=g.name,i=g.className,c=!!j,b=i.indexOf("birthcard")!=-1;getMainWin().location=T('/cgi-bin/cardlist?sid=$sid$&t=$t$&s=$s$&today_tips=$tips$&loc=readmail,readmail,sendnewcard,1&ListType=$listtype$&email=$email$$newwin$').replace({sid:getSid(),t:c?"compose_card":"card",s:b?"replybirthcard":"",tips:i.indexOf("btn")!=-1?"112":"111",listtype:c?"No":"Cards&Cate1Idx=listall",email:j,newwin:getTop().bnewwin?"&newwin=true":""});return false;}else if(g.className=="qqmail_postcard_reply_mobile"){var h=getMainWin().QMReadMail;if(h){getMainWin().location=T("/cgi-bin/readmail?sid=$sid$&mailid=$mailid$&t=compose&s=reply&disptype=html").replace({sid:getSid(),mailid:h.getMailId()});}return false;}else if(g.className=="qqmail_postcard_sendhelp_mobile"){window.open("http://service.exmail.qq.com/cgi-bin/help?subtype=1&&id=36&&no=1000696");return false;}else if(g.className=="qqmail_card_reply_thanksbtn"||g.className=="qqmail_card_reply_thanks"||g.className=="qqmail_birthcard_reply_thanksbtn"){var j=g.name;openComposeDlg("card",{sTitle:"\u7B54\u8C22\u597D\u53CB",sDefAddrs:j,bAddrEdit:true,sDefContent:"\u8C22\u8C22\u4F60\u7684\u8D3A\u5361\uFF01 \u4EE5\u540E\u8981\u5E38\u8054\u7CFB\u54E6\u3002",bContentEdit:true,sDefSubject:"\u8C22\u8C22\u4F60\u7684\u8D3A\u5361!",bRichEditor:false,nWidth:488,oncomplete:function(){},bShowResult:true});return false;}else if(g.className=="qqmail_postcard_reply"){goUrlMainFrm(T('/cgi-bin/readtemplate?sid=$sid$&t=compose_postcard&email=$email$').replace({sid:getSid(),email:g.name}),false);return false;}else if(g.className=="qqmail_postcard_reply2"){var l='',k='',h=getMainWin().QMReadMail;if(h){try{var f=(h.getSubMailWithDom?h.getSubMailWithDom(g):h.getMailInfo()).from;l=f&&f.name||'';k=f&&f.addr||'';}catch(m){}}goUrlMainFrm(T('/cgi-bin/readtemplate?sid=$sid$&t=compose_postcard&email=$email$&reply=1&frname=$name$&fraddr=$addr$').replace({name:escape(l),addr:escape(k),sid:getSid(),email:g.name}),false);return false;}else if(g.className=="qqmail_postcard_print"){var h=getMainWin().QMReadMail;if(h){window.open(T('/cgi-bin/readmail?sid=$sid$&t=print_haagendazs&s=print&filterflag=true&mailid=$mailid$').replace({sid:getSid(),mailid:h.getMailId()}));}return false;}else if(g.className=="qqmail_postcard_getmoreinfo"){var h=getMainWin().QMReadMail;if(h){window.open(T('/cgi-bin/today?t=haagendazs2010&sid=$sid$').replace({sid:getSid(),mailid:h.getMailId()}));}return false;}else if(g.hostname==getTop().location.hostname&&(g.pathname=="/cgi-bin/readtemplate"||g.pathname=="cgi-bin/readtemplate")&&g.search.indexOf("t=calendar")!=-1){var h=getMainWin().QMReadMail;if(h){goUrlMainFrm(g.href,true);}return false;}if(g.hostname!=getTop().location.hostname){if(g.href.indexOf("javascript:void(0)")>=0){return false;}if(a!="preview"&&getMainWin().location.href.indexOf('/cgi-bin/readmail?')<0){return true;}var d=g.parentNode;while(d){if(d.nodeType==1&&(d.id=="QQmailNormalAtt"||d.id=="attachment")){return true;}d=d.parentNode;}window.open(T('/cgi-bin/mail_spam?action=check_link&url=$url$&mailid=$mid$&spam=$spam$&r=$rand$').replace({mid:getMainWin().location.getParams()['mailid'],spam:a=="spam"?1:0,rand:Math.random(),url:escape(g.href)}),"_blank");return false;}return true;}function goPrevOrNextMail(a){var b,c=getMainWin();if(!!(b=S(["prevmail","nextmail"][a?1:0],c))&&!b.getAttribute("disabled")){}else if(!!(b=S(["prevpage","nextpage"][a?1:0],c))&&!b.getAttribute("disabled")){c.location=b.href;}}function goBackHistory(){var a=SN("readmailBack",getMainWin());if(a.length>0&&isShow(a[0])){fireMouseEvent(a[0],"click");return true;}return false;}function MLIUIEvent(a,b,c){var s=a.value,f=QMMailCache,d=f.isRefresh(b),j=a.parentNode;while(j.tagName.toUpperCase()!="TABLE"){j=j.parentNode;}var l=GelTags("table",j)[0],r=GelTags("td",GelTags("tr",l)[0]),k=r[1],h=r[r.length-1];a.setAttribute('init','true');QMReadedItem.addItem(a);if(h.className=="new_g"){h=r[6];}var n=GelTags("div",l),m;for(var e=n.length-1;e>=0;e--){if(n[e].className=="TagDiv"){m=n[e];break;}}if(f.hasData(s)){if(!d){var g=f.getData(s);if(a.getAttribute("unread")=="true"){f.addVar("unread",-1);}_setMailListFlag(a,j,false,g.reply);_hideGroupNewReply(a,j);if(g.star!=null){setClass(h,g.star?"fg fs1":"fg");f.addVar("star",g.star?1:-1);}if(g.oTagIds){var p=GelTags("table",l),o=g.oTagIds,t,i={};if(m){for(var e=p.length-1;e>=0;e--){if(t=p[e].getAttribute("tagid")){i[t]=1;}}for(var u in o){if(o[u]===0){QMTag.rmTagUI(m,u);}else if(!i[u]){QMTag.addTagUI(m,u,c,s,false);}}}}}else{f.delData(s);}}listMouseEvent(j);h.title=h.className=="fg"?"\u6807\u8BB0\u661F\u6807":"\u53D6\u6D88\u661F\u6807";addEvent(h,'click',function(v){starMail(null,QMMailList.getCBInfo(b,s));return stopPropagation(v);});addEvent(j,"click",GetListMouseClick(b));addEvent(j,"selectstart",preventDefault);var q=l.rows[0].cells[1];if(q.className.indexOf("fr")>-1){loadJsFile(getPath("js")+getFullResSuffix("qmtip.js"),true);addEvent(q,"mouseover",MLI._remarkTip);addEvent(q,"mouseout",MLI._remarkTip);}addEvent(m,'click',function(v){if(QMTag.readclose(v,QMMailList.getCBInfo(b,s))){return stopPropagation(v);}});dragML(j,a);}function MLI(b,a,c,d){var l=SN("mailid",a),m=l[l.length-1],q=m.value,n=m.parentNode,k=QMMailCache,g=k.isRefresh(a);while(n.tagName.toUpperCase()!="TABLE"){n=n.parentNode;}MLIUIEvent(m,a,c);var h=m.getAttribute("uw")=="1",o=h?a.oPreUWMails:a.oPreMails,i=o.length,j=g?2:1,e=new Date()-new Date(parseInt(m.getAttribute("totime")))<2592000000,f=e&&m.getAttribute("unread")=="true"&&m.getAttribute("preload")!="false"&&i<j&&!rdVer.log(q);if(f&&rdVer.isPre(c)){var r,p=m.getAttribute("gid");r=rdVer.url(q,c,d,"",false,"",false,"",true);if(r){o.push(r);}}if(getTop().gsReadedMailId==q){QMReadedItem.disp(n);recordReadedMailId(null);}}function MLJump(b,c,d,a){var h=SN("maillistjump",a.document),i="_MlJuMp_",f=parseInt(b)||0,g=parseInt(c)||0;function e(j){var l=getTop().QMMenu(j).S("txt"),k=parseInt(l.value);if(isNaN(k)){l.select();return showError("\u8BF7\u8F93\u5165\u8DF3\u8F6C\u7684\u9875\u6570");}k=Math.max(0,Math.min(k-1,g));if(f==k){l.select();return showError("\u4F60\u8F93\u5165\u4E86\u5F53\u524D\u9875\u6570");}getTop().QMMenu(j).close();goUrlMainFrm([d,'&page=',k,'&loc=mail_list,,jump,0'].join(''));}E(h,function(j){if(!j.getAttribute(i)){j.setAttribute(i,"1");addEvents(j,{click:function(k){var o=unikey("mljump"),n=calcPos(j),m=185,l=40;new (getTop().QMMenu)({sId:o,oEmbedWin:a,nWidth:m,nX:n[1]-m,nY:bodyScroll(a,"scrollHeight")-n[2]<l?(n[0]-l-13):n[2],bAutoClose:false,oItems:[{nHeight:l,sItemValue:MLJump._oTemplate.replace({id:o})}],onshow:function(){this.S("txt").focus();}});addEvent(getTop().QMMenu(o).S("txt"),"keypress",function(p){var q=p.keyCode||p.which;if(q===13){e(o);}else if((q<48||q>57)&&q!=8&&q!=9){preventDefault(p);}});addEvent(getTop().QMMenu(o).S("btn"),"click",function(p){e(o);});preventDefault(k);}});}});}MLJump._oTemplate=T(['<div style="position:absolute;">','<div class="addrtitle jumpmenusdjust" style="float:left;">\u8DF3\u8F6C\u5230\u7B2C <input id="txt" type="text" class="txt" style="width:30px;" /> \u9875</div>','<a id="btn" href="javascript:;" class="left button_gray_s" style="width:40px; margin:7px 0 0 5px; _display:inline;">&nbsp;\u786E\u5B9A&nbsp;</a>','</div>']);function initDropML(){function d(r){var t=calcPos(r),s=S('dragtitle'),p=s.offsetLeft,q=s.offsetTop;return (t[1]>p&&t[3]<p&&t[2]>q&&t[0]<q)?r:null;}function b(q,p){if(q&&q.id.indexOf('folder_')>=0){var s=q.className,r=s.indexOf('toolbg')>-1;if(p&&r){setClass(q,s.replace(/\btoolbg\b/g,''));}else if(!r&&!p){setClass(q,s+' toolbg');}}}var h=S('dragtitle'),k=S('OutFolder'),o='inidrop',f=BaseMailOper.getInstance(getMainWin()),a=QMDragDrop,n='mail_list';if(k.getAttribute(o)=='true'){return false;}k.getAttribute(o,'true');a.delGroup(n);var j=null,c=false,l=null,g=null,e=null,m=/^([489]|personal|pop|tag)$/,i=new a.DropTarget(S('OutFolder'),{ondragover:function(p){if(l==g){return;}var t=l&&l.id||'',r=g&&g.id||'',u=l&&l.getAttribute('dp'),s=g&&g.getAttribute('dp'),q=g&&g.getAttribute('dr');if(s){showFolders(s,true,getTop());}if(u&&u!=s){showFolders(u,false,getTop());}b(l,1);b(g);if(e){clearTimeout(e);}c=q&&!m.test(q);e=setTimeout(function(){setClass(h,c?'drag_over':'drag_out');e=null;},50);l=g;},ondrop:function(p){if(!g||!c){return;}var r=f.getMailInfo().sFid,s=g.getAttribute('dr')||'';ossLog("delay","all","stat=drag&opr="+s);if(s=='6'){b(l,1);l=null;f.apply('spammail');dragML._mbHasChecked=true;return;}else if(m.test(s)){b(l,1);l=null;return;}else if(s.indexOf('tag_')>=0){s=s.replace('tag','tid');}else if(s=='starred'){s='star';}else if((r==5||r==6)&&s==5){s='predelmail';dragML._mbHasChecked=true;}else if(parseInt(s)){s={5:'delmail'}[s]||'fid_'+s;}else{return;}f.apply(s);h.setAttribute('na','true');var q=new qmAnimation({from:100,to:1});q.play({speed:"slow",onaction:function(u,t){setOpacity(h,u/100.0);},oncomplete:function(u,t){show(h,0);setClass(h,'drag_out');setOpacity(h,100);b(l,1);l=null;}});}},function(p,q,r){if(gbIsIE){var x=getEventTarget(r.event),s=/(folder_\w+_td|(personal|pop|tag)foldersDiv)/;while(x&&!s.test(x.id)){x=x.parentNode;}g=x;}else if(g=d(S('OutFolder'))){var t=['personal','pop','tag'],u=null,v=null,w,y;for(y=t.length-1;y>=0;y--){if(u=d(S(t[y]+'foldersDiv'))){break;}}if(u=u||d(S('SysFolderList'))){w=GelTags('li',u);for(y=w.length-1;y>=0;y--){if(v=d(w[y])){break;}}}g=v||u;}return !!(l||g);});a.addGroup(n,i);}function dragML(b,a){if(!S('OutFolder')||!QMDragDrop){return;}var g=dragML,i='dragtitle',d=S(i);if(!d){insertHTML(getTop().document.body,'afterBegin','<div id="dragtitle" class="drag_out" style="display:none;"></div>');d=S(i);}var f,e=new QMDragDrop.Draggable(b,{threshold:5,oTitle:d},{ondragstart:function(k){g._mbHasChecked=a.checked==true;a.checked=true;var n=getMainWin(),l=BaseMailOper.getInstance(n),m=QMMailList.getCBInfo(n);QMMailList.selectedUI(m);l.setMailInfo(m);d.innerHTML=['\u9009\u4E2D ',m.oMail.length,' \u5C01\u90AE\u4EF6'].join('');ossLog("delay","all","stat=drag&c="+m.oMail.length);f=gbIsIE?[0,0,0,0]:calcPos(n.frameElement);d.style.left=f[3]+k.clientX+'px';d.style.top=f[0]+k.clientY+'px';d.setAttribute('na','');show(d,1);initDropML();},ondrag:function(k){d.style.left=f[3]+k.clientX+'px';d.style.top=f[0]+k.clientY+'px';},ondragend:function(k){if(!d.getAttribute('na')){show(d,0);setClass(d,'drag_out');}if(!g._mbHasChecked){a.checked=false;var l=QMMailList.getCBInfo(getMainWin());QMMailList.selectedUI(l);}}});QMDragDrop.addGroup('mail_list',e);var c=b.ownerDocument,h=c.parentWindow||c.defaultView,j=dragML._sMarkMainWin=dragML._sMarkMainWin||unikey('drag');if(!h[j]){addEvent(h,'unload',function(){if(d.releaseCapture){d.releaseCapture();}show(d,0);});h[j]=1;}}MLI._remarkTip=function(d){var f=getTop(),e=arguments.callee,a=d.clientX,b=d.clientY,c=getEventTarget(d);while(c&&c.tagName.toUpperCase()!="TD"){c=c.parentNode;}if(e._mnTimeout){clearTimeout(e._mnTimeout);e._mnTimeout=0;}if(d.type=="mouseout"){f.QMTip&&f.QMTip.showMailList(0,c.ownerDocument);return;}e._mnTimeout=setTimeout(function(){var i=f.GelTags("b",c.parentNode.cells[2]),h=i[i.length-1];if(!f.QMTip||!h||(e._nClientX==a&&e._nClientY==b)){return;}e._nClientX=a;e._nClientY=b;var g=h.innerHTML.replace(/^\&nbsp;-\&nbsp;/,"").replace(/\&nbsp;/gi,"&nbsp; ").replace(/&lt;br\/?&gt;/g,'<br/>');f.QMTip.showMailList(1,c.ownerDocument,g,a,b);},250);};function MLI_A(a){var d=GelTags("table",a),b=d.length,c=d[b-1],e=c.getAttribute("mailid");if(QMMailCache.hasData(e)){if(!QMMailCache.isRefresh(window)){setClass(c,"i M");}else{QMMailCache.delData(e);}}listMouseEvent(c);addEvent(c,"selectstart",preventDefault);}function _optMailListFlag(c,d,b,a){if(!(c&&c.type=="checkbox")){return false;}if(b==null){return c.getAttribute("unread")=="true";}if(!d){d=c.parentNode.parentNode.parentNode.parentNode;}if((c.getAttribute("unread")=="true")==!!b&&!a){return b;}var g=c.getAttribute("gid");if(g){setGroupUnread(g,getGroupUnread(g)-1);setGroupUnread("gall",getGroupUnread("gall")-1);}c.setAttribute("unread",b?"true":"false");setClass(d,[b?"i F":"i M",c.checked?" B":""].join(""));setClass(GelTags("table",d)[0],b?"i bold":"i");var e=GelTags("div",d)[1];if(!/(s[016789]bg)|(Rw)/.test(e.className)){var i=a?"r":c.getAttribute("rf"),h=c.getAttribute("isendtime"),f="Rr";if(h){f=h=="0"?"Rc":"Ti";}else if(b){f="Ru";}else if(i){f=i=="r"?"Rh":"Rz";}setClass(e,"cir "+f);}return b;}function _getMailListFlag(a){return _optMailListFlag(a);}function _setMailListFlag(c,d,b,a){return _optMailListFlag(c,d,b,a);}function _hideGroupNewReply(a,b){if(!a||!a.getAttribute("gid")){return false;}var c=GelTags("b",b)[0],d=c&&c.parentNode;if(d&&d.className=="new_g"){d.style.visibility="hidden";return true;}return false;}function getMailListInfo(){var a=getMainWin(),c=S("_ut_c",a),d=S("_ur_c",a),b=S("_ui_c",a);return {totle:(c&&parseInt(c.innerHTML))||0,unread:(d&&parseInt(d.innerHTML))||0,star:(b&&parseInt(b.innerHTML))||0};}function setMailListInfo(c,a,b){var f=getMainWin(),d=true,j=S("_ur",f),g=S("_ui",f),i=S("_ut",f),e;if(!isNaN(c=parseInt(c))){if(!!(e=S("_ur_c",f))){e.innerHTML=Math.max(0,c);show(j,c>0);}else{d=false;}var h=S("tip_unread",f);if(h){h.innerHTML=c<0?parseInt(h.innerHTML)+c:c;show(h,c);}}if(!isNaN(a=parseInt(a))){a=Math.max(0,a);if(!!(e=S("_ui_c",f))){e.innerHTML=a;show(g,a!=0);}else{d=false;}}if(!isNaN(b=parseInt(b))){a=Math.max(0,b);if(!!(e=S("_ut_c",f))){e.innerHTML=a;show(i,a!=0);}else{d=false;}}show(S("_uc",f),isShow(j));show(S("_ua",f),isShow(j));return d;}function readMailFinish(c,d,a,b){var m=getMainWin(),l=S("load_"+c,m),k,h;QMMailCache.addData(c);if(l){show(l,false);k=l.parentNode.previousSibling;h=GelTags("input",k)[0];}else{var j=GelTags("input",m.document);for(var o=0,g=j.length;o<g;o++){if(j[o].type=="checkbox"&&j[o].value==c){h=j[o];break;}}k=h;while(k.tagName.toUpperCase()!="TABLE"){k=k.parentNode;}}var n=GelTags("table",k),e=false;for(var f=n.length-1;f>=0;f--){if(n[f].getAttribute("tagid")){e=true;break;}}_hideGroupNewReply(h,k);if(h&&_getMailListFlag(h)){_setMailListFlag(h,k,false);setMailListInfo(getMailListInfo().unread-1);if(h.getAttribute('star')=='1'){setFolderUnread('starred',getFolderUnread('starred')-1);}if(a&&parseInt(a)>0&&!e){setFolderUnread(a,b?getGroupUnread("gall"):getMailListInfo().unread);}else{reloadLeftWin();}}}function checkMail(a){if(a==""){showError("\u6DFB\u52A0\u7684\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A");return false;}if(!a.match(/^[\.a-zA-Z0-9_=-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/)){showError("\u60A8\u8F93\u5165\u7684\u90AE\u7BB1\u5730\u5740\u4E0D\u6B63\u786E\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165");return false;}return true;}function checkAndSubmit(a){var b=S(a);if(!checkMail(trim(b.value))){b.focus();return false;}submitToActionFrm(b.form);}function pushToDialogList(a){var b=getTop();if(!b.goDialogList){b.goDialogList=new b.Object();}if(a){b.goDialogList[a]=true;}}function showDialogNewReadMail(b,c,a,d){new (getTop().QMDialog)({sId:"addnewremind_qqmail",sTitle:"\u65B0\u5EFA\u63D0\u9192",sUrl:T("/cgi-bin/read_reminder?linkid=%linkid%&linktitle=%linktitle%&sid=%sid%&t=remind_edit&from=%from%","%").replace({sid:getSid(),linkid:b,linktitle:c,from:a}),nWidth:450,nHeight:477});d&&rdVer(d,1);}function setRemindSpan(b,a){getTop().S('remind_edit_'+b,a).innerHTML=(getTop().reminddetail["mailid:"+b]||"").replace(/linktitle=.*&sid=/g,function(c){return c.replace(/\'/g,"&#039;");});}function showSimpleRuleFilter(_asAddr,_asClickFrom){if(!_asAddr){showError("\u65E0\u6CD5\u83B7\u53D6\u53D1\u4EF6\u4EBA\u5730\u5740\uFF0C\u4E0D\u80FD\u521B\u5EFA\u89C4\u5219");return;}var _oDialog=new (getTop().QMDialog)({sId:"addnewfilter_qqmail",sTitle:"\u5FEB\u6377\u521B\u5EFA\u6536\u4FE1\u89C4\u5219",sUrl:T("/cgi-bin/setting2?sid=$sid$&Fun=GetFolderList&CurFilterID=0&t=readmail_filter&fromaddr=$fromaddr$").replace({sid:getSid(),fromaddr:_asAddr}),nWidth:420,nHeight:240,onshow:function(){var _oDialogWin=this.getDialogWin();waitFor(function(){try{return S("jump",_oDialogWin);}catch(e){}},function(_abIsOk){if(_abIsOk){function _fInitFolderItem(_aoFolderList){if(_aoFolderList.length){_aoFolderList.push({bDisSelect:true,nHeight:10,sItemValue:'<hr/>'});}_aoFolderList.push({bDisSelect:false,nHeight:22,sId:"new",sItemValue:'\u65B0\u5EFA\u6587\u4EF6\u5939...'});return _aoFolderList;};function _fGetItemValue(){var _sIdx=_oQMSelect.get(2);return _sIdx=="new"?"-1":_sIdx;};function _fRestet(){_oQMSelect.set(_oUserFolder[0].sId,2);};function _fAddOption(_asName,_asValue){var _oNewItem={bDisSelect:false,nHeight:22,sId:_asValue,sItemValue:_asName};if(_oUserFolder.length==1){_oUserFolder=_fAddItem(_oUserFolder,{bDisSelect:true,nHeight:10,sItemValue:'<hr/>'},0);_oUserFolder=_fAddItem(_oUserFolder,_oNewItem,0);}else{_oUserFolder=_fAddItem(_oUserFolder,_oNewItem,_oUserFolder.length-2);}_oQMSelect.update({oMenu:{oItems:_oUserFolder}});_oQMSelect.set(_asValue,2);};function _fAddItem(_aoContainer,_aoItem,_anIndex){({}).toString.call([])!="[object Array]"&&(_aoItem=[_aoItem]);return _aoContainer.slice(0,_anIndex).concat(_aoItem).concat(_aoContainer.slice(_anIndex,_aoContainer.length));};function _fCreateFolder(){promptFolder({type:'folder',bAlignCenter:true,width:410,height:237,style:"createNewFolder",onreturn:function(_asName){QMAjax.send("/cgi-bin/foldermgr",{method:"POST",content:["sid=",getSid(),"&fun=new&from=simple&ef=js&resp_charset=UTF8&name=",_asName].join(''),onload:function(_abIsOk,_asResp){try{if(_abIsOk){var _oData=eval("("+_asResp+")");if(_oData.errcode=="0"){_fAddOption(_asName,_oData.folderid);reloadLeftWin();showInfo("\u5DF2\u6210\u529F\u65B0\u5EFA\u6587\u4EF6\u5939");}else{showError(_oData.errmsg);}return;}}catch(e){}showError("\u7F51\u7EDC\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\u3002");}});}});};var _oUserFolder=_fInitFolderItem(_oDialogWin.oUserFolder);_oQMSelect=new QMSelect({oContainer:S("selectfolder",_oDialogWin),oMenu:{nWidth:"auto",nMaxWidth:180,nMaxItemView:4,oItems:_oUserFolder},onselect:function(_aoItem){if(_aoItem.sId=="new"){_fCreateFolder();return true;}}});addEvent(S("jump",_oDialogWin),"click",function(){_oDialog.close();var _sFolderId=_fGetItemValue();_sFolderId=="-1"&&(_sFolderId="");getMainWin().location.replace(_oDialogWin.location.href.replace("&Fun=GetFolderList","&Fun=Create").replace("&t=readmail_filter","&loc=filter,simple,0,0&folderid="+_sFolderId));});addEvent(S("confirm",_oDialogWin),"click",function(){var _sFolderId=_fGetItemValue(),_nOldMail=S("oldmail",_oDialogWin).checked?1:0;if(_sFolderId=="-1"){showError("\u60A8\u9700\u8981\u521B\u5EFA\u4E00\u4E2A\u65B0\u6587\u4EF6\u5939");_fRestet();}else if(!_sFolderId){showError("\u8BF7\u9009\u62E9\u6587\u4EF6\u5939");_fRestet();}else{QMAjax.send("/cgi-bin/foldermgr",{method:"POST",content:["sid=",getSid(),"&fun=addfilter&from=simple&ef=js&action=move&oldmail=",_nOldMail,"&sender=",_asAddr,"&folderid=",_sFolderId].join(''),onload:function(_abIsOk,_asResp){try{if(_abIsOk){var _oData=eval("("+_asResp+")");if(_oData.errcode=="0"){if(_nOldMail&&_oData.affected>0){showInfo(TE(['\u64CD\u4F5C\u6210\u529F\uFF0C','$@$if($num$>0)$@$','\u79FB\u52A8\u4E86$num$\u5C01\u90AE\u4EF6\u3002','$@$else$@$','\uFF0C\u60A8\u6CA1\u6709\u9700\u8981\u79FB\u52A8\u6216\u6807\u8BB0\u7684\u90AE\u4EF6\u3002','$@$endif$@$','<a href="/cgi-bin/mail_list?sid=$sid$&folderid=$fid$&page=0"','style="color:white" onclick="getTop().hiddenMsg();" target="mainFrame">','[\u67E5\u770B]','</a>']).replace({sid:getSid(),fid:_oData.folderid,num:_oData.affected}),30000);if(_asClickFrom=="mail_list"){reloadFrm(getMainWin());}}else{showInfo("\u5DF2\u6210\u529F\u65B0\u5EFA\u89C4\u5219");}ossLog("realtime","all","loc=filter,simple,0,1");_oDialog.close();}else{showError(_oData.errmsg);}return;}}catch(e){}showError("\u7F51\u7EDC\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\u3002");}});}});addEvent(S("cancel",_oDialogWin),"click",function(){_oDialog.close();});}else{showError("\u7F51\u7EDC\u5F02\u5E38\uFF0C\u8BF7\u5237\u65B0\u540E\u91CD\u8BD5\u3002");}});}});}function submitSwitchForm(){var a=getTop().S("frmSwitch");a&&a.submit();}function beforeFrameHtmlUnload(){var b=["ftnupload_self","ftnupload_attach"];var a=QMDialog();for(var c in a){if(a[c].option("status")=="min"){setTimeout(function(){a[c].max();},10);return "\u60A8\u8FD8\u6709\u7A0B\u5E8F\u6B63\u5728\u8FD0\u884C\uFF0C\u786E\u5B9A\u5173\u95ED\uFF1F";}}}var base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var base64DecodeChars=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];function mybase64encode(g){var f,d,e;var a,b,c;e=g.length;d=0;f="";while(d<e){a=g.charCodeAt(d++)&0xff;if(d==e){f+=base64EncodeChars.charAt(a>>2);f+=base64EncodeChars.charAt((a&0x3)<<4);f+="==";break;}b=g.charCodeAt(d++);if(d==e){f+=base64EncodeChars.charAt(a>>2);f+=base64EncodeChars.charAt(((a&0x3)<<4)|((b&0xF0)>>4));f+=base64EncodeChars.charAt((b&0xF)<<2);f+="=";break;}c=g.charCodeAt(d++);f+=base64EncodeChars.charAt(a>>2);f+=base64EncodeChars.charAt(((a&0x3)<<4)|((b&0xF0)>>4));f+=base64EncodeChars.charAt(((b&0xF)<<2)|((c&0xC0)>>6));f+=base64EncodeChars.charAt(c&0x3F);}return f;}function showArchiveActive(){new QMDialog({sId:"archiveactive",sTitle:"\u8BF7\u5148\u6FC0\u6D3B",sBodyHtml:getTop().TE(['<div class="cnfx_content" style="line-height:1.6;">','<div style="border-bottom:1px solid #E4E4E4; margin:0 0 15px; padding:0 0 15px;">\u8BF7\u5148\u6309\u901A\u77E5\u90AE\u4EF6\u6307\u5F15\u6FC0\u6D3B\u5F52\u6863\u529F\u80FD<br/>\u66F4\u591A\u8BF4\u660E\u8BF7\u6D4F\u89C8<a href="http://service.exmail.qq.com/cgi-bin/help?subtype=1&&no=1000888&&id=23" target="_blank">\u5F52\u6863\u7CFB\u7EDF\u8BF4\u660E</a>\u3002</div>','</div>']).replace({}),sFootHtml:['<a id="ok" class="btn_blue" initlized="true" md="0" href="javascript:;" nocheck="true">\u786E\u8BA4</a>'].join(""),nHeight:'auto',nWidth:400,onload:function(){var a=this;a.S("ok").onclick=function(){a.close();};}});}function DoArchiveLogin(a){QMAjax.send("/cgi-bin/archive_frame?auth=1&sid="+getSid()+"&lkey="+mybase64encode(a.S("pw1").value),{method:"POST",content:["r=",Math.random(),""].join(""),onload:function(b,c){if(c.indexOf("archive_loginsucc")>=0){a.close();location.replace("/cgi-bin/archive_frame?nocheckframe=true&sid="+getSid());}else{alert("\u5BC6\u7801\u9519\uFF01\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01");a.S("pw1").focus();}}});}function showArchiveLogin(){new QMDialog({sId:"archivelogin",sTitle:"\u767B\u5F55\u5F52\u6863\u7CFB\u7EDF",sBodyHtml:getTop().TE(['<div class="cnfx_content" style="line-height:1.6;">','<div style="border-bottom:1px solid #E4E4E4; margin:0 0 15px; padding:0 0 15px;">\u8BF7\u8F93\u5165\u5BC6\u7801\u767B\u5F55\u5F52\u6863\u7BA1\u7406\u7CFB\u7EDF<br/>\u66F4\u591A\u8BF4\u660E\u8BF7\u6D4F\u89C8<a href="http://service.exmail.qq.com/cgi-bin/help?subtype=1&&no=1000888&&id=23" target="_blank">\u5F52\u6863\u7CFB\u7EDF\u8BF4\u660E</a>\u3002</div>','<div style="margin-top:12px;"><label>\u8F93\u5165\u5BC6\u7801: <input class="dialog_input" type="password" id="pw1" value="" style="width:220px;margin:0;"/></label></div>','</div>']).replace({}),sFootHtml:['<a id="ok" class="btn_blue" initlized="true" md="0" href="javascript:;" nocheck="true">\u786E\u8BA4</a>','<a id="cancel" md="0" nocheck="true" initlized="true" class="btn_gray" href="javascript:;">\u53D6\u6D88</a>'].join(""),nHeight:'auto',nWidth:400,onclose:function(){},onshow:function(){this.S("pw1").focus();},onload:function(){var a=this;a.S("cancel").onclick=function(){a.close();};a.S("ok").onclick=function(){DoArchiveLogin(a);};a.S("pw1").onkeydown=function(b){if(b.keyCode==13){DoArchiveLogin(a);}};}});}function showAdvanceSearchMenu(){var c=[{sId:"0",sItemValue:"<div class=\"ss_drop_item\"><a href=\"javascript:;\"><span class=\"ss_icon ss_icon_mail\"></span>\u67E5\u770B\u6240\u6709\u90AE\u4EF6</a></div>"},{sId:"4",sItemValue:"<div class=\"ss_drop_item\"><a href=\"javascript:;\"><span class=\"ss_icon ss_icon_note\"></span>\u67E5\u770B\u6240\u6709\u8BB0\u4E8B</a></div>"},{sId:"2",sItemValue:"<div class=\"ss_drop_item ss_drop_split\"><a href=\"javascript:;\">\u9AD8\u7EA7\u641C\u7D22...</a></div>"}],a=document.body.clientWidth-284,b=62;new (getTop().QMMenu)({oEmbedWin:window,nX:a,nY:b,nWidth:281,oItems:c,sClassName:"ss_drop_wrap",onitemclick:function(d){var e={sid:getTop().getSid()};if(d=="1"){changeStatus(1);var f=T("/cgi-bin/mail_list?topmails=0&sid=$sid$&s=search&folderid=all&page=0&subject=&sender=&receiver=&searchmode=attach&advancesearch=0").replace(e);getTop().getMainWin().location.href=f;}else if(d=="0"){changeStatus(1);var f=T("/cgi-bin/mail_list?topmails=0&sid=$sid$&s=search&folderid=all&page=0&subject=&sender=&receiver=&searchmode=&advancesearch=0").replace(e);getTop().getMainWin().location.href=f;}else if(d=="3"){changeStatus(1);var f=T("/cgi-bin/mail_list?sid=$sid$&folderid=8&page=0&t=mail_list_group").replace(e);getTop().getMainWin().location.href=f;}else if(d=="4"){changeStatus(1);var f=T("/cgi-bin/note_list?catid=0&sid=$sid$").replace(e);getTop().getMainWin().location.href=f;}else{showAdvanceSearchDialog("all");}}});}function attachSetFlag(_avParam,_abIsSetStarred,_afCallback){_avParam="&mailattach="+(typeof _avParam=="string"?_avParam.split(","):_avParam).join("&mailattach=");var _sUrl=[_avParam,"&action=",_abIsSetStarred?"setflag":"cancelflag"].join(""),_sValidTxt=_abIsSetStarred?"\u6536\u85CF":"\u53D6\u6D88\u6536\u85CF";QMAjax.send("/cgi-bin/attachfolder?t=attachfolder.json",{method:"POST",content:["r=",Math.random(),_sUrl].join(""),onload:function(_abIsOk,_avParam){if(_abIsOk){try{var _oData=eval(_avParam);getTop().showInfo("\u9644\u4EF6\u5DF2"+_sValidTxt);_afCallback&&_afCallback.call(null,_oData);}catch(e){}}else{getTop().showError(_sValidTxt+"\u5931\u8D25");}}});};function showAdvanceSearchDialog(a){var c={sid:getTop().getSid(),keyword:(a!="all")?encodeURI(trim(S("subject").value)):""},d=T('/cgi-bin/folderlist?sid=$sid$&t=searchoption&advancesearch=2&loc=frame_html,,9&advkeyword=$keyword$').replace(c),b=new QMDialog({sId:"advsearch",sTitle:"\u90AE\u4EF6\u9AD8\u7EA7\u641C\u7D22",sUrl:d,nWidth:461,nHeight:378});}function getAttachList(_avParam,_afCallback,_aoOption){_aoOption=_aoOption||{};var _fSelf=arguments.callee,_oArgs=arguments,_oList=(typeof _avParam=="object"&&_avParam.length)?_avParam:[],_ATT_LIST_URL=T("/cgi-bin/readmail?sid=$sid$&t=$t$&s=forward&from=attachfolder&disptype=html&ef=js$param$"),_sParam=TE(['$@$for($oAttach$)$@$','&mailattach=$mailid$|$attachid$|$attachname$|$fileextenal$|$filebyte$','$@$if($editname$)$@$','|$editname$','$@$endif$@$','$@$endfor$@$']).replace({oAttach:_oList});QMAjax.send(_ATT_LIST_URL.replace({sid:getSid(),t:"compose.json",param:_sParam}),{method:"GET",onload:function(_abIsOk,_avData){var _bFlag=true;if(_abIsOk){try{var _oData=eval(_avData),_oAttachs=_oData.attach;if(_oAttachs&&_oAttachs.length){for(var i=0;i<_oAttachs.length;i++){if(+_oAttachs[i]["byte"]==0){_bFlag=false;break;}}}else{_bFlag=false;}}catch(e){_bFlag=false;}}if(_bFlag&&_abIsOk){_afCallback(true,_oData);}else{_afCallback(false,_oData);}}},_aoOption.ajax);};function mailRecall(_anType,_aoParam,_aoCallbacks){var _oCallbacks=_aoCallbacks||{},_oPostData=extend({r:Math.random(),sid:getSid()},_aoParam);if(_oCallbacks.onbeforesend&&_oCallbacks.onbeforesend()===false){return;}QMAjax.send("/cgi-bin/send_status",{method:"POST",content:!_anType?T('t=send_status.json&s=mailrecallv2&messageid=$msgid$&time=$time$&sid=$sid$&r=$r$&ef=js').replace(_oPostData):T('t=send_status.json&s=mailrecall_queryv2&taskid=$taskid$&messageid=$msgid$&sid=$sid$&r=$r$&ef=js').replace(_oPostData),onload:function(_abIsOk,_avParam){if(_abIsOk){try{var _oData=eval(["(",_avParam,")"].join(""));if(+_oData.errcode>-1){_oCallbacks.onsuccess&&_oCallbacks.onsuccess(_oData);return;}else{showError(_oData.errmsg||(_anType==1?"\u67E5\u8BE2\u90AE\u4EF6\u64A4\u56DE\u72B6\u6001\u5931\u8D25\uFF0C\u64A4\u56DE\u7ED3\u679C\u5C06\u7A0D\u540E\u901A\u77E5\u4F60":"\u64CD\u4F5C\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5"));}}catch(e){showError(_oData.errmsg||(_anType==1?"\u67E5\u8BE2\u90AE\u4EF6\u64A4\u56DE\u72B6\u6001\u5931\u8D25\uFF0C\u64A4\u56DE\u7ED3\u679C\u5C06\u7A0D\u540E\u901A\u77E5\u4F60":"\u64CD\u4F5C\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5"));}_oCallbacks.onerror&&_oCallbacks.onerror(_avParam);}else{_avParam!="abort"&&showError(_oData.errmsg||(_anType==1?"\u67E5\u8BE2\u90AE\u4EF6\u64A4\u56DE\u72B6\u6001\u5931\u8D25\uFF0C\u64A4\u56DE\u7ED3\u679C\u5C06\u7A0D\u540E\u901A\u77E5\u4F60":"\u64CD\u4F5C\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5"));_oCallbacks.onerror&&_oCallbacks.onerror(_avParam);}_oCallbacks.oncomplete&&_oCallbacks.oncomplete(_abIsOk,_avParam);}});};function backHome(a){getMainWin().location.href=T('/cgi-bin/today?sid=$sid$&loc=backhome,,,$locid$').replace({sid:getSid(),locid:a||140});}function resizeFolderList(){var h=S("SysFolderList"),g=S("ScrollFolder"),e=S("folder");if(h&&g&&e){var f=["auto","hidden"],b=e.clientHeight,d=h.offsetHeight,a=b-d,c=a<50?0:1;e.style.overflow=f[c];e.style.overflowX=f[1];g.style.overflow=f[1-c];g.style.height=c?(b-d)+"px":"auto";}}function setTopSender(a){var b=getGlobalVarValue("DEF_MAIL_FROM")||'';switch(a&&a.action){case "setting4":if(b!=a.email){setUserInfo("addr",a.email);setDefaultSender(a.email);changeStyle(a.skin,a.logo);getTop().skin_path=a.skin;clearCache(["css",getPath("style"),"skin"]);}reloadSignature();break;}}function directChangeSkin(){if(window!=getTop()){return getTop().directChangeSkin();}function _errorHandle(_oXmlObj,_sMode){if(_sMode!="abort"){showError("\u5207\u6362\u5E10\u53F7\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\u3002");}};var _oUserAddrObj=S("useraddr"),_oUserAddrArrowObj=S("useraddrArrow");if(!_oUserAddrObj){return null;}setUserInfo("addr",getDefaultSender());var _nWidth=195,_oAllMail=getDefalutAllMail(),_nAllMailLen=0,_oTypeMails=[[],[],[]];for(var _i=0,_nLen=_oAllMail.length;_i<_nLen;_i++){var _nType=_oAllMail[_i].type;if((_nType>=0||_nType<3)&&_oAllMail[_i].email){_oTypeMails[_nType].push(_i);_nAllMailLen++;}}var _oItemTmpl=T(['<div style="width:18px;height:16px;float:left;padding-top:3px;">','<img id="img_$id$" src="$images_path$ico_ft_upload_success.gif" width="16px" height="16px" style="display:$display$"/>','</div>','<div title="$email$">$email$</div>']),_oItems=[{sItemValue:['<div style="padding:0 5px;">','<span style="float:right;">','<a id="userIdMgr" href="javascript:;">\u7BA1\u7406\u5E10\u6237</a>','</span>','<span>\u9009\u62E9\u9ED8\u8BA4\u53D1\u4FE1\u5E10\u53F7</span>','</div>'].join("")}],_nCurrentId=0;for(var j=0;j<3;j++){var _oTypeMail=_oTypeMails[j],_nLen=_oTypeMail.length;if(j&&_nLen){_oItems.push({nHeight:10,sItemValue:'<hr/>'});}for(var i=0,_nLen=_oTypeMail.length;i<_nLen;i++){var _oMail=_oAllMail[_oTypeMail[i]];if(_oMail.email==getDefaultSender()){_nCurrentId=_oTypeMail[i];}_oItems.push({sId:_oTypeMail[i],sItemValue:_oItemTmpl.replace({images_path:getPath("image"),display:"none",email:limitString(_oMail.email,38),id:_oTypeMail[i]})});var _nEmailDispLen=getStrDispLen(_oMail.email)+72;if(_nWidth<_nEmailDispLen){_nWidth=_nEmailDispLen;}}}var _oAjaxObj=new QMAjax(),_fDoItemClick=function(_asId){if(getUserInfoText("addr")==_oAllMail[_asId].email){showInfo('\u9ED8\u8BA4\u53D1\u4FE1\u5E10\u53F7\u5DF2\u5207\u6362');return;}_oAjaxObj.abort();_oAjaxObj.method="GET";_oAjaxObj.url=T('/cgi-bin/setting4?sid=$sid$&nosetnick=1&Fun=submit&showdefaultemailfrom=$email$&t=setting4_userinfo&r=$r$').replace({sid:getSid(),email:encodeURI(_oAllMail[_asId].email),r:Math.random()});_oAjaxObj.onComplete=function(_aoXmlObj){try{eval(_aoXmlObj.responseText);}catch(_oError){_errorHandle();return;}if(!setting4_userinfo||!setting4_userinfo.email||setting4_userinfo.skin<0){_errorHandle();return;}showInfo('\u9ED8\u8BA4\u53D1\u4FE1\u5E10\u53F7\u5DF2\u5207\u6362');var _nSkinId=setting4_userinfo.skin,_sEmail=setting4_userinfo.email,_sLogoUrl=setting4_userinfo.logo,_sHref=getMainWin().location.href;setUserInfo("addr",_sEmail);setDefaultSender(_sEmail);changeStyle(_nSkinId,_sLogoUrl);clearCache(["css",getPath("style"),"skin"]);getTop().goUserInfo.reset();if(_sHref.indexOf("/cgi-bin/setting4")>=0||_sHref.indexOf("/cgi-bin/setting5")>=0){setTimeout(function(){reloadFrm(getMainWin());},500);}else if(_sHref.indexOf("/cgi-bin/today")>=0&&!getUserInfoText("alias")){var _oAlias=S("today_alias",getMainWin());_oAlias&&(_oAlias.innerHTML=_sEmail);}else if(_sHref.indexOf("cgi-bin/readmail")<0&&_sHref.indexOf("cgi-bin/mail_list")<0){var _oTmpComposeGlobal=getMainWin().goCompose;_oTmpComposeGlobal&&_oTmpComposeGlobal.oQmSender&&_oTmpComposeGlobal.oQmSender.setSenderSelected(_sEmail);}_nCurrentId=_asId;var _oSendMailNameInput=S("sendmailname",getMainWin());_oSendMailNameInput&&(_oSendMailNameInput.value=_sEmail);};_oAjaxObj.onError=_errorHandle;_oAjaxObj.send();};if(_nAllMailLen>1){_oUserAddrArrowObj.style.visibility="visible";_oUserAddrArrowObj.parentNode.onclick=function(){var _oPosInfo=calcPos(_oUserAddrObj.parentNode),_oMenu=new (getTop().QMMenu)({sId:"changeskinmenu",oEmbedWin:getTop(),nX:_oPosInfo[3],nY:_oPosInfo[2],nWidth:_nWidth,nItemHeight:21,oItems:_oItems,onitemclick:_fDoItemClick,onload:function(){var _oSelf=this;this.S("userIdMgr").onclick=function(){goUrlMainFrm(T("/cgi-bin/setting4?fun=list&acc=1&sid=$sid$").replace({sid:getSid()}));_oSelf.close();};}});show(_oMenu.S("img_"+_nCurrentId),1);};}};function getPhotoCGI(){return [location.protocol,"//",location.host,"/cgi-bin/upload?sid=",getTop().getSid()].join("");}function getCookieMutiName(){var a=arguments.callee;return (a._oCookieMutiName||(a._oCookieMutiName={"sid":1,"username":1,"foxacc":1,"reloadurl":1,"reloadurl":1,"m3gmsid":1,"mcookie":1,"msid":1,"defaultf":1,"qm_flag":1,"QFRIENDUNREADCNT":1,"RSSUNREADCNT":1,"rss_domain":1,"qqmail_activated":1,"qqmail_alias_default":1,"qqmail_from":1,"wimrefreshrun":1,"new":1,"qm_sk":1,"qm_ssum":1,"qq2self_sid":1,"exstype":1,"lockurl":1,"new_mail_num":1}));}function setUserCookie(d,f,b,e,c,a){if(getCookieMutiName()[d]==1){var j=getCookie(d),h=j?j.split("|"):[],k=getUin(),l=k+"&"+f,g=true;for(var m=0;m<h.length;m++){if(h[m].match(k)){h[m]=l;g=false;}}j=h.join("|");g&&(j+=(j==""?"":"|")+l);return setCookie(d,j,b,e,c,a);}else return setCookie(d,f,b,e,c,a);}function getUserCookie(a){var c=getCookie(a);if(getCookieMutiName()[a]!=1){return c;}else{var b=c?c.split("|"):[],d=getUin();for(var e=0;e<b.length;e++){if(b[e].match(d)){return ((b[e].split("&"))[1]||b[e]);}}return c;}}function deleteUserCookie(b,c,a){deleteCookie(b,c,a);}function setUserCookieFlag(d,b,a,c){return setCookieFlag(d,b,a,c);}function getUserCookieFlag(a){return getCookieFlag(a);}function getReaderData(a){if(window!=getTop()){getTop().getReaderData(a);}else{var b=arguments.callee;removeSelf(b.jsObj);b.jsObj=loadJsFile(a+"&r="+Math.random(),false,document);}}function getReaderDataInterval(b,a){if(window!=getTop()){return getTop().getReaderDataInterval(b,a);}else{var d=arguments.callee,e=(window.gsRssDomain||'')+"/cgi-bin/reader_data2?sid="+getSid()+"&t=rss_data.js";if(d.nTimer){clearInterval(d.nTimer);}function c(){getReaderData(e);}d.nTimer=setInterval(c,a||(window.gnRssInterval*1000)||(10*60*1000));c();}}var QMFullTextSearch={};(function(){if(window==getTop()){QMFullTextSearch._TIP_FULL_TEXT="\u90AE\u4EF6\u5168\u6587\u641C\u7D22...",QMFullTextSearch._TIP_NORMAL_TEXT="\u90AE\u4EF6\u641C\u7D22...",QMFullTextSearch.search=function(c){var e=S("subject"),d={sid:getSid(),searchmode:c||"",folderid:c=="gmnormal"?"8":"all",stat:c=="attach"?"8":"6"},f={};changeStatus(1);d.subject=d.sender=d.receiver=e.getAttribute("focus")=="true"&&htmlEncode(encodeURI(trim(e.value)));if(c=="note"){f=T(['/cgi-bin/note_list?sid=$sid$&s=search&keyword=$subject$']);}else{if(attr(e,"fullsearch")=="1"){f=T(['/cgi-bin/mail_list?sid=$sid$&s=search&folderid=$folderid$&page=0&subject=$subject$&sender=$sender$','&receiver=$receiver$&searchmode=$searchmode$&topmails=0&advancesearch=0&loc=frame_html,,,$stat$']);}else{if(attr(e,"fullsearch")=="999"){f=T(['/cgi-bin/archive_maillist?sid=$sid$&s=search&folderid=$folderid$&page=0&keyword=$subject$&sender=$sender$','&receiver=$receiver$&topmails=0&advancesearch=3&combinetype=or&loc=frame_html,,,7']);}else{f=T(['/cgi-bin/mail_list?sid=$sid$&s=search&folderid=$folderid$&page=0&keyword=$subject$&sender=$sender$','&receiver=$receiver$&topmails=0&advancesearch=3&combinetype=or&loc=frame_html,,,7']);}}}QMPageInit._runFuncAfterCheckMainFrame(function(){goUrlMainFrm(f.replace(d),false);});};QMFullTextSearch._onevent=function(c){return function(){var e=S("subject"),d=S("subjectsearchLogo");_oValue={focus:[e.getAttribute("focus")!="true","","","true"],blur:[e.value=="",(attr(e,"fullsearch")=="1")?QMFullTextSearch._TIP_FULL_TEXT:QMFullTextSearch._TIP_NORMAL_TEXT,"#a0a0a0","false"]}[c];if(_oValue[0]){e.value=_oValue[1];e.style.color=_oValue[2];e.setAttribute("focus",_oValue[3]);}if(c=="focus"&&e.value!=""){QMFullTextSearch.QMAuto.show(a());}d&&(setClass(d,c=="focus"?"ss_icon ss_endicon ss_icon_return":"ss_icon ss_endicon ss_icon_arrowdown"));};};QMFullTextSearch.onkeydown=function(c){if(c.keyCode==13){}};function a(){var d=S("subject"),g=T("<div unselectable=\"on\" class=\"ss_drop_item\"><a href=\"javascript:;\" unselectable=\"on\"><span unselectable=\"on\" class=\"ss_icon ss_icon_mail\"></span>\u5305\u542B<b unselectable=\"on\">$keyword$</b>\u7684\u90AE\u4EF6</a></div>"),h=T("<div unselectable=\"on\" class=\"ss_drop_item\"><a href=\"javascript:;\"				unselectable=\"on\"><span class=\"ss_icon ss_icon_note\" unselectable=\"on\"></span>\u5305\u542B<b unselectable=\"on\">$keyword$</b>\u7684\u8BB0\u4E8B</a></div>"),e="<div class=\"ss_drop_item ss_drop_split\" unselectable=\"on\"><a unselectable=\"on\" href=\"javascript:;\">\u9AD8\u7EA7\u641C\u7D22...</a></div>",f=trim(d.value);if(f==""){return "";}else{var c=13;f=(f.length>c)?f.substring(0,c)+"...":f;if(attr(d,"fullsearch")!="1"){return [{sId:"searchInMail",sItemValue:g.replace({keyword:htmlEncode(f)})},{sId:"advanceSearch",sItemValue:e}];}else{return [{sId:"searchInMail",sItemValue:g.replace({keyword:htmlEncode(f)})},{sId:"searchInNotes",sItemValue:h.replace({keyword:htmlEncode(f)})},{sId:"advanceSearch",sItemValue:e}];}}}function b(){var c=S("subject");if(!c){return;}QMFullTextSearch.QMAuto=new QMAutoComplete({oInput:c,oPosObj:S("smartSearch"),nWidth:280,oClass:{classnormal:"ss_drop_item_wrap",classhigh:"ss_drop_item_wrap_hover"},ongetdata:function(){return a();},onselect:function(d){if(d.sId=="searchInMail"){QMFullTextSearch.search();}else if(d.sId=="searchInAttach"){QMFullTextSearch.search("attach");}else if(d.sId=="searchInGroupMail"){QMFullTextSearch.search("gmnormal");}else if(d.sId=="searchInNotes"){QMFullTextSearch.search("note");}else{showAdvanceSearchDialog();}}});}waitFor(function(){return getTop().QMAutoComplete;},function(c){if(c){b();}},1000,30000);QMFullTextSearch.onfocus=QMFullTextSearch._onevent("focus");QMFullTextSearch.onblur=QMFullTextSearch._onevent("blur");}})();function changeStatus(a){var b=S("searchIcon");b&&setClass(b,a?"ss_icon ss_fronticon ss_icon_loading":"ss_icon ss_fronticon ss_icon_search");}function doSearch(){QMPageInit._runFuncAfterCheckMainFrame(function(){var a=S("frmSearch");a.sender.value=a.subject.value;a.receiver.value=a.subject.value;a.keyword.value=a.subject.value;a.combinetype.value="or";submitToActionFrm(a);});return false;}function audioPlay(a){var b=getTop();if(!a.container){a.container=S('mp3player_container',b.getMainWin());}if(a.global&&!a.globalcontainer){a.globalcontainer=S('gplayer_container',b);}if(!b.QMPlayer){loadJsFileToTop(getPath('js'),[getFullResSuffix('qmplayer.js')]);}waitFor(function(){return !!b.QMPlayer;},function(c){if(c){b.QMPlayer.createInstance(a);}else if(a.container){a.container.innerHTML="\u64AD\u653E\u5668\u52A0\u8F7D\u5931\u8D25";}});}function audioStop(){var a=getTop().QMPlayer;a&&a.stop();}function setPlayer(a){var c=getTop();function b(d){if(!c.QMPlayer){setTimeout(function(){b(d);},200);return false;}var f="qqmailMediaPlayer"+(d.id||""),e=d.win||window;if(!e||e[f]){return false;}if(!d.container&&!(d.container=S("mp3player_container",e))){return false;}return (e[f]=new c.QMPlayer()).setup(d);}if(!c.QMPlayer){loadJsFile(getPath("js")+getFullResSuffix("qmplayer.js"),true,c.document);}return b(a);}function playUrl(a){var b=(a.win||window)["qqmailMediaPlayer"+(a.id||"")];if(!b){setPlayer(a);}else{b.openUrl(a.url,a.dispInfo);}}function stopUrl(a){if(!a){a={};}try{(a.win||window)["qqmailMediaPlayer"+(a.id||"")].stop();}catch(b){}}function searchMusic(c,b,a){if(window!=getTop()){return getTop().searchMusic(c,b,a);}c=c||"";b=b||"";var d=arguments.callee,e=[c,b].join("@");d.fCallBack=function(f){var l,o="",m=[];if(!f.contentWindow.gMusicInfo||!(l=f.contentWindow.gMusicInfo.list)){return a(m);}for(var p=0,g=l.length;p<g;p++){var k={song:l[p].songname.replace(/<\/?strong>/gi,""),singer:l[p].singername.replace(/<\/?strong>/gi,"")},n=htmlDecode(l[p].songurl).replace(/\|/g,"").split(";");for(var q=0,h=n.length;q<h;q+=2){if(n[q]&&n[q].indexOf("qqmusic.qq.com")==-1){k.url=n[q].replace(/^(FI|SI|AN|QQ)/,"");m.push(k);break;}}}d._oDataMap[e]=m;a(m);};if(!c&&!b){return a([]);}if(!d._oDataMap){d._oDataMap={};}if(d._oDataMap[e]){return a(d._oDataMap[e]);}d._oDataDomObj=createBlankIframe(getTop(),{id:"getMusicUrlFromSoSo",style:"display:none;",header:T(['<script>','function searchJsonCallback(a)','{','window.gMusicInfo = a;','}','<\/script>','<script src="$domain$/fcgi-bin/fcg_search_xmldata.q?w=$song$%20$singer$&source=3&r=$rand$"><\/script>']).replace({domain:(location.protocol=="https:"?'https://ptlogin2.mail.qq.com':'http://cgi.music.soso.com'),song:encodeURI(c),singer:encodeURI(b),rand:Math.random()}),destroy:true,onload:function(f){searchMusic.fCallBack(this);}});}function getMusicUrl(c,b,a){searchMusic(c,b,function(d){if(d.length>0){var g=0,e=/\.mp3$/i;for(var f=0;(gbIsMac||gbIsLinux)&&f<d.length;f++){if(e.test(d[f].url)){g=f;break;}}debug(d[g].url);a(d[g].song,d[g].singer,d[g].url,d);}else{a(c,b,"",d);}},1);}function startWebpush(a){var b=getTop();if(!(b.QMWebpushTip&&b.QMWebpush)){b.loadCssFile(getPath("css")+b.getFullResSuffix("webpushtip.css"),true);b.loadJsFileToTop(getPath("js"),[b.getFullResSuffix("qmwebpush.js"),b.getFullResSuffix("qmwebpushtip.js")]);}waitFor(function(){return b.QMWebpushTip;},function(c){if(c){b.QMWebpushTip.open(a);}},1000,30000);}function closeWebpush(a){getTop().QMWebpushTip&&getTop().QMWebpushTip.close(a,true);}function ftSendStatic(b,a){if(b){ossLog("realtime","all",T('stat=exskick&sid=$sid$&uin=$uin$&log=$code$').replace({uin:a||getTop().g_uin,sid:getSid(),code:b}));}}var QMXfDownload=function(){this._mnXfStatus=0;this._mnVer="";};QMXfDownload.prototype.init=function(){var b=null,a=null;try{b=new ActiveXObject("QQIEHelper.QQRightClick.2");}catch(c){debug("x:"+c.message);this._mnXfStatus=1;return;}this._mnVer=a=parseInt(b.GetVersion().split(".").pop());this._mnXfStatus=a>65?3:2;delete b;};QMXfDownload.prototype.getStatus=function(){return this._mnXfStatus;};QMXfDownload.prototype.dl=function(b,a){a=a||"";if(this._mnXfStatus>2){var d=new ActiveXObject("QQIEHelper.QQRightClick.2"),c=this._mnVer;if(c>=127){d.SendUrl2(b,location.href,a,document.cookie,0,10500);}else if(c>65){d.SendUrl(b,location.href,a,document.cookie);}delete d;}};var QMdlRespXml=function(a){var c=a&&a.responseText,b=c?c.split("|"):["error","DEF_ERR"];this._msErrorCode=null;this._msKey=null;this._msDownLoadUrl=null;if(b[0]!="error"&&b[0].indexOf("http://")==0){this._msDownLoadUrl=b[0].replace(/#/g,"_");this._msKey=b[1];}else{this._msErrorCode=QMdlRespXml._TEMPLATE[b[1]]?b[1]:"DEF_ERR";}};QMdlRespXml._TEMPLATE={"-102":"\u8BE5\u6587\u4EF6\u5DF2\u88AB\u6587\u4EF6\u6240\u6709\u8005\u5220\u9664\u3002","-1":"\u672A\u77E5\u9519\u8BEF","-201":"\u6587\u4EF6\u4E0B\u8F7D\u5DF2\u8FBE\u4E0A\u9650\uFF0C\u65E0\u6CD5\u4E0B\u8F7D","DEF_ERR":"\u83B7\u53D6\u4E0B\u8F7D\u5730\u5740\u5931\u8D25"};QMdlRespXml.prototype.getError=function(){return this._msErrorCode;};QMdlRespXml.prototype.getErrorMsg=function(){return QMdlRespXml._TEMPLATE[this._msErrorCode];};QMdlRespXml.prototype.getKey=function(){return this._msKey;};QMdlRespXml.prototype.getUrl=function(){setCookie("qm_ftn_key",this._msKey,new Date(new Date().valueOf()+3600*1000),"/","qq.com");return this._msDownLoadUrl;};var QMFtnRen=function(){this._moConfig=null;};QMFtnRen._TEMPLATE={DLG:T(['<div class="dialog_input_wrap">','\u8BF7\u8F93\u5165\u65B0\u7684\u6587\u4EF6\u540D\uFF1A','<div>','<input id="dlgtxt" type="text" class="dialog_input" value="$name$" />','</div>','</div>']),DLG_FOOT:T(['<a id="dlgok" class="btn_blue" href="javascript:;">\u786E\u5B9A</a>']),MINDLG:T(['<div class="dialog_input_wrap">','\u8BF7\u8F93\u5165\u65B0\u7684\u6587\u4EF6\u540D\uFF1A','<div>','<input id="dlgtxt" type="text" class="dialog_input" value="$name$" style="width:110px;" />&nbsp;','<a id="dlgok" class="btn_blue" href="javascript:;">\u786E\u5B9A</a>','</div>','</div>'])};QMFtnRen.prototype.init=function(a){this._moConfig=a||{};};QMFtnRen.prototype.checkFileName=function(a){if(trim(a)==""){showError("\u6587\u4EF6\u540D\u4E0D\u80FD\u4E3A\u7A7A");return false;}else{var c="\\ / : * ? \" < > |",b=c.split(" ");for(var d in b){if(a.indexOf(b[d])!=-1){showError("\u6587\u4EF6\u540D\u4E0D\u80FD\u5305\u542B "+c);return false;}}}return true;};QMFtnRen.prototype.ren=function(a){var c=this;function d(e,g){var h="",f=new QMAjax();if(e==a.filename){g.close();return;}if(!c.checkFileName(e)){return;}h=T("sid=$sid$&oper=filealter&bus=$bus$&filename=$filename$&fid=$fid$&t=re_ftnfilefunc&resp_charset=UTF8").replace({sid:getSid(),filename:encodeURIComponent(e),fid:a.fid,bus:a.appid});f.url="/cgi-bin/ftnTagMgr";f.method="POST";f.onComplete=f.onError=function(i){var k=null;if(i){if(i.responseText.indexOf("({")==0){k=evalValue(i.responseText);if(k.error=="0"){showInfo("\u6587\u4EF6\u6539\u540D\u6210\u529F");a.okCallBack();}else if(k.error=="-2"){showError("\u65E7\u7F51\u76D8\u7684\u6587\u4EF6\u4E0D\u652F\u6301\u6539\u540D");}}else{var j=getActionWin().document;j.open();j.write(i.responseText);j.close();}}};f.send(h);g.close();if(c._moConfig.skin=="MINDLG"){showInfo("\u6587\u4EF6\u6539\u540D\u4E2D...");}else{showProcess(1,true,"\u6587\u4EF6\u6539\u540D\u4E2D, \u8BF7\u7A0D\u7B49...","",true);}}var b=this._moConfig;new (getTop().QMDialog)({sTitle:"\u6587\u4EF6\u91CD\u547D\u540D",sBodyHtml:QMFtnRen._TEMPLATE[b.skin||"DLG"].replace({name:a.filename||""}),sFootHtml:QMFtnRen._TEMPLATE["DLG_FOOT"],nWidth:b.width||null,nHeight:b.height||180,onshow:function(){var g=this.S("dlgtxt"),e=g.value.lastIndexOf('.');if(!window.getSelection){var f=g.createTextRange();f.moveStart("character",0);f.moveEnd("character",e-g.value.length);f.select();}else{g.selectionStart=0;g.selectionEnd=e;}g.focus();},onload:function(){var e=this;addEvent(e.S("dlgok"),"click",function(){var f=e.S("dlgtxt").value;d(f,e);});e.S("dlgtxt").onkeydown=function(f){var g=(e.option("oEmbedWin").event||f).keyCode,h=e.S("dlgtxt").value;if(g==13||g==9){d(h,e);}};}});};function twoDCodeImgUrl(a){var b=location.getParams(a);return TE(['/cgi-bin/generate_twodimcode?out=250&sid=$@$eval getSid()$@$','$@$if($mailid$)$@$','&filename=$@$eval escape($filename$)$@$&mailid=$mailid$','$@$else if($att$)$@$','&att=$att$&action=groupattach','$@$else if($k$)$@$','&k=$k$&code=$code$&action=bigattach','$@$endif$@$']).replace(b);}function showTwoDCodeImgMenu(b,a,d,c){var k=this,i=b.document,j=calcPos(a),h=j[2]-40,f=0,g=bodyScroll(i,"scrollTop"),e=bodyScroll(i,"clientHeight");if((f=h+320-g-e)>0){h-=(f+10);}new QMMenu({oEmbedWin:b,sId:"scanImg",nArrowPos:j[0]-h-5,bAutoClose:false,sWidthDetect:"float",nArrowDirection:"Left",nWidth:"auto",nX:j[3]+25,nY:h,onshow:function(){if(gnIEVer==6){this.S("twodcode").src=this.S("twodcode").src;}},oItems:[{bDisSelect:true,sStyle:"padding:0;",nHeight:"auto",sItemValue:T(['<div style="width:300px;height:310px;padding-top:10px;">','<div style="text-align:center;">','<img id="twodcode" style="width:250px;height:250px;" src="$src$"/>','</div>','<div style="margin-top:-5px;">','<p style="margin:0;text-align:center;padding:5px 0;">\u626B\u63CF\u4E8C\u7EF4\u7801\uFF0C\u5C06\u9644\u4EF6\u4E0B\u8F7D\u5230\u624B\u673A\u3002</p>','<p style="margin:0;text-align:center;padding:5px 0;">\uFF08\u4E8C\u7EF4\u7801\u6709\u6548\u671F\u4E3A5\u5206\u949F\uFF09</p>','</div>','</div>']).replace({filename:d,src:twoDCodeImgUrl(c)})}]});}function ckDns(a){E(a,function(b,d){var c=(new Image());c.src=["http://",b,"/zh_CN/htmledition/images/spacer.gif"].join("");});}function beginStatTime(a){var b=parseInt(a.location.hash.split("stattime=").pop());if(!isNaN(b)&&b.toString().length==13&&b>(getTop().gnStatTimeStamp||0)){a.gnBeginTime=getTop().gnStatTimeStamp=b;a.gnStatTimeStart=now();}}function endStatTime(b,a){var c=b.gnBeginTime,e=b.gnStatTimeStart,d=now();if(!isNaN(e)&&!isNaN(c)){addEvent(b,"load",function(){var f=now();ossLog("delay","sample",T(['stat=cgipagespeed&type=$type$&t1=$t1$&t2=$t2$&t3=$t3$','&rcgi=$appname$&rt=$t$&rs=$s$&allt=$allt$&flowid=$wm_flowid$']).replace(extend(a,{t1:e-c,t2:d-e,t3:f-d,allt:[c,e,d,f].join("|")})));});}}function ossLog(){var a=getTop().ossLog;return a._ossLog.apply(a,arguments);}ossLog._ossLog=function(b,d,c,a){var g=this,i=b||"realtime",h=g._pasteLog(c),f=g._oLogList||(g._oLogList=[]),e=typeof d=="number"?d:{all:1}[d||"all"]||0.1;if(i=="realtime"){g._isSample(e)&&g._doReport(h);}else{g._isSample(e)&&f.push(["delayurl","=",encodeURIComponent(h)].join(""));f.length>=1000?g._doReport():(!g._nTimer&&f.length>0&&(g._nTimer=setTimeout(g._doReport,5*1000)));}};ossLog._doReport=function(a){var c=ossLog,b=c._oLogList;if(a||b.length>0){QMAjax.send("/cgi-bin/getinvestigate",{method:"POST",timeout:500,content:T('sid=$sid$&$rl$&$ls$').replace({sid:getSid(),rl:a,ls:b.join("&")})});b.length=0;c._nTimer&&clearTimeout(c._nTimer);c._nTimer=null;}};ossLog._isSample=function(a){return (this._nTimeStamp||(this._nTimeStamp=now()))%100<100*a;};ossLog._pasteLog=function(a){var b=[];typeof a=="string"?b.push("&",a):E(a,function(d,c){b.push("&",c,"=",encodeURIComponent(d));});return b.shift()&&b.join("");};function isdLog(c,a,b){var e=T([window.location.protocol,"//isdspeed.qq.com/cgi-bin/r.cgi?flag1=6000&flag2=101&flag3=$flag$&$key$=$value$&r=$r$"]),d=new Image();setTimeout(function(){d.src=e.replace({flag:c,key:a,value:b||"1",r:Math.random()});});}function all_js(){}function hideEditorMenu(){if(getTop().QMEditor){getTop().QMEditor.hideEditorMenu();}}function hideMenuEvent(b){var d=getEventTarget(b),c=getTop().QMMenu&&getTop().QMMenu();for(var e in c){!c[e].isContain(d)&&c[e].close();}try{}catch(a){}}function confirmBox(a){var c=2,b=a.defaultChecked||false,e=a.confirmBtnTxt||"\u786E\u5B9A",d=a.cancelBtnTxt||"\u53D6\u6D88",f=a.neverBtnTxt;new (getTop().QMDialog)({bAlignCenter:a.bAlignCenter,sId:a.id||"QMconfirm",sTitle:a.title||"\u786E\u8BA4",sBodyHtml:TE(['<div class="$sStyle$">','$@$if($sType$=="custom")$@$','$msg$','$@$else$@$','<div class="cnfx_content">','<span class="dialog_icon icon_info_b"></span>','<div class="dialog_f_c">$msg$</div>','</div>','<div class="cnfx_status" style="display:$statusdisp$;">','<input id="recordstatus" class="cnfx_status_checkbox" type="checkbox" $checked$/><label for="recordstatus">$recordinfo$</label>','</div>','$@$endif$@$','</div>']).replace({sStyle:a.style||'',sType:a.sType||"",msg:a.msg,caceldisp:a.mode=="alert"?"none":"",imgdisp:a.mode=="prompt"?"none":"block",recordinfo:a.recordInfo,statusdisp:a.enableRecord?"":"none",checked:a.defaultChecked?"checked":"",confrim:e,confirmcss:getAsiiStrLen(e)>5?"":"wd2",cancel:d,cancelcss:getAsiiStrLen(d)>5?"":"wd2",never:f,neverdisp:f?'':'none',nevercss:getAsiiStrLen(f)>5?"":"wd2"}),sFootHtml:T(['<div class=" txt_right cnfx_btn">','<input class="btn_blue btn_input" type="button" id="confirm" value="$confirm$" />','<input class="btn_gray btn_input" type="button" id="cancel" style="display:$caceldisp$;" value="$cancel$" />','<input class="btn_gray btn_input" type="button" id="never" style="display:$neverdisp$;" value="$never$" />','</div>']).replace({caceldisp:a.mode=="alert"?"none":"",confirm:e,confirmcss:getAsiiStrLen(e)>5?"":"wd2",cancel:d,cancelcss:getAsiiStrLen(d)>5?"":"wd2",never:f,neverdisp:f?'':'none',nevercss:getAsiiStrLen(f)>5?"":"wd2"}),nWidth:a.width,nHeight:a.height,onload:function(){var j=this,h=j.S("confirm"),g=j.S("cancel"),i=j.S("never");addEvents([h,g,i],{click:function(k){var l=getEventTarget(k);if(l==h){if(j.S("recordstatus")){b=j.S("recordstatus").checked;}c=1;}else if(l==i){c=3;}j.close();}});callBack.call(j,a.onload);},onshow:function(){gbIsMac||this.S("confirm").focus();callBack.call(this,a.onshow);},onclose:function(){callBack.call(this,a.onclose);},onbeforeclose:function(){try{callBack.call(this,a.onreturn,[c==1,b,c]);}catch(g){}return true;}});}function alertBox(a){confirmBox(extend({mode:"alert"},a));}function promptBox(a){var b=false,c=a.onreturn;a.onreturn=function(d){var e=this;callBack.call(e,c,[b||d,e.S("txt").value]);};a.msg=T(['<div class="dialog_input_wrap txt_left">','<p>$msg$</p>','<div style="margin:8px 0 0;"><input type="text" id="txt" class="dialog_input" value="$defaultValue$"/></div>','<div style="margin:8px 0 0;" class="f_size addrtitle">$description$</div>','</div>']).replace(a);confirmBox(extend({sType:"custom",height:a.height||null,onload:function(){var d=this;addEvent(d.S("txt"),"keydown",function(e){if(e.keyCode==13){b=true;d.close();}});},onshow:function(){this.S('txt').select();this.S("txt").focus();}},a));}function loadingBox(a){if(!callBack(a.oncheck)){var b=new QMDialog({sId:"LoAdINgBOx",sTitle:a.model+"\u6A21\u5757\u52A0\u8F7D\u4E2D...",nWidth:400,nHeight:'auto',sBodyHtml:T(['<div style="text-align:center;padding:58px;">','<img id="load" src="$images_path$ico_loading2.gif">','<span id="err" style="display:none;">$model$\u6A21\u5757\u52A0\u8F7D\u5931\u8D25</span>','</div>']).replace(extend(a,{images_path:getPath("image")})),onclose:function(){b=null;}});if(a.js){var c=[];E(typeof a.js=="string"?[a.js]:a.js,function(d){c.push(d);});loadJsFileToTop(c);}waitFor(function(){return callBack(a.oncheck);},function(d){if(!b){return;}if(!d){show(b.S("load"),false);show(b.S("err"),true);}else{b.close(true);callBack(a.onload);}});}else{callBack(a.onload);}}(function(){var c=getTop();function b(f,e){var f="weixinCss";if(!c.S(f)){var g=c.document.createElement("style");g.type="text/css";g.id=f;if(c.gbIsIE){g.styleSheet.cssText=e;}else{g.innerHTML=e;}c.document.getElementsByTagName("head")[0].appendChild(g);}}var a=TE(['<div id="mask" class="editor_mask opa50Mask editor_maskAtt" ></div>','<div id="out" style="z-index:1000;position: absolute;width:$width$%;height:$height$%;margin-top:$offsetTop$%;margin-left:$offsetLeft$%;outline:0;" tabindex="-1" hidefocus="hidefocus">','<a id="close" href="javascript:;" title="\u5173\u95ED" style="$@$if($noclose$)$@$display:none$@$endif$@$;position:absolute;right:0;top:16px;width:23px;height:23px;margin:-24px -9px 0 0;background:url($images_path$newicon/login.png) no-repeat 0 0;"></a>','<div id="body" style="width:100%;height:100%">$html$</div>','</div>']);function d(e){b(e.sId,e.sCssRule);new QMPanel({oEmbedWin:c,sStyle:"position:absolute;width:100%; height:100%; left:0; top:0; margin-top:-2px",nWidth:"auto",nHeight:"auto",sId:"weixinnote",sBodyHtml:a.replace({noclose:e.bNoCloseBtn,html:e.sBodyHtml,images_path:getPath("image"),offsetTop:(100-e.nHeightPercent)/2,offsetLeft:(100-e.nWidthPercent)/2,width:e.nWidthPercent,height:e.nHeightPercent}),onclose:e.onclose,onload:function(){var f=this;f.S("mask").onclick=f.S("close").onclick=function(){f.close();};e.onload&&callBack.call(f,e.onload,[f]);}});}window.maskPanel=d;})();function getQMPluginInfo(a){var c=(gbIsWin&&((gbIsFF&&gsFFVer.split(".")[0]>=3&&(gsFFVer.split(".")[1]>0||gsFFVer.split(".")[2]>=8||parseInt(navigator.buildID.substr(0,8))>=20090701))||(gbIsChrome&&(""+gsChromeVer).split('.')[0]>=6)||(gbIsSafari&&gsAgent.indexOf("se 2.x metasr 1.0")<0)||(gbIsOpera)||(gbIsQPlus)||(gbIsQBWebKit&&getQMPluginInfo._compareVersion(gsQBVer,"6.5")>0)))||(gbIsMac&&getQMPluginInfo._compareVersion(gsMacVer,a)>=0&&(gbIsFF&&parseFloat(gsFFVer)>=3.6||gbIsChrome&&parseFloat(gsChromeVer)>=8||gbIsSafari&&parseFloat(gsSafariVer)>=5||gbIsQBWebKit));return c;}getQMPluginInfo._compareVersion=function(a,b){var g=a.split("."),e=g.length,h=b.split("."),f=h.length;for(var j=0;j<e&&j<f;j++){var c=parseInt(g[j]),d=parseInt(h[j]);if(c==d){continue;}return c>d?1:-1;}if(j<e){return 1;}if(j<f){return -1;}return 0;};var QMAXInfo={_moInfos:{path:"/activex/",cab:["TencentMailActiveX.cab","TencentMailActiveX_2.cab"],exe:"TencentMailActiveXInstall.exe",obj:[["TXGYMailActiveX.ScreenCapture","TXGYMailActiveX.UploadFilePartition","TXGYMailActiveX.Uploader","TXFTNActiveX.FTNUpload","TXGYMailActiveX.DropFile"]],available:["ScreenCapture","Uploader","FTNUpload","DropFile","UploadFilePartition"],lastVer:["1.0.1.53","1.0.1.29","1.0.1.53","1.0.0.29","1.0.0.53"],miniVer:[(getDomain()=="foxmail.com")?"1.0.0.5":"1.0.1.28","1.0.1.28","1.0.1.28","1.0.0.13","1.0.0.7"]},_moInfos_FF:{path:"/xpi/",xpi:"TencentMailPlugin.xpi",obj:["ScreenCapture","","Uploader","FTNUpload",""],available:["ScreenCapture","Uploader","FTNUpload"],name:["QQMail Plugin","","QQMail Plugin","Tencent FTN plug-in","QQMail Plugin"],type:(function(){var a="application/txftn",b="application/txftn-webkit";return ["application/x-tencent-qmail","","application/x-tencent-qmail",(typeof navigator.mimeTypes!="undefined")&&navigator.mimeTypes[b]?b:a,"application/x-tencent-qmail"];})(),lastVer:["1.0.1.53","","1.0.1.53","1.0.0.4","1.0.0.0"],miniVer:["1.0.1.28","","1.0.1.28","1.0.0.4","1.0.0.0"]},_moInfos_WebKit:{path:"/crx/",crx:"TencentMailPlugin.crx",exe:"QQMailWebKitPlugin.exe",obj:["ScreenCapture","","Uploader","FTNUpload",""],available:["ScreenCapture","FTNUpload"],name:["QQMail Plugin","","QQMail Plugin","Tencent FTN plug-in",""],type:["application/x-tencent-qmail-webkit","","application/x-tencent-qmail-webkit","application/txftn-webkit",""],lastVer:["1.0.1.53","","1.0.1.53","1.0.0.4",""],miniVer:["1.0.1.28","","1.0.1.28","1.0.0.4",""]},_moInfos_WebKitForMac:{path:"/crx/",pkg:"TencentMailPluginForMac.pkg",obj:["ScreenCapture","","Uploader","FTNUpload",""],available:["ScreenCapture","Uploader"],name:["QQMailPlugin","","QQMailPlugin","Tencent FTN Plug-in",""],type:["application/x-tencent-qmail-webkit","","application/x-tencent-qmail-webkit","application/txftn",""],lastVer:["1.0.1.34","","1.0.1.34","1.0.0.3",""],miniVer:["1.0.1.34","","1.0.1.34","1.0.0.3",""]},mbAblePlugin:getQMPluginInfo("10.6.8"),mbAbleUsePlugin:getQMPluginInfo("10.6.8"),_mbIsChecked:true,getTitle:function(){return gbIsIE?"\u63A7\u4EF6":"\u63D2\u4EF6";},getinfo:function(){if(QMAXInfo.mbAblePlugin){if(gbIsWin){if(gbIsIE){return QMAXInfo._moInfos.available;}if(gbIsFF){return QMAXInfo._moInfos_FF.available;}if(gbIsChrome||gbIsSafari||gbIsOpera||gbIsQBWebKit){return QMAXInfo._moInfos_WebKit.available;}}if(gbIsMac){return QMAXInfo._moInfos_WebKitForMac.available;}}return [];},_grayUpdate:function(){},installer:function(b,a){var d=this.get("whole",a),e="";if(/^online/.test(b)){if(d.cab){e=this.get("cab");}else{e=d.xpi||(gbIsChrome&&parseInt(gsChromeVer)<21&&d.crx);}}else if(/^download/.test(b)&&d){if(a=="FF"||(!a&&gbIsFF)){d=this.get("whole","WebKit");}e=d.exe||d.pkg;}if(e){var c=e.split('.');e=[[c[0]].concat(d.lastVer[0].split('.')).join("_"),c[1]].join('.');}if(e&&/Abs$/.test(b)){e=d.path+e;}return e;},get:function(b,a){if(!a){gbIsIE&&(a="IE");gbIsFF&&(a='FF');(gbIsChrome||gbIsSafari||gbIsOpera||gbIsQBWebKit)&&(a="WebKit");!gbIsIE&&gbIsMac&&(a="mac");}var d={IE:this._moInfos,FF:this._moInfos_FF,chrome:this._moInfos_WebKit,WebKit:this._moInfos_WebKit,mac:this._moInfos_WebKitForMac}[a];if(!this._mbIsChecked){this._grayUpdate();}if(b=="whole"){return d;}else if(b=="cab"){var c=createActiveX(0),f=c?"":"_2.dll";try{f=c.GetDLLFileName();}catch(g){}return d["cab"][f&&f.indexOf("_2.dll")!=-1?0:1];}return d[b];}};function createActiveX(a,b){if(!gbIsIE){return createPlugin(a,false,b);}if(a>=0&&a<=4){var c=QMAXInfo.get("obj");for(var e=0,f=c.length;e<f;e++){if(a==3){try{new ActiveXObject(c[e][0]);}catch(d){}}try{return new ActiveXObject(c[e][a]);}catch(d){}}}return null;}function detectActiveX(a,b,c,d){if(!gbIsIE){return detectPlugin(a,b,c,d);}var f=typeof (c)=="undefined",e=false,g=f?createActiveX(a):c,h=getActiveXVer(g);if(g&&h){if(b!=1&&b!=2){e=true;}else if(getQMPluginInfo._compareVersion(h,QMAXInfo.get(b==1?"miniVer":"lastVer")[a])>=0){e=true;}if(f){delete g;g=null;}}return e;}function getActiveXVer(a){if(!gbIsIE){return getPluginVer(a);}var d="",b;try{b=typeof (a)=="number"?createActiveX(a):a;d=b&&(b.version?b.version:"1.0.0.8")||"";}catch(c){}return d;}function checkInstallPlugin(a){if(!QMAXInfo.mbAbleUsePlugin){return false;}try{navigator.plugins.refresh(false);}catch(g){}var c=QMAXInfo.get("name")[a],f=QMAXInfo.get("type")[a],b=navigator.plugins;if(b&&c){for(var h=b.length-1;h>=0;h--){for(var k=b[h].length-1;k>=0;k--){if(b[h].name.indexOf(c)!=-1&&b[h][k].type==f){if(a!=3&&(gsAgent.indexOf("vista")>-1||/nt 6/gi.test(gsAgent))&&f=="application/x-tencent-qmail"){var d=b[h].description.split('#')[1];if(!d){continue;}}var d=/(\d+(?:\.\d+)+)/.test(b[h].description||"")?RegExp.$1:"1.0.0.0";if(gbIsMac&&a!=3&&d=="1.0.0.0"){continue;}if(gbIsMac&&gbIsChrome&&parseFloat(gsChromeVer)>21&&getQMPluginInfo._compareVersion(d,"1.0.2.0")<0){continue;}return true;}}}}return false;}function createPlugin(b,a,c,d){var e=null;c=c||getMainWin();switch(b){case 0:case 2:case 4:if(gbIsSafari){createPlugin._createQQMailPlugin(b,c,d);}e=createPlugin._createQQMailPlugin(b,getTop(),d);break;case 3:e=createFTNPlugin(c,d);break;}if(!a&&checkInstallPlugin(b)){getTop().ossLog("delay","all",T(['stat=ff_addon','&type=%type%&info=%info%'],'%').replace({type:!e?"failcreatePlugin":"successcreatePlugin",info:["ver:",gsFFVer,",pluginId:",b,",brtpe:",(gbIsFF?1:(gbIsChrome?2:(gbIsSafari?3:(gbIsOpera?4:5))))].join("")}));}return e;}createPlugin._createQQMailPlugin=function(a,b,c){var d,e=null,h=gbIsFF?"application/x-tencent-qmail":"application/x-tencent-qmail-webkit";b=b||getTop();if(checkInstallPlugin(a)){var g=c||"QQMailFFPluginIns";if(!(d=S(g,b))){insertHTML(b.document.body,"beforeEnd",T('<embed id="$id$" type="$type$" hidden="true"></embed>').replace({type:h,id:g}));d=S(g,b);}var f={0:"CreateScreenCapture",2:"CreateUploader",4:"CreateDragDropManager"}[a];if(typeof d[f]!="undefined"){e=d[f]();if(a==0){e.OnCaptureFinished=function(){};}else if(a==2){e.OnEvent=function(){};}}}return e;};createPlugin._createFTNPlugin=function(a,b){var c=null,e=QMAXInfo.get("whole")["type"][3],d=b||"npftnPlugin";a=a||getTop();if(!(c=S(d,a))){insertHTML(a.document.body,"beforeEnd",T('<embed id="$id$" type="$type$" style="z-index:99999;position:absolute;top:0;left:0;width:1px;height:1px;"></embed>').replace({type:e,id:d}));c=S(d,a);if(c){c.onEvent=function(){};}}return c;};function createFTNPlugin(a,b){if(!checkInstallPlugin(3)){return null;}createPlugin._createFTNPlugin(a,b);var c=createPlugin._createFTNPlugin(getTop(),b);if(b){getTop().ossLog("delay","all",T(['stat=ff_addon','&type=%type%&info=%info%'],'%').replace({type:c&&c.Version?"successcreatePlugin":"failcreatePlugin",info:["ver:",gsFFVer,",pluginId:3,insId:",b].join("")}));}return c.Version?c:null;}function detectPlugin(b,a,c,d){var e=false;var f=c||createPlugin(b,true,null,d),g=getPluginVer(f);if(f&&g){if(a!=1&&a!=2){e=true;}else if(b==3&&!gbIsMac&&gbIsSafari){e=false;}else if(getQMPluginInfo._compareVersion(g,QMAXInfo.get(a==1?"miniVer":"lastVer")[b])>=0){e=true;}}return e;}function getPluginVer(a){var b,d="";try{b=typeof (a)=="number"?createPlugin(a,true):a;d=(b&&b.Version)||"";}catch(c){}return d;}function initDialog(c,d,e,b,a){new (getTop().QMDialog)({sid:c,sTitle:d,sUrl:e,nWidth:b,nHeight:a});}function requestShowTip(c,d,b,a){var e=T('/cgi-bin/tip?sid=$sid$&args=$dom$,$tip$&r=$r$').replace({sid:getSid(),dom:c,tip:d,r:Math.random()});QMAjax.send(e,{method:'GET',onload:function(f,h,g){if(f&&h.indexOf('oTop.QMTip')>0){if(!a||a(h,g)){globalEval(h,b);}}}});}function detectCapsLock(b,c,a){if(!b){return;}function f(g){var i=g.target||g.srcElement,h=calcPos(i),j=c||S("capTip");function k(){return ["z-index:20;position:absolute;background:#fdf6aa;padding:1px;","border:1px solid #dbc492;border-right:1px solid #b49366;border-bottom:1px solid #b49366;","left:",h[3],"px;","top:",(h[2]+1),"px;"].join("");}if(!j){insertHTML((a||document).body,"afterBegin",'<div id="capTip" style="'+k()+'">\u5927\u5199\u9501\u5B9A\u5DF2\u6253\u5F00</div>');}else{j.style.cssText=k();}}function e(){show(S("capTip",(a||document)),false);}var d=-1;addEvents(b,{keydown:function(g){var h=g.keyCode||g.charCode;if(h==20){if(d==0){f(g);d=1;}else if(d==1){e();d=0;}}},keypress:function(g){var i=g.keyCode||g.charCode,h=g.shiftKey;if((i>=65&&i<=90&&!h)||(i>=97&&i<=122&&h)){d=1;f(g);}else if((i>=97&&i<=122&&!h)||(i>=65&&i<=90&&h)){d=0;e();}else{e();}},blur:function(){e();}});}